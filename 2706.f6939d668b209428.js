"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[2706],{6768:(Z,C,i)=>{i.d(C,{t:()=>t});var u=i(5e3),h=i(7747),v=i(5384),T=i(3075),p=i(4036);let t=(()=>{class m{constructor(l,d){this.commonService=l,this.eventService=d,this.ValueSelectedChange=new u.vpe,this.categorys=[],this.Filter=!1}ngOnInit(){this.data=this.DropDownDataSource,this.Filter=this.showFilter}changeValue(){var l;this.ValueSelected=null===(l=this.selectedData)||void 0===l?void 0:l.value,this.ValueSelectedChange.emit(this.ValueSelected)}selectedValue(){var l;this.ValueSelected=null===(l=this.selectedData)||void 0===l?void 0:l.value,this.ValueSelectedChange.emit(this.ValueSelected)}}return m.\u0275fac=function(l){return new(l||m)(u.Y36(h.M),u.Y36(v.P))},m.\u0275cmp=u.Xpm({type:m,selectors:[["app-drop-down"]],inputs:{ValueSelected:"ValueSelected",IsCreating:"IsCreating",showFilter:"showFilter",DropDownDataSource:"DropDownDataSource"},outputs:{ValueSelectedChange:"ValueSelectedChange"},decls:1,vars:3,consts:[["optionLabel","viewValue",3,"filter","options","ngModel","onClick","onChange","ngModelChange"]],template:function(l,d){1&l&&(u.TgZ(0,"p-dropdown",0),u.NdJ("onClick",function(){return d.selectedValue()})("onChange",function(){return d.changeValue()})("ngModelChange",function(_){return d.selectedData=_}),u.qZA()),2&l&&u.Q6J("filter",d.Filter)("options",d.data)("ngModel",d.selectedData)},dependencies:[T.JJ,T.On,p.Lt],encapsulation:2}),m})()},2706:(Z,C,i)=>{i.r(C),i.d(C,{ComprasModule:()=>N});var u=i(9808),h=i(7449);class v{}var p=i(3075),t=i(5e3),m=i(7747),f=i(5384),l=i(845),d=i(6768),g=i(7531),_=i(9815),y=i(508),x=i(5652),b=i(9783),M=i(5315);function D(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",12)(1,"strong"),t._uU(2," Proveedor: "),t.qZA(),t.TgZ(3,"app-drop-down",13),t.NdJ("ValueSelectedChange",function(r){t.CHM(e);const a=t.oxw();return t.KtG(a.filterSupplier(r))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("showFilter",!0)("IsCreating",!1)("DropDownDataSource",e.suppliers)}}function P(n,c){if(1&n&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.Q6J("value",e.value)("title",e.viewValue),t.xp6(1),t.hij(" ",e.viewValue," ")}}function w(n,c){if(1&n&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function A(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"input",14),t.NdJ("input",function(r){t.CHM(e);const a=t.oxw();return t.KtG(a.filterProducts(r))}),t.qZA(),t.TgZ(3,"mat-autocomplete",15,16),t.NdJ("optionSelected",function(){const r=t.CHM(e),a=r.index,s=r.$implicit,E=t.oxw();return t.KtG(E.updateProduct(a,s))}),t.YNc(5,P,2,3,"mat-option",17),t.qZA()(),t.TgZ(6,"td")(7,"input",18),t.NdJ("ngModelChange",function(r){const s=t.CHM(e).$implicit;return t.KtG(s.quantity=r)})("change",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.getTotal())}),t.qZA()(),t.TgZ(8,"td")(9,"input",18),t.NdJ("ngModelChange",function(r){const s=t.CHM(e).$implicit;return t.KtG(s.purchasePrice=r)})("change",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.getTotal())}),t.qZA()(),t.TgZ(10,"td")(11,"select",19),t.NdJ("ngModelChange",function(r){const s=t.CHM(e).$implicit;return t.KtG(s.taxId=r)}),t.YNc(12,w,2,2,"option",20),t.qZA()(),t.TgZ(13,"td")(14,"button",21),t.NdJ("click",function(){const a=t.CHM(e).index,s=t.oxw();return t.KtG(s.removeProduct(a))}),t.qZA()()()}if(2&n){const e=c.$implicit,o=t.MAs(4),r=t.oxw();t.xp6(2),t.Q6J("matAutocomplete",o)("formControl",e.productControl),t.xp6(3),t.Q6J("ngForOf",r.filterdProductos),t.xp6(2),t.Q6J("ngModel",e.quantity),t.xp6(2),t.Q6J("ngModel",e.purchasePrice),t.xp6(2),t.Q6J("ngModel",e.taxId),t.xp6(1),t.Q6J("ngForOf",r.availableTaxes)}}function S(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.showSaveDialog=!1)}),t.qZA(),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.confirmSaveBuy())}),t.qZA()}}const J=function(){return{width:"450px"}};let O=(()=>{class n{constructor(e,o){this.productService=e,this.eventService=o,this.availableTaxes=[{id:1,name:"Tax 1"},{id:2,name:"Tax 2"},{id:3,name:"Tax 3"}],this.buy=new v,this.buy.supplierId=0,this.buy.buyDate=new Date,this.buy.reference="",this.buy.productLine=[],this.buy.productLine.forEach(r=>{r.productControl=new p.NI})}ngOnInit(){this.GetSupplierValuesByEnterprise(),this.getProductValues()}removeProduct(e){this.buy.productLine.splice(e,1)}updateProduct(e,o){const r=o.productControl.value,a=this.products.find(s=>s.value===r);a?(o.productId=r,o.productControl.setValue(a.viewValue)):(o.productId=0,o.productControl.setValue(""))}addProduct(){this.buy.productLine.push({productId:0,quantity:0,purchasePrice:0,taxId:0,productControl:new p.NI}),console.log(this.buy.productLine)}getTotal(){let e=0;for(let o of this.buy.productLine)e+=o.quantity*o.purchasePrice;return e}filterSupplier(e){this.buy.supplierId=e}getProductValues(){this.isLoading=!0,this.productService.GetProductsValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.products=e.data),this.isLoading=!1})}filterProducts(e){const r=(e.target.value||"").toLowerCase();this.filterdProductos=this.products.filter(a=>a.viewValue.toLowerCase().includes(r))}GetSupplierValuesByEnterprise(){this.productService.GetSupplierValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.suppliers=e.data)})}save(){this.showSaveDialog=!0}confirmSaveBuy(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.M),t.Y36(f.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],decls:39,vars:11,consts:[["style","margin-bottom: 10px;",4,"ngIf"],["inputId","icon","formControlName","buy.buyDate",2,"margin-left","25px",3,"showIcon"],[2,"margin-top","10px"],["type","text","pInputText","","id","productName","required","","autofocus","",3,"ngModel","ngModelChange"],[2,"margin-top","20px"],[4,"ngFor","ngForOf"],["pButton","","pRipple","","label","Agregar","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-help",3,"click"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],["pTemplate","footer"],[2,"margin-bottom","10px"],[3,"showFilter","IsCreating","DropDownDataSource","ValueSelectedChange"],["type","text","placeholder","Product","aria-label","Product","matInput","",1,"large-input",3,"matAutocomplete","formControl","input"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value","title",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],[3,"value","title"],[3,"value"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div"),t.YNc(1,D,4,3,"div",0),t.TgZ(2,"strong"),t._uU(3,"Fecha: "),t.qZA(),t._UZ(4,"p-calendar",1)(5,"br"),t.TgZ(6,"div",2)(7,"strong"),t._uU(8,"Referencia: "),t.qZA(),t.TgZ(9,"input",3),t.NdJ("ngModelChange",function(a){return o.buy.reference=a}),t.qZA()(),t.TgZ(10,"h6")(11,"em"),t._uU(12,"Favor en el precio de compra incluya el precio final incluyendo el impuesto"),t.qZA()(),t.TgZ(13,"table",4)(14,"tr")(15,"th"),t._uU(16,"Product"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Quantity"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Purchase Price"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Tax"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Actions"),t.qZA()(),t.YNc(25,A,15,7,"tr",5),t.qZA(),t.TgZ(26,"h3"),t._uU(27),t.qZA(),t.TgZ(28,"button",6),t.NdJ("click",function(){return o.addProduct()}),t.qZA(),t.TgZ(29,"button",7),t.NdJ("click",function(){return o.save()}),t.qZA()(),t.TgZ(30,"p-dialog",8),t.NdJ("visibleChange",function(a){return o.showSaveDialog=a}),t.TgZ(31,"div",9),t._UZ(32,"i",10),t.TgZ(33,"span"),t._uU(34,"Esta seguro desea agregar esta compra por un total de: "),t.TgZ(35,"b"),t._uU(36),t.qZA(),t._uU(37,"?"),t.qZA()(),t.YNc(38,S,2,0,"ng-template",11),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(3),t.Q6J("showIcon",!0),t.xp6(5),t.Q6J("ngModel",o.buy.reference),t.xp6(16),t.Q6J("ngForOf",o.buy.productLine),t.xp6(2),t.hij("Total L. ",o.getTotal(),""),t.xp6(3),t.Akn(t.DdM(10,J)),t.Q6J("visible",o.showSaveDialog)("modal",!0),t.xp6(6),t.Oqu(o.getTotal()))},dependencies:[u.sg,u.O5,p.YN,p.Kr,p.Fj,p.wV,p.EJ,p.JJ,p.Q7,p.On,l.Hq,d.t,g.Nt,_.XC,_.ZL,y.ey,p.oH,p.u,x.f,b.jx,M.V],styles:['[_ngcontent-%COMP%]:root {\n    --primary-color: #4CAF50;\n    --secondary-color: #45a049;\n    --tertiary-color: #f1f1f1;\n    --quaternary-color: #f9f9f9;\n  }\n\n  \n  th[_ngcontent-%COMP%] {\n    background-color: var(--tertiary-color);\n    font-weight: bold;\n  }\n\n  tr[_ngcontent-%COMP%]:nth-child(even) {\n    background-color: var(--quaternary-color);\n  }\n\n  tr[_ngcontent-%COMP%]:hover {\n    background-color: var(--tertiary-color);\n  }\n\n  button[_ngcontent-%COMP%] {\n    background-color: var(--primary-color);\n    \n  }\n\n  button[_ngcontent-%COMP%]:hover {\n    background-color: var(--secondary-color);\n  }\n\n  \n  input[type="number"][_ngcontent-%COMP%], input[type="text"][_ngcontent-%COMP%], select[_ngcontent-%COMP%] {\n    font-size: 14px;\n    padding: 4px 8px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    outline: none;\n  }\n\n  input[type="number"][_ngcontent-%COMP%]:focus, input[type="text"][_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus {\n    border-color: var(--primary-color);\n    box-shadow: 0 0 4px rgba(76, 175, 80, 0.5);\n  }\n  .large-input[_ngcontent-%COMP%] {\n  width: 300px; \n}']}),n})(),V=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild([{path:"",component:O}]),h.Bz]}),n})();var I=i(4891),F=i(2978);let N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,V,p.u5,l.hJ,I.E,F.lN,g.c,_.Bb,p.UX,x._8,M.S]}),n})()}}]);