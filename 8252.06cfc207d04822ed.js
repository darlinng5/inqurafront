"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[8252],{8252:(b,h,s)=>{s.r(h),s.d(h,{ActivityModule:()=>F});var d=s(9808),g=s(7449),A=s(3003),c=s(574),v=s(9783),e=s(5e3),Z=s(7747),S=s(5384),r=s(3075),u=s(845),m=s(5652),f=s(6186),y=s(7773),x=s(6768);function C(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",5)(1,"label",6),e._uU(2,"Usuarios"),e.qZA(),e.TgZ(3,"app-drop-down",16),e.NdJ("ValueSelectedChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.filterUser(o))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("IsCreating",!1)("showFilter",!0)("DropDownDataSource",t.usersDropDown)}}function T(i,l){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"date"),e.ALo(3,"date"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.AsE(" Reporte del ",e.lcZ(2,2,t.StartDate)," al ",e.lcZ(3,4,t.FinalDate)," ")}}function w(i,l){if(1&i&&(e.TgZ(0,"tr",17)(1,"th",18),e._uU(2),e.qZA(),e.TgZ(3,"th",18),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"th",18),e._uU(7),e.qZA(),e.TgZ(8,"th",18),e._uU(9),e.qZA()()),2&i){const t=l.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(5,4,t.date,"yyyy-MM-dd HH:mm:ss")),e.xp6(3),e.Oqu(t.module),e.xp6(2),e.Oqu(t.message)}}let U=(()=>{class i{constructor(t,n,o,a){this.router=t,this.productService=n,this.messageService=o,this.eventService=a,this.loading=!1,this.InvoiceList=[],this.payReport=[],this.activityReport=[],this.redirect=!1,this.AccessName="/pages/activity"}ngOnInit(){const n=this.eventService.getPermisionsException().split(",").map(o=>o.trim());this.redirect=n.includes(this.AccessName),this.redirect&&this.router.navigateByUrl("/pages/unautorized"),this.userSelected="",this.wareHouseSelectd="",this.GetUsersByRole()}load(){this.loading=!0;var t=new A.c;t.initialDate=this.StartDate,t.finalDate=this.FinalDate,this.getActivityReport(t)}getActivityReport(t){const n=this.eventService.getToken();t.userFilter=null==this.userSelected||"0"==this.userSelected?"ALL":this.userSelected,t.warehouseFilter=null==this.wareHouseSelectd||"0"==this.wareHouseSelectd?"ALL":this.wareHouseSelectd,this.productService.GetActivityReport(t,n).subscribe(o=>{console.log(o),o.data?this.activityReport=o.data:this.messageService.add({severity:"error",summary:"Error",detail:o.message,life:3e3}),this.loading=!1},o=>{this.messageService.add({severity:"error",summary:"Error",detail:o.message,life:3e3}),this.loading=!1})}exportToExcel(){const n=[["Usuario","Fecha","Modulo","Mensaje"]];this.activityReport.forEach(p=>{n.push([p.name,p.date,p.module,p.message])});const o=c.P6.aoa_to_sheet(n),a=c.P6.book_new();c.P6.book_append_sheet(a,o,"Detalle de Actividad"),c.NC(a,"Actividad.xlsx")}filterUser(t){""==t||null==t?this.userSelected="-1":(console.log(t),this.userSelected=t)}GetUsersByRole(){this.isLoading=!0,this.loading=!0,this.productService.GetUsersByRoleValues(this.eventService.getToken()).subscribe(t=>{t.data&&(this.usersDropDown=t.data),this.isLoading=!1,this.loading=!1})}filterWareHouse(t){this.wareHouseSelectd=t,console.log(this.wareHouseSelectd)}GetWareHouseByRole(){this.productService.GetWareHouseByRoleValues(this.eventService.getToken()).subscribe(t=>{t.data&&(this.wareHouseDropDown=t.data),this.isLoading=!1})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.F0),e.Y36(Z.M),e.Y36(v.ez),e.Y36(S.P))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],features:[e._Bn([v.ez])],decls:36,vars:9,consts:[["id","print-section"],[1,"grid"],[1,"col-12"],[1,"card"],[2,"display","flex","flex-wrap","wrap","justify-content","space-between"],[2,"flex","1","margin","5px"],["htmlFor","age1"],["inputId","icon",3,"ngModel","showIcon","ngModelChange"],["style","width: 100%;","style","flex: 1; margin: 5px;",4,"ngIf"],["label","Search","icon","pi pi-search","iconPos","right",1,"space",2,"width","100%",3,"loading","onClick"],["id","PrintFull"],[4,"ngIf"],[2,"background-color","#7288a2","color","white"],["style","font-size: small;",4,"ngFor","ngForOf"],["printSectionId","PrintFull","ngxPrint","","pButton","","pRipple","","label","imprimir","icon","pi pi-print",1,"p-button-help"],["pButton","","pRipple","","label","Exportar a Excel","icon","pi pi-cloud-download",1,"p-button-success","mr-2",2,"margin-left","10px",3,"disabled","click"],[3,"IsCreating","showFilter","DropDownDataSource","ValueSelectedChange"],[2,"font-size","small"],["align","left"]],template:function(t,n){if(1&t&&(e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h4"),e._uU(6,"Reporte de Actividad"),e.qZA(),e.TgZ(7,"div",4)(8,"div",5)(9,"label",6),e._uU(10,"Inicial"),e.qZA(),e.TgZ(11,"p-calendar",7),e.NdJ("ngModelChange",function(a){return n.StartDate=a}),e.qZA()(),e.TgZ(12,"div",5)(13,"label",6),e._uU(14,"Final"),e.qZA(),e.TgZ(15,"p-calendar",7),e.NdJ("ngModelChange",function(a){return n.FinalDate=a}),e.qZA()(),e.YNc(16,C,4,3,"div",8),e.TgZ(17,"div",5)(18,"p-button",9),e.NdJ("onClick",function(){return n.load()}),e.qZA()()(),e._UZ(19,"p")(20,"p"),e.TgZ(21,"div",10),e.YNc(22,T,4,6,"div",11),e.TgZ(23,"table")(24,"tr",12)(25,"th"),e._uU(26,"Usuario"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Fecha"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Modulo"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"Mensaje"),e.qZA()(),e.YNc(33,w,10,7,"tr",13),e.qZA()()()()()(),e._UZ(34,"button",14),e.TgZ(35,"button",15),e.NdJ("click",function(){return n.exportToExcel()}),e.qZA()),2&t){let o,a;e.xp6(11),e.Q6J("ngModel",n.StartDate)("showIcon",!0),e.xp6(4),e.Q6J("ngModel",n.FinalDate)("showIcon",!0),e.xp6(1),e.Q6J("ngIf",!n.isLoading&&(null!==(o=null==n.usersDropDown?null:n.usersDropDown.length)&&void 0!==o?o:0)>0),e.xp6(2),e.Q6J("loading",n.loading),e.xp6(4),e.Q6J("ngIf",(null!==(a=null==n.activityReport?null:n.activityReport.length)&&void 0!==a?a:0)>0),e.xp6(11),e.Q6J("ngForOf",n.activityReport),e.xp6(2),e.Q6J("disabled",!n.activityReport||0===n.activityReport.length)}},dependencies:[d.sg,d.O5,r.JJ,r.On,u.Hq,u.zx,m.f,f.I,y.FN,x.t,d.uU],styles:["table[_ngcontent-%COMP%] {\n    border-collapse: collapse;\n    width: 100%;\n  }\n  \n  tr[_ngcontent-%COMP%] {\n    border-bottom: 1px solid #ddd;\n  }\n  .space[_ngcontent-%COMP%] {\nwidth: 4px;\nheight: auto;\nmargin-left: 20px;\n}"]}),i})(),D=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.Bz.forChild([{path:"",component:U}]),g.Bz]}),i})();var M=s(4036),R=s(4891);let F=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[d.ez,D,r.u5,u.hJ,m._8,u.hJ,r.u5,r.UX,f.K,y.EV,M.kW,R.E]}),i})()}}]);