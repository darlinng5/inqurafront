"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[8252],{8252:(b,g,a)=>{a.r(g),a.d(g,{ActivityModule:()=>F});var d=a(9808),h=a(7449),A=a(3003),c=a(574),v=a(9783),t=a(5e3),Z=a(7747),S=a(5384),r=a(3075),u=a(845),m=a(5652),f=a(6186),y=a(7773),C=a(6768);function T(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",5)(1,"label",6),t._uU(2,"Usuarios"),t.qZA(),t.TgZ(3,"app-drop-down",16),t.NdJ("ValueSelectedChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.filterUser(o))}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("IsCreating",!1)("showFilter",!0)("DropDownDataSource",e.usersDropDown)}}function x(i,s){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.AsE(" Reporte del ",t.lcZ(2,2,e.StartDate)," al ",t.lcZ(3,4,e.FinalDate)," ")}}function w(i,s){if(1&i&&(t.TgZ(0,"tr",17)(1,"th",18),t._uU(2),t.qZA(),t.TgZ(3,"th",18),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"th",18),t._uU(7),t.qZA(),t.TgZ(8,"th",18),t._uU(9),t.qZA()()),2&i){const e=s.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(t.xi3(5,4,e.date,"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(e.module),t.xp6(2),t.Oqu(e.message)}}let D=(()=>{class i{constructor(e,n,o){this.productService=e,this.messageService=n,this.eventService=o,this.loading=!1,this.InvoiceList=[],this.payReport=[],this.activityReport=[]}ngOnInit(){this.userSelected="",this.wareHouseSelectd="",this.GetUsersByRole()}load(){this.loading=!0;var e=new A.c;e.initialDate=this.StartDate,e.finalDate=this.FinalDate,this.getActivityReport(e)}getActivityReport(e){const n=this.eventService.getToken();e.userFilter=null==this.userSelected||"0"==this.userSelected?"ALL":this.userSelected,e.warehouseFilter=null==this.wareHouseSelectd||"0"==this.wareHouseSelectd?"ALL":this.wareHouseSelectd,this.productService.GetActivityReport(e,n).subscribe(o=>{console.log(o),o.data?this.activityReport=o.data:this.messageService.add({severity:"error",summary:"Error",detail:o.message,life:3e3}),this.loading=!1},o=>{this.messageService.add({severity:"error",summary:"Error",detail:o.message,life:3e3}),this.loading=!1})}exportToExcel(){const n=[["Usuario","Fecha","Modulo","Mensaje"]];this.activityReport.forEach(p=>{n.push([p.name,p.date,p.module,p.message])});const o=c.P6.aoa_to_sheet(n),l=c.P6.book_new();c.P6.book_append_sheet(l,o,"Detalle de Actividad"),c.NC(l,"Actividad.xlsx")}filterUser(e){""==e||null==e?this.userSelected="-1":(console.log(e),this.userSelected=e)}GetUsersByRole(){this.isLoading=!0,this.loading=!0,this.productService.GetUsersByRoleValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.usersDropDown=e.data),this.isLoading=!1,this.loading=!1})}filterWareHouse(e){this.wareHouseSelectd=e,console.log(this.wareHouseSelectd)}GetWareHouseByRole(){this.productService.GetWareHouseByRoleValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.wareHouseDropDown=e.data),this.isLoading=!1})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Z.M),t.Y36(v.ez),t.Y36(S.P))},i.\u0275cmp=t.Xpm({type:i,selectors:[["ng-component"]],features:[t._Bn([v.ez])],decls:36,vars:9,consts:[["id","print-section"],[1,"grid"],[1,"col-12"],[1,"card"],[2,"display","flex","flex-wrap","wrap","justify-content","space-between"],[2,"flex","1","margin","5px"],["htmlFor","age1"],["inputId","icon",3,"ngModel","showIcon","ngModelChange"],["style","width: 100%;","style","flex: 1; margin: 5px;",4,"ngIf"],["label","Search","icon","pi pi-search","iconPos","right",1,"space",2,"width","100%",3,"loading","onClick"],["id","PrintFull"],[4,"ngIf"],[2,"background-color","#7288a2","color","white"],["style","font-size: small;",4,"ngFor","ngForOf"],["printSectionId","PrintFull","ngxPrint","","pButton","","pRipple","","label","imprimir","icon","pi pi-print",1,"p-button-help"],["pButton","","pRipple","","label","Exportar a Excel","icon","pi pi-cloud-download",1,"p-button-success","mr-2",2,"margin-left","10px",3,"disabled","click"],[3,"IsCreating","showFilter","DropDownDataSource","ValueSelectedChange"],[2,"font-size","small"],["align","left"]],template:function(e,n){if(1&e&&(t._UZ(0,"p-toast"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h4"),t._uU(6,"Reporte de Actividad"),t.qZA(),t.TgZ(7,"div",4)(8,"div",5)(9,"label",6),t._uU(10,"Inicial"),t.qZA(),t.TgZ(11,"p-calendar",7),t.NdJ("ngModelChange",function(l){return n.StartDate=l}),t.qZA()(),t.TgZ(12,"div",5)(13,"label",6),t._uU(14,"Final"),t.qZA(),t.TgZ(15,"p-calendar",7),t.NdJ("ngModelChange",function(l){return n.FinalDate=l}),t.qZA()(),t.YNc(16,T,4,3,"div",8),t.TgZ(17,"div",5)(18,"p-button",9),t.NdJ("onClick",function(){return n.load()}),t.qZA()()(),t._UZ(19,"p")(20,"p"),t.TgZ(21,"div",10),t.YNc(22,x,4,6,"div",11),t.TgZ(23,"table")(24,"tr",12)(25,"th"),t._uU(26,"Usuario"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Fecha"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Modulo"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Mensaje"),t.qZA()(),t.YNc(33,w,10,7,"tr",13),t.qZA()()()()()(),t._UZ(34,"button",14),t.TgZ(35,"button",15),t.NdJ("click",function(){return n.exportToExcel()}),t.qZA()),2&e){let o,l;t.xp6(11),t.Q6J("ngModel",n.StartDate)("showIcon",!0),t.xp6(4),t.Q6J("ngModel",n.FinalDate)("showIcon",!0),t.xp6(1),t.Q6J("ngIf",!n.isLoading&&(null!==(o=null==n.usersDropDown?null:n.usersDropDown.length)&&void 0!==o?o:0)>0),t.xp6(2),t.Q6J("loading",n.loading),t.xp6(4),t.Q6J("ngIf",(null!==(l=null==n.activityReport?null:n.activityReport.length)&&void 0!==l?l:0)>0),t.xp6(11),t.Q6J("ngForOf",n.activityReport),t.xp6(2),t.Q6J("disabled",!n.activityReport||0===n.activityReport.length)}},dependencies:[d.sg,d.O5,r.JJ,r.On,u.Hq,u.zx,m.f,f.I,y.FN,C.t,d.uU],styles:["table[_ngcontent-%COMP%] {\n    border-collapse: collapse;\n    width: 100%;\n  }\n  \n  tr[_ngcontent-%COMP%] {\n    border-bottom: 1px solid #ddd;\n  }\n  .space[_ngcontent-%COMP%] {\nwidth: 4px;\nheight: auto;\nmargin-left: 20px;\n}"]}),i})(),U=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild([{path:"",component:D}]),h.Bz]}),i})();var M=a(4036),R=a(4891);let F=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.ez,U,r.u5,u.hJ,m._8,u.hJ,r.u5,r.UX,f.K,y.EV,M.kW,R.E]}),i})()}}]);