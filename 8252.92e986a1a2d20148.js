"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[8252],{8252:(b,g,o)=>{o.r(g),o.d(g,{ActivityModule:()=>M});var c=o(6895),u=o(9197),A=o(3003),d=o(574),v=o(805),t=o(4650),Z=o(7747),S=o(5384),l=o(4006),p=o(5593),m=o(585),f=o(5552),y=o(2453),x=o(6768);function T(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",5)(1,"label",6),t._uU(2,"Usuarios"),t.qZA(),t.TgZ(3,"app-drop-down",16),t.NdJ("ValueSelectedChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.filterUser(i))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("IsCreating",!1)("showFilter",!0)("DropDownDataSource",e.usersDropDown)}}function C(n,h){if(1&n&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.AsE(" Reporte del ",t.lcZ(2,2,e.StartDate)," al ",t.lcZ(3,4,e.FinalDate)," ")}}function w(n,h){if(1&n&&(t.TgZ(0,"tr",17)(1,"th",18),t._uU(2),t.qZA(),t.TgZ(3,"th",18),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"th",18),t._uU(7),t.qZA(),t.TgZ(8,"th",18),t._uU(9),t.qZA()()),2&n){const e=h.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(t.xi3(5,4,e.date,"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(e.module),t.xp6(2),t.Oqu(e.message)}}let U=(()=>{class n{constructor(e,s,i,a){this.router=e,this.productService=s,this.messageService=i,this.eventService=a,this.loading=!1,this.InvoiceList=[],this.payReport=[],this.activityReport=[],this.redirect=!1,this.AccessName="/pages/activity"}ngOnInit(){const s=this.eventService.getPermisionsException().split(",").map(i=>i.trim());this.redirect=s.includes(this.AccessName),this.redirect&&this.router.navigateByUrl("/pages/unautorized"),this.userSelected="",this.wareHouseSelectd="",this.GetUsersByRole()}load(){this.loading=!0;var e=new A.c;e.initialDate=this.StartDate,e.finalDate=this.FinalDate,this.getActivityReport(e)}getActivityReport(e){const s=this.eventService.getToken();e.userFilter=null==this.userSelected||"0"==this.userSelected?"ALL":this.userSelected,e.warehouseFilter=null==this.wareHouseSelectd||"0"==this.wareHouseSelectd?"ALL":this.wareHouseSelectd,this.productService.GetActivityReport(e,s).subscribe(i=>{console.log(i),i.data?this.activityReport=i.data:this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.loading=!1},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.loading=!1})}exportToExcel(){const s=[["Usuario","Fecha","Modulo","Mensaje"]];this.activityReport.forEach(r=>{s.push([r.name,r.date,r.module,r.message])});const i=d.P6.aoa_to_sheet(s),a=d.P6.book_new();d.P6.book_append_sheet(a,i,"Detalle de Actividad"),d.NC(a,"Actividad.xlsx")}filterUser(e){""==e||null==e?this.userSelected="-1":(console.log(e),this.userSelected=e)}GetUsersByRole(){this.isLoading=!0,this.loading=!0,this.productService.GetUsersByRoleValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.usersDropDown=e.data),this.isLoading=!1,this.loading=!1})}filterWareHouse(e){this.wareHouseSelectd=e,console.log(this.wareHouseSelectd)}GetWareHouseByRole(){this.productService.GetWareHouseByRoleValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.wareHouseDropDown=e.data),this.isLoading=!1})}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(u.F0),t.Y36(Z.M),t.Y36(v.ez),t.Y36(S.P))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t._Bn([v.ez])],decls:36,vars:9,consts:[["id","print-section"],[1,"grid"],[1,"col-12"],[1,"card"],[2,"display","flex","flex-wrap","wrap","justify-content","space-between"],[2,"flex","1","margin","5px"],["htmlFor","age1"],["inputId","icon",3,"ngModel","showIcon","ngModelChange"],["style","width: 100%;","style","flex: 1; margin: 5px;",4,"ngIf"],["label","Search","icon","pi pi-search","iconPos","right",1,"space",2,"width","100%",3,"loading","onClick"],["id","PrintFull"],[4,"ngIf"],[2,"background-color","#7288a2","color","white"],["style","font-size: small;",4,"ngFor","ngForOf"],["printSectionId","PrintFull","ngxPrint","","pButton","","pRipple","","label","imprimir","icon","pi pi-print",1,"p-button-help"],["pButton","","pRipple","","label","Exportar a Excel","icon","pi pi-cloud-download",1,"p-button-success","mr-2",2,"margin-left","10px",3,"disabled","click"],[3,"IsCreating","showFilter","DropDownDataSource","ValueSelectedChange"],[2,"font-size","small"],["align","left"]],template:function(s,i){if(1&s&&(t._UZ(0,"p-toast"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h4"),t._uU(6,"Reporte de Actividad"),t.qZA(),t.TgZ(7,"div",4)(8,"div",5)(9,"label",6),t._uU(10,"Inicial"),t.qZA(),t.TgZ(11,"p-calendar",7),t.NdJ("ngModelChange",function(r){return i.StartDate=r}),t.qZA()(),t.TgZ(12,"div",5)(13,"label",6),t._uU(14,"Final"),t.qZA(),t.TgZ(15,"p-calendar",7),t.NdJ("ngModelChange",function(r){return i.FinalDate=r}),t.qZA()(),t.YNc(16,T,4,3,"div",8),t.TgZ(17,"div",5)(18,"p-button",9),t.NdJ("onClick",function(){return i.load()}),t.qZA()()(),t._UZ(19,"p")(20,"p"),t.TgZ(21,"div",10),t.YNc(22,C,4,6,"div",11),t.TgZ(23,"table")(24,"tr",12)(25,"th"),t._uU(26,"Usuario"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Fecha"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Modulo"),t.qZA(),t.TgZ(31,"th"),t._uU(32,"Mensaje"),t.qZA()(),t.YNc(33,w,10,7,"tr",13),t.qZA()()()()()(),t._UZ(34,"button",14),t.TgZ(35,"button",15),t.NdJ("click",function(){return i.exportToExcel()}),t.qZA()),2&s){let a,r;t.xp6(11),t.Q6J("ngModel",i.StartDate)("showIcon",!0),t.xp6(4),t.Q6J("ngModel",i.FinalDate)("showIcon",!0),t.xp6(1),t.Q6J("ngIf",!i.isLoading&&(null!==(a=null==i.usersDropDown?null:i.usersDropDown.length)&&void 0!==a?a:0)>0),t.xp6(2),t.Q6J("loading",i.loading),t.xp6(4),t.Q6J("ngIf",(null!==(r=null==i.activityReport?null:i.activityReport.length)&&void 0!==r?r:0)>0),t.xp6(11),t.Q6J("ngForOf",i.activityReport),t.xp6(2),t.Q6J("disabled",!i.activityReport||0===i.activityReport.length)}},dependencies:[c.sg,c.O5,l.JJ,l.On,p.Hq,p.zx,m.f,f.IH,y.FN,x.t,c.uU],styles:["table[_ngcontent-%COMP%] {\n    border-collapse: collapse;\n    width: 100%;\n  }\n  \n  tr[_ngcontent-%COMP%] {\n    border-bottom: 1px solid #ddd;\n  }\n  .space[_ngcontent-%COMP%] {\nwidth: 4px;\nheight: auto;\nmargin-left: 20px;\n}"]})}return n})(),D=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=t.oAB({type:n});static#i=this.\u0275inj=t.cJS({imports:[u.Bz.forChild([{path:"",component:U}]),u.Bz]})}return n})();var R=o(2210),F=o(4891);let M=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=t.oAB({type:n});static#i=this.\u0275inj=t.cJS({imports:[c.ez,D,l.u5,p.hJ,m._8,p.hJ,l.u5,l.UX,f.K8,y.EV,R.kW,F.E]})}return n})()}}]);