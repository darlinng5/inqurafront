"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[3517],{3517:(_,R,n)=>{n.r(R),n.d(R,{AccountReceivableModule:()=>W});var g=n(6895),y=n(9197),U=n(5861),x=n(805),p=n(574),D=n(6166),F=n(4159),L=n.n(F),t=n(4650),w=n(7747),H=n(5384),C=n(5593),Z=n(5552),T=n(2453),B=n(6768),P=n(1383);function I(i,k){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"currency"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.ALo(20,"currency"),t.qZA()()),2&i){const e=k.$implicit;t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(t.gM2(7,8,e.total,"L.","symbol","1.2-2")),t.xp6(3),t.Oqu(t.xi3(10,13,e.firstInvoice,"dd/MM/yyyy")),t.xp6(3),t.Oqu(t.gM2(13,16,e.maxAmountCredit,"L.","symbol","1.2-2")),t.xp6(3),t.Oqu(e.maxDayCredit),t.xp6(2),t.Oqu(e.dayCreditRest),t.xp6(2),t.Oqu(t.gM2(20,21,e.amoutCreditRest,"L.","symbol","1.2-2"))}}let z=(()=>{class i{constructor(e,o,a,s){this.router=e,this.productService=o,this.messageService=a,this.eventService=s,this.loading=!1,this.InvoiceList=[],this.payReport=[],this.redirect=!1,this.AccessName="/pages/receivable",this.accountFilter="Receivable",this.accountReceivableReport=[],this.AccountFilterList=[]}ngOnInit(){const o=this.eventService.getPermisionsException().split(",").map(a=>a.trim());this.redirect=o.includes(this.AccessName),this.redirect&&this.router.navigateByUrl("/pages/unautorized"),this.userSelected="",this.wareHouseSelectd="",this.AccountFilterList.push({value:"Receivable",viewValue:"Cuentas x Cobrar"}),this.AccountFilterList.push({value:"Payable",viewValue:"Cuentas x Pagar"}),this.GetUsersByRole(),this.GetWareHouseByRole()}load(){this.loading=!0,this.getAccountReceibableReport()}getAccountReceibableReport(){const e=this.eventService.getToken();this.productService.GetAccountReceivableReport(e,this.accountFilter).subscribe(o=>{console.log(o),o.data?(this.accountReceivableReport=o.data,console.log(this.accountReceivableReport)):this.messageService.add({severity:"error",summary:"Error",detail:o.message,life:3e3}),this.loading=!1},o=>{this.messageService.add({severity:"error",summary:"Error",detail:o.message,life:3e3}),this.loading=!1})}exportToExcel(){const o=[["Id","Cliente","Credito Actual","Factura Antigua","Maximo Credito Autorizado","Maximo Dias Autorizado","Dias Sobregirado","Monto Sobregirado"]];this.accountReceivableReport.forEach(r=>{o.push([r.id,r.name,r.total,r.firstInvoice,r.maxAmountCredit,r.maxDayCredit,r.dayCreditRest,r.amoutCreditRest])});const a=p.P6.aoa_to_sheet(o),s=p.P6.book_new();p.P6.book_append_sheet(s,a,"Detalle de CC");const v=[["Nombre de Pago","Tipo de Pago","Total"]];this.payReport.forEach(r=>{v.push([r.payName,r.payType,r.total])}),p.P6.aoa_to_sheet(v),p.NC(s,"DetalllesCC.xlsx")}filterUser(e){this.accountFilter=""==e||null==e?"":e}GetUsersByRole(){this.isLoading=!0,this.productService.GetUsersByRoleValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.usersDropDown=e.data,console.log(this.usersDropDown))})}filterWareHouse(e){this.wareHouseSelectd=e,console.log(this.wareHouseSelectd)}GetWareHouseByRole(){this.productService.GetWareHouseByRoleValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.wareHouseDropDown=e.data),this.isLoading=!1})}printReport(){var e=this;return(0,U.Z)(function*(){e.messageService.add({severity:"info",summary:"Info",detail:"El reporte se esta generando, favor espere",life:3e3}),e.isLoading=!0;const o=document.getElementById("print-section"),a=new D.ZP("p","pt","a4"),s={background:"white",scale:3},m=a.internal.pageSize.getWidth(),v=a.internal.pageSize.getHeight(),c={top:15,bottom:15,left:15,right:15},r=m-c.left-c.right,d=v-c.top-c.bottom;function j(l,M,u){M.addImage(l,"PNG",c.left,u,r,0,void 0,"FAST")}try{const l=yield L()(o,s),u=(l.toDataURL("image/png"),l.width),h=u/r;let f=l.height/h,O=c.top,S=1;for(;f>0;){const A=Math.min(d,f),b=document.createElement("canvas"),X=b.getContext("2d");b.width=u,b.height=A*h,X.drawImage(l,0,(S-1)*d*h,u,A*h,0,0,u,A*h),j(b.toDataURL("image/png"),a,O),f-=d,O=c.top,f>0&&(a.addPage(),S++)}const Q=a.output("blob"),K=URL.createObjectURL(Q);e.isLoading=!1,window.open(K,"_blank")}catch(l){console.error("Error generando PDF:",l),e.isLoading=!1}})()}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(y.F0),t.Y36(w.M),t.Y36(x.ez),t.Y36(H.P))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["ng-component"]],features:[t._Bn([x.ez])],decls:39,vars:6,consts:[["id","print-section"],[1,"grid"],[1,"col-12"],[1,"card"],[1,"form-container"],[1,"form-item"],["for","age1"],[3,"IsCreating","showFilter","DropDownDataSource","ValueSelectedChange"],["label","Buscar","icon","pi pi-search","iconPos","right",1,"space",2,"width","100%",3,"loading","onClick"],["id","PrintFull"],[1,"styled-table"],[4,"ngFor","ngForOf"],[2,"margin-top","20px"],["styleClass","mb-4"],[1,"my-2"],["ngxPrint","","pButton","","pRipple","","label","imprimir","icon","pi pi-print",1,"p-button-help",3,"click"],["pButton","","pRipple","","label","Exportar a Excel","icon","pi pi-cloud-download",1,"p-button-success","mr-2",2,"margin-left","10px",3,"disabled","click"]],template:function(o,a){1&o&&(t._UZ(0,"p-toast"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),t._uU(8,"Tipo"),t.qZA(),t.TgZ(9,"app-drop-down",7),t.NdJ("ValueSelectedChange",function(m){return a.filterUser(m)}),t.qZA()(),t.TgZ(10,"div",5)(11,"p-button",8),t.NdJ("onClick",function(){return a.load()}),t.qZA()()(),t.TgZ(12,"div",9)(13,"table",10)(14,"thead")(15,"tr")(16,"th"),t._uU(17,"Id"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Cliente"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Credito Actual"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Factura Antigua"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Maximo Credito Autorizado"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Maximo Dias Autorizado"),t.qZA(),t.TgZ(28,"th"),t._uU(29,"Dias Sobregirado"),t.qZA(),t.TgZ(30,"th"),t._uU(31,"Monto Sobregirado"),t.qZA()()(),t.TgZ(32,"tbody"),t.YNc(33,I,21,26,"tr",11),t.qZA()()()()()()(),t.TgZ(34,"div",12)(35,"p-toolbar",13)(36,"div",14)(37,"button",15),t.NdJ("click",function(){return a.printReport()}),t.qZA(),t.TgZ(38,"button",16),t.NdJ("click",function(){return a.exportToExcel()}),t.qZA()()()()),2&o&&(t.xp6(9),t.Q6J("IsCreating",!1)("showFilter",!1)("DropDownDataSource",a.AccountFilterList),t.xp6(2),t.Q6J("loading",a.loading),t.xp6(22),t.Q6J("ngForOf",a.accountReceivableReport),t.xp6(5),t.Q6J("disabled",!a.accountReceivableReport||0===a.accountReceivableReport.length))},dependencies:[g.sg,C.Hq,C.zx,Z.IH,T.FN,B.t,P.o,g.H9,g.uU],styles:["[_nghost-%COMP%] {\n  --primary-color: #023b78;\n  --secondary-color: #1565bb;\n  --background-color: #f0f8ff;\n  --text-color: #333;\n  --border-color: #ccc;\n  --hover-color: #e9ecef;\n\n  font-family: 'Arial', sans-serif;\n  color: var(--text-color);\n  padding: 20px;\n}\n\n.form-container[_ngcontent-%COMP%] {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  margin-bottom: 15px;\n}\n\n.form-item[_ngcontent-%COMP%] {\n  flex: 1;\n  margin: 5px;\n  min-width: 150px;\n}\n\n.styled-table[_ngcontent-%COMP%] {\n  width: 100%;\n  border-collapse: collapse;\n  background-color: var(--background-color);\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n}\n\n.styled-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] {\n  background-color: var(--primary-color);\n  color: #ffffff;\n  text-align: left;\n}\n\n.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .styled-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\n  padding: 12px 15px;\n  border: 1px solid var(--border-color);\n}\n\n.styled-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] {\n  font-size: small;\n  color: var(--text-color);\n}\n\n.styled-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even) {\n  background-color: var(--hover-color);\n}\n\n.styled-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover {\n  background-color: var( --hover-color);\n}"]})}return i})(),E=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#o=this.\u0275inj=t.cJS({imports:[y.Bz.forChild([{path:"",component:z}]),y.Bz]})}return i})();var N=n(4006),J=n(5117),q=n(585),G=n(2210),V=n(4891);let W=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#e=this.\u0275mod=t.oAB({type:i});static#o=this.\u0275inj=t.cJS({imports:[g.ez,E,N.u5,C.hJ,g.ez,J.L,q._8,Z.K8,T.EV,G.kW,V.E,P.V]})}return i})()}}]);