"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[464],{464:(me,se,A)=>{A.r(se),A.d(se,{InventoryModule:()=>r});var L=A(9808),C=A(7449),de=A(1546),ue=A(9783);class le{}var N=A(5108),t=A(5e3),I=A(520),E=A(7747),G=A(5384),D=A(5315),ve=A(7010),K=A(3075),Ce=A(845),Q=A(7116),ge=A(6768),q=A(7773),be=A(3407);function Se(e,n){1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-progress-bar"),t.qZA())}function xe(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",25)(1,"label",26),t._uU(2,"Productos "),t.qZA(),t._UZ(3,"label",26),t.TgZ(4,"app-drop-down",27),t.NdJ("ValueSelectedChange",function(o){t.CHM(i);const d=t.oxw(2);return t.KtG(d.filterProduct(o))}),t.qZA()()}if(2&e){const i=t.oxw(2);t.xp6(4),t.Q6J("IsCreating",!1)("showFilter",!0)("DropDownDataSource",i.products)}}function k(e,n){1&e&&(t.TgZ(0,"div")(1,"h4"),t._uU(2,"Cargando los productos, espere..."),t.qZA()())}function Ae(e,n){if(1&e){const i=t.EpF();t.YNc(0,xe,5,3,"div",16),t.YNc(1,k,3,0,"div",0),t.TgZ(2,"div",17)(3,"div",18)(4,"label",19),t._uU(5,"Precio de Compra"),t.qZA(),t.TgZ(6,"p-inputNumber",20),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.buyCost=o)}),t.qZA()(),t.TgZ(7,"div",18)(8,"label",21),t._uU(9,"Cantidad"),t.qZA(),t.TgZ(10,"p-inputNumber",22),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.quantity=o)}),t.qZA()()(),t.TgZ(11,"div",17)(12,"div",18)(13,"label",23),t._uU(14,"Precio de Venta"),t.qZA(),t.TgZ(15,"p-inputNumber",20),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.priceSale=o)}),t.qZA()()(),t.TgZ(16,"div",17)(17,"div",18)(18,"label",23),t._uU(19,"Descripci\xf3n"),t.qZA(),t.TgZ(20,"textarea",24),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.description=o)}),t.qZA()()()}if(2&e){const i=t.oxw();t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.buyCost),t.xp6(4),t.Q6J("ngModel",i.inventoryTransaccion.quantity),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.priceSale),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.description)}}function Ie(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.hideDialog())}),t.qZA(),t.TgZ(1,"button",29),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.postTransaccion(o.inventoryTransaccion))}),t.qZA()}}function ne(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",25)(1,"label",26),t._uU(2,"Productos "),t.qZA(),t._UZ(3,"label",26),t.TgZ(4,"app-drop-down",30),t.NdJ("ValueSelectedChange",function(o){t.CHM(i);const d=t.oxw(2);return t.KtG(d.filterProduct(o))}),t.qZA()()}if(2&e){const i=t.oxw(2);t.xp6(4),t.Q6J("showFilter",!0)("IsCreating",!1)("DropDownDataSource",i.products)}}function ee(e,n){1&e&&(t.TgZ(0,"div")(1,"h4"),t._uU(2,"Cargando los productos, espere..."),t.qZA()())}function j(e,n){if(1&e){const i=t.EpF();t.YNc(0,ne,5,3,"div",16),t.YNc(1,ee,3,0,"div",0),t.TgZ(2,"div",17)(3,"div",18)(4,"label",19),t._uU(5,"Costo individual"),t.qZA(),t.TgZ(6,"p-inputNumber",20),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.buyCost=o)}),t.qZA()(),t.TgZ(7,"div",18)(8,"label",21),t._uU(9,"Cantidad"),t.qZA(),t.TgZ(10,"p-inputNumber",22),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.quantity=o)}),t.qZA()()(),t.TgZ(11,"div",17)(12,"div",18)(13,"label",23),t._uU(14,"Descripci\xf3n"),t.qZA(),t.TgZ(15,"textarea",24),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.description=o)}),t.qZA()()()}if(2&e){const i=t.oxw();t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.buyCost),t.xp6(4),t.Q6J("ngModel",i.inventoryTransaccion.quantity),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.description)}}function ye(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.hideDialog())}),t.qZA(),t.TgZ(1,"button",29),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.postTransaccion(o.inventoryTransaccion))}),t.qZA()}}function we(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",25)(1,"label",26),t._uU(2,"Productos "),t.qZA(),t._UZ(3,"label",26),t.TgZ(4,"app-drop-down",30),t.NdJ("ValueSelectedChange",function(o){t.CHM(i);const d=t.oxw(2);return t.KtG(d.filterProduct(o))}),t.qZA()()}if(2&e){const i=t.oxw(2);t.xp6(4),t.Q6J("showFilter",!0)("IsCreating",!1)("DropDownDataSource",i.products)}}function Re(e,n){1&e&&(t.TgZ(0,"div")(1,"h4"),t._uU(2,"Cargando los productos, espere..."),t.qZA()())}function _e(e,n){if(1&e){const i=t.EpF();t.YNc(0,we,5,3,"div",16),t.YNc(1,Re,3,0,"div",0),t.TgZ(2,"div",17)(3,"div",18)(4,"label",19),t._uU(5,"Costo individual"),t.qZA(),t.TgZ(6,"p-inputNumber",20),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.buyCost=o)}),t.qZA()(),t.TgZ(7,"div",18)(8,"label",21),t._uU(9,"Cantidad"),t.qZA(),t.TgZ(10,"p-inputNumber",22),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.quantity=o)}),t.qZA()()(),t.TgZ(11,"div",17)(12,"div",18)(13,"label",23),t._uU(14,"Descripci\xf3n"),t.qZA(),t.TgZ(15,"textarea",24),t.NdJ("ngModelChange",function(o){t.CHM(i);const d=t.oxw();return t.KtG(d.inventoryTransaccion.description=o)}),t.qZA()()()}if(2&e){const i=t.oxw();t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.buyCost),t.xp6(4),t.Q6J("ngModel",i.inventoryTransaccion.quantity),t.xp6(5),t.Q6J("ngModel",i.inventoryTransaccion.description)}}function V(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.hideDialog())}),t.qZA(),t.TgZ(1,"button",29),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.postTransaccion(o.inventoryTransaccion))}),t.qZA()}}const re=function(){return{width:"2.5rem",height:"2.5rem"}},ce=function(){return{width:"650px"}};let Me=(()=>{class e{constructor(i,s,o,d){this.http=i,this.productService=s,this.eventService=o,this.messageService=d,this.showBuyDialog=!1,this.showAddDialog=!1,this.showReduceDialog=!1,this.inventoryTransaccion=new le,this.isLoading=!1,this.getProductValues()}setInventaryTransaction(i){"Buy"==i?(this.transaccionInventaryType="Buy",this.showBuyDialog=!0):"AdjustmentAdd"==i?(this.transaccionInventaryType="AdjustmentAdd",this.showAddDialog=!0):"AdjustmentReduce"==i&&(this.transaccionInventaryType="AdjustmentReduce",this.showReduceDialog=!0)}hideDialog(){this.transaccionInventaryType="",this.showBuyDialog=!1,this.showAddDialog=!1,this.showReduceDialog=!1}getProductValues(){this.isLoading=!0,this.productService.GetProductsValues(this.eventService.getToken()).subscribe(i=>{i.data&&(this.products=i.data),this.isLoading=!1})}filterProduct(i){this.inventoryTransaccion.productId=i}postTransaccion(i){this.isLoading=!0,this.inventoryTransaccion.productId=null==this.inventoryTransaccion.productId?0:this.inventoryTransaccion.productId,this.inventoryTransaccion.buyCost=null==i.buyCost?0:i.buyCost,this.inventoryTransaccion.priceSale=null==i.priceSale?0:i.priceSale,this.inventoryTransaccion.quantity=null==i.quantity?0:i.quantity,this.inventoryTransaccion.transaccionType=null==this.transaccionInventaryType?"":this.transaccionInventaryType,this.inventoryTransaccion.wareHouse=0,this.inventoryTransaccion.description=null==i.description?"":i.description,this.inventoryTransaccion.userId=this.eventService.getToken(),this.hideDialog(),this.productService.AddProductTransaccion(this.inventoryTransaccion).subscribe(s=>{this.messageService.add(s.data?{severity:"success",summary:"Success",detail:"Se ha guardado de forma correcta",life:3e3}:{severity:"error",summary:"error",detail:s.message,life:3e3}),this.isLoading=!1})}startRecording(){navigator.mediaDevices.getUserMedia({audio:!0}).then(i=>{this.recorder=new N(i,{type:"audio",mimeType:"audio/wav"}),this.recorder.startRecording()})}stopRecording(){this.recorder.stopRecording(()=>{const i=this.recorder.getBlob(),s=URL.createObjectURL(i);console.log(s),console.log("Tama\xf1o del audioBlob:",i.size);const o=new FormData;o.append("audioStream",i,"audio.wav"),fetch("http://localhost:5134/api/Product/PostAudio",{method:"GET",body:o}).then(d=>{if(d.ok)return d.json();throw new Error("Error en la solicitud")}).then(d=>{console.log("Respuesta:",d)}).catch(d=>{console.error("Error en la solicitud:",d)})})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(I.eN),t.Y36(E.M),t.Y36(G.P),t.Y36(ue.ez))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],features:[t._Bn([ue.ez])],decls:45,vars:22,consts:[[4,"ngIf"],[1,"grid"],[1,"col-12","lg:col-6","xl:col-3",3,"click"],[1,"card","mb-0"],[1,"flex","justify-content-between","mb-3"],[1,"block","text-500","font-medium","mb-3"],[1,"flex","align-items-center","justify-content-center","bg-blue-100","border-round",3,"ngStyle"],[1,"pi","pi-plus-circle","text-green-500","text-xl"],[1,"text-green-500","font-medium"],[1,"text-500"],[1,"pi","pi-minus-circle","text-red-500","text-xl"],["header","Agregar Inventario",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Ajuste de inventario: Agregar",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Ajuste de inventario: Rebajar",1,"p-fluid",3,"visible","modal","visibleChange"],["class","field",4,"ngIf"],[1,"formgrid","grid"],[1,"field","col"],["for","price"],["id","price","mode","currency","currency","LPS","locale","en-US",3,"ngModel","ngModelChange"],["for","quantity"],["id","quantity",3,"ngModel","ngModelChange"],["for","productPrice"],["id","description","pInputTextarea","","required","","rows","3","cols","20",3,"ngModel","ngModelChange"],[1,"field"],["for","status"],[3,"IsCreating","showFilter","DropDownDataSource","ValueSelectedChange"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"],[3,"showFilter","IsCreating","DropDownDataSource","ValueSelectedChange"]],template:function(i,s){1&i&&(t.YNc(0,Se,2,0,"div",0),t._UZ(1,"p-toast"),t.TgZ(2,"div",1)(3,"div",2),t.NdJ("click",function(){return s.setInventaryTransaction("Buy")}),t.TgZ(4,"div",3)(5,"div",4)(6,"div")(7,"span",5),t._uU(8,"Compras"),t.qZA()(),t.TgZ(9,"div",6),t._UZ(10,"i",7),t.qZA()(),t.TgZ(11,"span",8),t._uU(12,"Agregar"),t.qZA(),t._UZ(13,"span",9),t.qZA()(),t.TgZ(14,"div",2),t.NdJ("click",function(){return s.setInventaryTransaction("AdjustmentAdd")}),t.TgZ(15,"div",3)(16,"div",4)(17,"div")(18,"span",5),t._uU(19,"Ajuste:Agregar"),t.qZA()(),t.TgZ(20,"div",6),t._UZ(21,"i",7),t.qZA()(),t.TgZ(22,"span",8),t._uU(23,"Agregar"),t.qZA(),t._UZ(24,"span",9),t.qZA()(),t.TgZ(25,"div",2),t.NdJ("click",function(){return s.setInventaryTransaction("AdjustmentReduce")}),t.TgZ(26,"div",3)(27,"div",4)(28,"div")(29,"span",5),t._uU(30,"Ajuste:Reducir"),t.qZA()(),t.TgZ(31,"div",6),t._UZ(32,"i",10),t.qZA()(),t.TgZ(33,"span",8),t._uU(34,"Reducir"),t.qZA(),t._UZ(35,"span",9),t.qZA()()(),t.TgZ(36,"p-dialog",11),t.NdJ("visibleChange",function(d){return s.showBuyDialog=d}),t.YNc(37,Ae,21,6,"ng-template",12),t.YNc(38,Ie,2,0,"ng-template",13),t.qZA(),t.TgZ(39,"p-dialog",14),t.NdJ("visibleChange",function(d){return s.showAddDialog=d}),t.YNc(40,j,16,5,"ng-template",12),t.YNc(41,ye,2,0,"ng-template",13),t.qZA(),t.TgZ(42,"p-dialog",15),t.NdJ("visibleChange",function(d){return s.showReduceDialog=d}),t.YNc(43,_e,16,5,"ng-template",12),t.YNc(44,V,2,0,"ng-template",13),t.qZA()),2&i&&(t.Q6J("ngIf",s.isLoading),t.xp6(9),t.Q6J("ngStyle",t.DdM(16,re)),t.xp6(11),t.Q6J("ngStyle",t.DdM(17,re)),t.xp6(11),t.Q6J("ngStyle",t.DdM(18,re)),t.xp6(5),t.Akn(t.DdM(19,ce)),t.Q6J("visible",s.showBuyDialog)("modal",!0),t.xp6(3),t.Akn(t.DdM(20,ce)),t.Q6J("visible",s.showAddDialog)("modal",!0),t.xp6(3),t.Akn(t.DdM(21,ce)),t.Q6J("visible",s.showReduceDialog)("modal",!0))},dependencies:[L.O5,L.PC,D.V,ue.jx,ve.Rn,K.Fj,K.JJ,K.Q7,K.On,Ce.Hq,Q.R,ge.t,q.FN,be.g],styles:["div[_ngcontent-%COMP%]:hover {\n  cursor: pointer;\n}"]}),e})(),Ue=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[C.Bz.forChild([{path:"",component:Me,canActivate:[de.j]}]),C.Bz]}),e})();var fe=A(4891);let r=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[L.ez,Ue,D.S,ve.L$,K.u5,Ce.hJ,fe.E,q.EV,be.A]}),e})()},5108:(me,se)=>{var L,r;function C(r,e){if(!r)throw"First parameter is required.";e=new de(r,e=e||{type:"video"});var n=this;function s(h){h&&(e.initCallback=function(){h(),h=e.initCallback=null});var c=new ue(r,e);(f=new c(r,e)).record(),y("recording"),e.disableLogs||console.log("Initialized recorderType:",f.constructor.name,"for output-type:",e.type)}function o(h){if(h=h||function(){},f){if("paused"===n.state)return n.resumeRecording(),void setTimeout(function(){o(h)},1);"recording"!==n.state&&!e.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',n.state),e.disableLogs||console.log("Stopped recording "+e.type+" stream."),"gif"!==e.type?f.stop(c):(f.stop(),c()),y("stopped")}else v();function c(g){if(f){Object.keys(f).forEach(function(w){"function"!=typeof f[w]&&(n[w]=f[w])});var u=f.blob;if(!u){if(!g)throw"Recording failed.";f.blob=u=g}if(u&&!e.disableLogs&&console.log(u.type,"->",be(u.size)),h){var l;try{l=D.createObjectURL(u)}catch(w){}"function"==typeof h.call?h.call(n,l):h(l)}!e.autoWriteToDisk||T(function(w){var R={};R[e.type+"Blob"]=w,V.Store(R)})}else"function"==typeof h.call?h.call(n,""):h("")}}function m(h){postMessage((new FileReaderSync).readAsDataURL(h))}function T(h,c){if(!h)throw"Pass a callback function over getDataURL.";var g=c?c.blob:(f||{}).blob;if(!g)return e.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout(function(){T(h,c)},1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var l=new FileReader;l.readAsDataURL(g),l.onload=function(R){h(R.target.result)}}else{var u=function w(R){try{var M=D.createObjectURL(new Blob([R.toString(),"this.onmessage =  function (eee) {"+R.name+"(eee.data);}"],{type:"application/javascript"})),x=new Worker(M);return D.revokeObjectURL(M),x}catch(Z){}}(m);u.onmessage=function(R){h(R.data)},u.postMessage(g)}}function p(h){if(h=h||0,"paused"!==n.state){if("stopped"!==n.state){if(h>=n.recordingDuration)return void o(n.onRecordingStopped);h+=1e3,setTimeout(function(){p(h)},1e3)}}else setTimeout(function(){p(h)},1e3)}function y(h){!n||(n.state=h,"function"==typeof n.onStateChanged.call?n.onStateChanged.call(n,h):n.onStateChanged(h))}var b='It seems that recorder is destroyed or "startRecording" is not invoked for '+e.type+" recorder.";function v(){!0!==e.disableLogs&&console.warn(b)}var f,_={startRecording:function i(h){return e.disableLogs||console.log("RecordRTC version: ",n.version),h&&(e=new de(r,h)),e.disableLogs||console.log("started recording "+e.type+" stream."),f?(f.clearRecordedData(),f.record(),y("recording"),n.recordingDuration&&p(),n):(s(function(){n.recordingDuration&&p()}),n)},stopRecording:o,pauseRecording:function d(){f?"recording"===n.state?(y("paused"),f.pause(),e.disableLogs||console.log("Paused recording.")):e.disableLogs||console.warn("Unable to pause the recording. Recording state: ",n.state):v()},resumeRecording:function a(){f?"paused"===n.state?(y("recording"),f.resume(),e.disableLogs||console.log("Resumed recording.")):e.disableLogs||console.warn("Unable to resume the recording. Recording state: ",n.state):v()},initRecorder:s,setRecordingDuration:function(h,c){if(void 0===h)throw"recordingDuration is required.";if("number"!=typeof h)throw"recordingDuration must be a number.";return n.recordingDuration=h,n.onRecordingStopped=c||function(){},{onRecordingStopped:function(g){n.onRecordingStopped=g}}},clearRecordedData:function(){f?(f.clearRecordedData(),e.disableLogs||console.log("Cleared old recorded data.")):v()},getBlob:function(){if(f)return f.blob;v()},getDataURL:T,toURL:function(){if(f)return D.createObjectURL(f.blob);v()},getInternalRecorder:function(){return f},save:function(h){f?Se(f.blob,h):v()},getFromDisk:function(h){f?C.getFromDisk(e.type,h):v()},setAdvertisementArray:function(h){e.advertisement=[];for(var c=h.length,g=0;g<c;g++)e.advertisement.push({duration:g,image:h[g]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"===n.state&&!e.disableLogs&&console.warn("Stop an active recorder."),f&&"function"==typeof f.clearRecordedData&&f.clearRecordedData(),f=null,y("inactive"),n.blob=null},onStateChanged:function(h){e.disableLogs||console.log("Recorder state changed:",h)},state:"inactive",getState:function(){return n.state},destroy:function(){var h=e.disableLogs;e={disableLogs:!0},n.reset(),y("destroyed"),_=n=null,ne.AudioContextConstructor&&(ne.AudioContextConstructor.close(),ne.AudioContextConstructor=null),e.disableLogs=h,e.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return n=_,_;for(var S in _)this[S]=_[S];return n=this,_}function de(r,e){return!e.recorderType&&!e.type&&(e.audio&&e.video?e.type="video":!!e.audio&&!e.video&&(e.type="audio")),e.recorderType&&!e.type&&(e.recorderType===Re||e.recorderType===we||void 0!==fe&&e.recorderType===fe?e.type="video":e.recorderType===re?e.type="gif":e.recorderType===ye?e.type="audio":e.recorderType===j&&(k(r,"audio").length&&k(r,"video").length||!k(r,"audio").length&&k(r,"video").length?e.type="video":k(r,"audio").length&&!k(r,"video").length&&(e.type="audio"))),void 0!==j&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(e.mimeType||(e.mimeType="video/webm"),e.type||(e.type=e.mimeType.split("/")[0])),e.type||(e.mimeType&&(e.type=e.mimeType.split("/")[0]),e.type||(e.type="audio")),e}function ue(r,e){var n;return(Q||ve||K)&&(n=ye),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!Q&&(n=j),"video"===e.type&&(Q||K)&&(n=Re,void 0!==fe&&"undefined"!=typeof ReadableStream&&(n=fe)),"gif"===e.type&&(n=re),"canvas"===e.type&&(n=we),ee()&&n!==we&&n!==re&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(k(r,"video").length||k(r,"audio").length)&&("audio"===e.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(n=j):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(n=j)),r instanceof Array&&r.length&&(n=Me),e.recorderType&&(n=e.recorderType),!e.disableLogs&&!!n&&!!n.name&&console.log("Using recorderType:",n.name||n.constructor.name),!n&&ge&&(n=j),n}function le(r){this.addStream=function(e){e&&(r=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var n,e=this.mediaType,i=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof e.audio&&ee()&&!k(r,"audio").length&&(e.audio=!1),"function"!=typeof e.video&&ee()&&!k(r,"video").length&&(e.video=!1),"function"!=typeof e.gif&&ee()&&!k(r,"video").length&&(e.gif=!1),!e.audio&&!e.video&&!e.gif)throw"MediaStream must have either audio or video tracks.";if(e.audio&&(n=null,"function"==typeof e.audio&&(n=e.audio),this.audioRecorder=new C(r,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:n,mimeType:i.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),e.video||this.audioRecorder.startRecording()),e.video){n=null,"function"==typeof e.video&&(n=e.video);var s=r;if(ee()&&e.audio&&"function"==typeof e.audio){var o=k(r,"video")[0];Ce?((s=new q).addTrack(o),n&&n===Re&&(n=j)):(s=new q).addTrack(o)}this.videoRecorder=new C(s,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:n,mimeType:i.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),e.audio||this.videoRecorder.startRecording()}if(e.audio&&e.video){var d=this,a=!0===ee();(e.audio instanceof ye&&!!e.video||!0!==e.audio&&!0!==e.video&&e.audio!==e.video)&&(a=!1),!0===a?(d.audioRecorder=null,d.videoRecorder.startRecording()):d.videoRecorder.initRecorder(function(){d.audioRecorder.initRecorder(function(){d.videoRecorder.startRecording(),d.audioRecorder.startRecording()})})}e.gif&&(n=null,"function"==typeof e.gif&&(n=e.gif),this.gifRecorder=new C(r,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:n,mimeType:i.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(n){e(n,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(n){e(n,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(n){e(n,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var n={};return this.audioRecorder&&(n.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(n.video=this.videoRecorder.getBlob()),this.gifRecorder&&(n.gif=this.gifRecorder.getBlob()),e&&e(n),n},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function n(s,o){if("undefined"!=typeof Worker){var d=function i(s){var a,o=D.createObjectURL(new Blob([s.toString(),"this.onmessage =  function (eee) {"+s.name+"(eee.data);}"],{type:"application/javascript"})),d=new Worker(o);if(void 0!==D)a=D;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";a=webkitURL}return a.revokeObjectURL(o),d}(function(T){postMessage((new FileReaderSync).readAsDataURL(T))});d.onmessage=function(m){o(m.data)},d.postMessage(s)}else{var a=new FileReader;a.readAsDataURL(s),a.onload=function(m){o(m.target.result)}}}this.getBlob(function(s){s.audio&&s.video?n(s.audio,function(o){n(s.video,function(d){e({audio:o,video:d})})}):s.audio?n(s.audio,function(o){e({audio:o})}):s.video&&n(s.video,function(o){e({video:o})})})},this.writeToDisk=function(){C.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){!!(e=e||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),!!e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}C.version="5.6.2",me.exports=C,void 0!==(L=function(){return C}.apply(se,[]))&&(me.exports=L),C.getFromDisk=function(r,e){if(!e)throw"callback is mandatory.";console.log("Getting recorded "+("all"===r?"blobs":r+" blob ")+" from disk!"),V.Fetch(function(n,i){"all"!==r&&i===r+"Blob"&&e&&e(n),"all"===r&&e&&e(n,i.replace("Blob",""))})},C.writeToDisk=function(r){console.log("Writing recorded blob(s) to disk!"),(r=r||{}).audio&&r.video&&r.gif?r.audio.getDataURL(function(e){r.video.getDataURL(function(n){r.gif.getDataURL(function(i){V.Store({audioBlob:e,videoBlob:n,gifBlob:i})})})}):r.audio&&r.video?r.audio.getDataURL(function(e){r.video.getDataURL(function(n){V.Store({audioBlob:e,videoBlob:n})})}):r.audio&&r.gif?r.audio.getDataURL(function(e){r.gif.getDataURL(function(n){V.Store({audioBlob:e,gifBlob:n})})}):r.video&&r.gif?r.video.getDataURL(function(e){r.gif.getDataURL(function(n){V.Store({videoBlob:e,gifBlob:n})})}):r.audio?r.audio.getDataURL(function(e){V.Store({audioBlob:e})}):r.video?r.video.getDataURL(function(e){V.Store({videoBlob:e})}):r.gif&&r.gif.getDataURL(function(e){V.Store({gifBlob:e})})},le.getFromDisk=C.getFromDisk,le.writeToDisk=C.writeToDisk,void 0!==C&&(C.MRecordRTC=le),!(r="undefined"!=typeof global?global:null)||"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),(void 0===global.console.log||void 0===global.console.error)&&(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(r.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},r.HTMLVideoElement=function(){}),"undefined"==typeof location&&(r.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(r.screen={width:0,height:0}),void 0===D&&(r.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),r.window=global);var t=window.requestAnimationFrame;if(void 0===t)if("undefined"!=typeof webkitRequestAnimationFrame)t=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)t=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)t=msRequestAnimationFrame;else if(void 0===t){var I=0;t=function(r,e){var n=(new Date).getTime(),i=Math.max(0,16-(n-I)),s=setTimeout(function(){r(n+i)},i);return I=n+i,s}}var E=window.cancelAnimationFrame;void 0===E&&("undefined"!=typeof webkitCancelAnimationFrame?E=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?E=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?E=msCancelAnimationFrame:void 0===E&&(E=function(r){clearTimeout(r)}));var G=window.AudioContext;void 0===G&&("undefined"!=typeof webkitAudioContext&&(G=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(G=mozAudioContext));var D=window.URL;void 0===D&&"undefined"!=typeof webkitURL&&(D=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var ve=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),K=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),Ce=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),Q=!K&&!ve&&!!navigator.webkitGetUserMedia||xe()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),ge=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);ge&&!Q&&-1!==navigator.userAgent.indexOf("CriOS")&&(ge=!1,Q=!0);var q=window.MediaStream;function be(r){if(0===r)return"0 Bytes";var i=parseInt(Math.floor(Math.log(r)/Math.log(1e3)),10);return(r/Math.pow(1e3,i)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][i]}function Se(r,e){if(!r)throw"Blob object is required.";if(!r.type)try{r.type="video/webm"}catch(d){}var n=(r.type||"video/webm").split("/")[1];if(-1!==n.indexOf(";")&&(n=n.split(";")[0]),e&&-1!==e.indexOf(".")){var i=e.split(".");e=i[0],n=i[1]}var s=(e||Math.round(9999999999*Math.random())+888888888)+"."+n;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(r,s);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(r,s);var o=document.createElement("a");o.href=D.createObjectURL(r),o.download=s,o.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(o),"function"==typeof o.click?o.click():(o.target="_blank",o.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),D.revokeObjectURL(o.href)}function xe(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&!!process.versions.electron||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}function k(r,e){return r&&r.getTracks?r.getTracks().filter(function(n){return n.kind===(e||"audio")}):[]}function Ae(r,e){"srcObject"in e?e.srcObject=r:"mozSrcObject"in e?e.mozSrcObject=r:e.srcObject=r}void 0===q&&"undefined"!=typeof webkitMediaStream&&(q=webkitMediaStream),void 0!==q&&void 0===q.prototype.stop&&(q.prototype.stop=function(){this.getTracks().forEach(function(r){r.stop()})}),void 0!==C&&(C.invokeSaveAsDialog=Se,C.getTracks=k,C.getSeekableBlob=function Ie(r,e){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var n=new EBML.Reader,i=new EBML.Decoder,s=EBML.tools,o=new FileReader;o.onload=function(d){i.decode(this.result).forEach(function(y){n.read(y)}),n.stop();var m=s.makeMetadataSeekable(n.metadatas,n.duration,n.cues),T=this.result.slice(n.metadataSize),p=new Blob([m,T],{type:"video/webm"});e(p)},o.readAsArrayBuffer(r)},C.bytesToSize=be,C.isElectron=xe);var ne={};function ee(){if(Ce||ge||ve)return!0;navigator;var o,d,e=navigator.userAgent,n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10);return(Q||K)&&(o=e.indexOf("Chrome"),n=e.substring(o+7)),-1!==(d=n.indexOf(";"))&&(n=n.substring(0,d)),-1!==(d=n.indexOf(" "))&&(n=n.substring(0,d)),i=parseInt(""+n,10),isNaN(i)&&(n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),i>=49}function j(r,e){var n,p=this;if(void 0===r)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";"audio"===(e=e||{mimeType:"video/webm"}).type&&(k(r,"video").length&&k(r,"audio").length&&(navigator.mozGetUserMedia?(n=new q).addTrack(k(r,"audio")[0]):n=new q(k(r,"audio")),r=n),(!e.mimeType||-1===e.mimeType.toString().toLowerCase().indexOf("audio"))&&(e.mimeType=Q?"audio/webm":"audio/ogg"),e.mimeType&&"audio/ogg"!==e.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(e.mimeType="audio/ogg"));var a,i=[];function s(){p.timestamps.push((new Date).getTime()),"function"==typeof e.onTimeStamp&&e.onTimeStamp(p.timestamps[p.timestamps.length-1],p.timestamps)}function o(y){return a&&a.mimeType?a.mimeType:y.mimeType||"video/webm"}function d(){i=[],a=null,p.timestamps=[]}this.getArrayOfBlobs=function(){return i},this.record=function(){p.blob=null,p.clearRecordedData(),p.timestamps=[],T=[],i=[];var y=e;e.disableLogs||console.log("Passing following config over MediaRecorder API.",y),a&&(a=null),Q&&!ee()&&(y="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&y.mimeType&&(MediaRecorder.isTypeSupported(y.mimeType)||(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",y.mimeType),y.mimeType="audio"===e.type?"audio/webm":"video/webm"));try{a=new MediaRecorder(r,y),e.mimeType=y.mimeType}catch(b){a=new MediaRecorder(r)}y.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in a&&!1===a.canRecordMimeType(y.mimeType)&&(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",y.mimeType)),a.ondataavailable=function(b){if(b.data&&T.push("ondataavailable: "+be(b.data.size)),"number"!=typeof e.timeSlice)!b.data||!b.data.size||b.data.size<100||p.blob?p.recordingCallback&&(p.recordingCallback(new Blob([],{type:o(y)})),p.recordingCallback=null):(p.blob=e.getNativeBlob?b.data:new Blob([b.data],{type:o(y)}),p.recordingCallback&&(p.recordingCallback(p.blob),p.recordingCallback=null));else if(b.data&&b.data.size&&(i.push(b.data),s(),"function"==typeof e.ondataavailable)){var v=e.getNativeBlob?b.data:new Blob([b.data],{type:o(y)});e.ondataavailable(v)}},a.onstart=function(){T.push("started")},a.onpause=function(){T.push("paused")},a.onresume=function(){T.push("resumed")},a.onstop=function(){T.push("stopped")},a.onerror=function(b){!b||(b.name||(b.name="UnknownError"),T.push("error: "+b),e.disableLogs||(-1!==b.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",b):-1!==b.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",y.mimeType,") is not supported.",b):-1!==b.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",b):"OutOfMemory"===b.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",b):"IllegalStreamModification"===b.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",b):"OtherRecordingError"===b.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",b):"GenericError"===b.name?console.error("The UA cannot provide the codec or recording option that has been requested.",b):console.error("MediaRecorder Error",b)),function(v){if(!p.manuallyStopped&&a&&"inactive"===a.state)return delete e.timeslice,void a.start(6e5);setTimeout(void 0,1e3)}(),"inactive"!==a.state&&"stopped"!==a.state&&a.stop())},"number"==typeof e.timeSlice?(s(),a.start(e.timeSlice)):a.start(36e5),e.initCallback&&e.initCallback()},this.timestamps=[],this.stop=function(y){y=y||function(){},p.manuallyStopped=!0,a&&(this.recordingCallback=y,"recording"===a.state&&a.stop(),"number"==typeof e.timeSlice&&setTimeout(function(){p.blob=new Blob(i,{type:o(e)}),p.recordingCallback(p.blob)},100))},this.pause=function(){!a||"recording"===a.state&&a.pause()},this.resume=function(){!a||"paused"===a.state&&a.resume()},this.clearRecordedData=function(){a&&"recording"===a.state&&p.stop(d),d()},this.getInternalRecorder=function(){return a},this.blob=null,this.getState=function(){return a&&a.state||"inactive"};var T=[];this.getAllStates=function(){return T},void 0===e.checkForInactiveTracks&&(e.checkForInactiveTracks=!1),p=this,function y(){if(a&&!1!==e.checkForInactiveTracks){if(!1===function m(){if("active"in r){if(!r.active)return!1}else if("ended"in r&&r.ended)return!1;return!0}())return e.disableLogs||console.log("MediaStream seems stopped."),void p.stop();setTimeout(y,1e3)}}(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}function ye(r,e){if(!k(r,"audio").length)throw"Your stream has no audio tracks.";var a,n=this,i=[],s=[],o=!1,d=0,m=2,T=(e=e||{}).desiredSampRate;function p(){if(!1===e.checkForInactiveTracks)return!0;if("active"in r){if(!r.active)return!1}else if("ended"in r&&r.ended)return!1;return!0}function y(x,Z){function U(B,Te){var Le,Y=B.numberOfAudioChannels,z=B.leftBuffers.slice(0),ae=B.rightBuffers.slice(0),X=B.sampleRate,te=B.internalInterleavedLength,J=B.desiredSampRate;function pe(F,$,W){var H=Math.round(F.length*($/W)),O=[],ie=Number((F.length-1)/(H-1));O[0]=F[0];for(var he=1;he<H-1;he++){var Ne=he*ie,Oe=Number(Math.floor(Ne)).toFixed(),Ge=Number(Math.ceil(Ne)).toFixed();O[he]=Be(F[Oe],F[Ge],Ne-Oe)}return O[H-1]=F[F.length-1],O}function Be(F,$,W){return F+($-F)*W}function Fe(F,$){for(var W=new Float64Array($),H=0,O=F.length,ie=0;ie<O;ie++){var he=F[ie];W.set(he,H),H+=he.length}return W}function De(F,$,W){for(var H=W.length,O=0;O<H;O++)F.setUint8($+O,W.charCodeAt(O))}2===Y&&(z=Fe(z,te),ae=Fe(ae,te),J&&(z=pe(z,J,X),ae=pe(ae,J,X))),1===Y&&(z=Fe(z,te),J&&(z=pe(z,J,X))),J&&(X=J),2===Y&&(Le=function je(F,$){for(var W=F.length+$.length,H=new Float64Array(W),O=0,ie=0;ie<W;)H[ie++]=F[O],H[ie++]=$[O],O++;return H}(z,ae)),1===Y&&(Le=z);var ke=Le.length,Ee=new ArrayBuffer(44+2*ke),P=new DataView(Ee);De(P,0,"RIFF"),P.setUint32(4,36+2*ke,!0),De(P,8,"WAVE"),De(P,12,"fmt "),P.setUint32(16,16,!0),P.setUint16(20,1,!0),P.setUint16(22,Y,!0),P.setUint32(24,X,!0),P.setUint32(28,X*Y*2,!0),P.setUint16(32,2*Y,!0),P.setUint16(34,16,!0),De(P,36,"data"),P.setUint32(40,2*ke,!0);for(var qe=ke,Pe=44,Ze=0;Ze<qe;Ze++)P.setInt16(Pe,32767*Le[Ze],!0),Pe+=2;if(Te)return Te({buffer:Ee,view:P});postMessage({buffer:Ee,view:P})}if(x.noWorker)U(x,function(B){Z(B.buffer,B.view)});else{var oe=function b(x){var Z=D.createObjectURL(new Blob([x.toString(),";this.onmessage =  function (eee) {"+x.name+"(eee.data);}"],{type:"application/javascript"})),U=new Worker(Z);return U.workerURL=Z,U}(U);oe.onmessage=function(B){Z(B.data.buffer,B.data.view),D.revokeObjectURL(oe.workerURL),oe.terminate()},oe.postMessage(x)}}!0===e.leftChannel&&(m=1),1===e.numberOfAudioChannels&&(m=1),(!m||m<1)&&(m=2),e.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+m),void 0===e.checkForInactiveTracks&&(e.checkForInactiveTracks=!0),this.record=function(){if(!1===p())throw"Please make sure MediaStream is active.";g(),l=c=!1,o=!0,void 0!==e.timeSlice&&M()},this.stop=function(x){x=x||function(){},o=!1,y({desiredSampRate:T,sampleRate:h,numberOfAudioChannels:m,internalInterleavedLength:d,leftBuffers:i,rightBuffers:1===m?[]:s,noWorker:e.noWorker},function(Z,U){n.blob=new Blob([U],{type:"audio/wav"}),n.buffer=new ArrayBuffer(U.buffer.byteLength),n.view=U,n.sampleRate=T||h,n.bufferSize=S,n.length=d,l=!1,x&&x(n.blob)})},void 0===C.Storage&&(C.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!C.Storage.AudioContextConstructor||"closed"===C.Storage.AudioContextConstructor.state)&&(C.Storage.AudioContextConstructor=new C.Storage.AudioContext);var v=C.Storage.AudioContextConstructor,f=v.createMediaStreamSource(r),_=[0,256,512,1024,2048,4096,8192,16384],S=void 0===e.bufferSize?4096:e.bufferSize;if(-1===_.indexOf(S)&&(e.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(_,null,"\t"))),v.createJavaScriptNode)a=v.createJavaScriptNode(S,m,m);else{if(!v.createScriptProcessor)throw"WebAudio API has no support on this browser.";a=v.createScriptProcessor(S,m,m)}f.connect(a),e.bufferSize||(S=a.bufferSize);var h=void 0!==e.sampleRate?e.sampleRate:v.sampleRate||44100;(h<22050||h>96e3)&&(e.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),e.disableLogs||e.desiredSampRate&&console.log("Desired sample-rate: "+e.desiredSampRate);var c=!1;function g(){s=[],d=0,l=!1,o=!1,c=!1,v=null,n.leftchannel=i=[],n.rightchannel=s,n.numberOfAudioChannels=m,n.desiredSampRate=T,n.sampleRate=h,n.recordingLength=d,R={left:[],right:[],recordingLength:0}}function u(){a&&(a.onaudioprocess=null,a.disconnect(),a=null),f&&(f.disconnect(),f=null),g()}this.pause=function(){c=!0},this.resume=function(){if(!1===p())throw"Please make sure MediaStream is active.";if(!o)return e.disableLogs||console.log("Seems recording has been restarted."),void this.record();c=!1},this.clearRecordedData=function(){e.checkForInactiveTracks=!1,o&&this.stop(u),u()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var l=!1;a.onaudioprocess=function w(x){if(!c){if(!1===p()&&(e.disableLogs||console.log("MediaStream seems stopped."),a.disconnect(),o=!1),!o)return void(f&&(f.disconnect(),f=null));l||(l=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted(),e.initCallback&&e.initCallback());var Z=x.inputBuffer.getChannelData(0),U=new Float32Array(Z);if(i.push(U),2===m){var oe=x.inputBuffer.getChannelData(1),B=new Float32Array(oe);s.push(B)}n.recordingLength=d+=S,void 0!==e.timeSlice&&(R.recordingLength+=S,R.left.push(U),2===m&&R.right.push(B))}},a.connect(v.createMediaStreamDestination?v.createMediaStreamDestination():v.destination),this.leftchannel=i,this.rightchannel=s,this.numberOfAudioChannels=m,this.desiredSampRate=T,this.sampleRate=h,n.recordingLength=d;var R={left:[],right:[],recordingLength:0};function M(){!o||"function"!=typeof e.ondataavailable||void 0===e.timeSlice||(R.left.length?(y({desiredSampRate:T,sampleRate:h,numberOfAudioChannels:m,internalInterleavedLength:R.recordingLength,leftBuffers:R.left,rightBuffers:1===m?[]:R.right},function(x,Z){var U=new Blob([Z],{type:"audio/wav"});e.ondataavailable(U),setTimeout(M,e.timeSlice)}),R={left:[],right:[],recordingLength:0}):setTimeout(M,e.timeSlice))}}function we(r,e){if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";(e=e||{}).frameInterval||(e.frameInterval=10);var n=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(_){_ in document.createElement("canvas")&&(n=!0)});var d,a,m,i=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),s=50,o=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(i&&o&&o[2]&&(s=parseInt(o[2],10)),i&&s<52&&(n=!1),e.useWhammyRecorder&&(n=!1),n)if(e.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),r instanceof HTMLCanvasElement)d=r;else{if(!(r instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";d=r.canvas}else navigator.mozGetUserMedia&&(e.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(m=!0,n&&!e.useWhammyRecorder){var _;"captureStream"in d?_=d.captureStream(25):"mozCaptureStream"in d?_=d.mozCaptureStream(25):"webkitCaptureStream"in d&&(_=d.webkitCaptureStream(25));try{var S=new q;S.addTrack(k(_,"video")[0]),_=S}catch(h){}if(!_)throw"captureStream API are NOT available.";(a=new j(_,{mimeType:e.mimeType||"video/webm"})).record()}else f.frames=[],v=(new Date).getTime(),b();e.initCallback&&e.initCallback()},this.getWebPImages=function(_){if("canvas"===r.nodeName.toLowerCase()){var S=f.frames.length;f.frames.forEach(function(h,c){var g=S-c;e.disableLogs||console.log(g+"/"+S+" frames remaining"),e.onEncodingCallback&&e.onEncodingCallback(g,S);var u=h.image.toDataURL("image/webp",1);f.frames[c].image=u}),e.disableLogs||console.log("Generating WebM"),_()}else _()},this.stop=function(_){m=!1;var S=this;n&&a?a.stop(_):this.getWebPImages(function(){f.compile(function(h){e.disableLogs||console.log("Recording finished!"),S.blob=h,S.blob.forEach&&(S.blob=new Blob([],{type:"video/webm"})),_&&_(S.blob),f.frames=[]})})};var T=!1;function p(){f.frames=[],m=!1,T=!1}function y(){var _=document.createElement("canvas"),S=_.getContext("2d");return _.width=r.width,_.height=r.height,S.drawImage(r,0,0),_}function b(){if(T)return v=(new Date).getTime(),setTimeout(b,500);if("canvas"===r.nodeName.toLowerCase()){var _=(new Date).getTime()-v;return v=(new Date).getTime(),f.frames.push({image:y(),duration:_}),void(m&&setTimeout(b,e.frameInterval))}html2canvas(r,{grabMouse:void 0===e.showMousePointer||e.showMousePointer,onrendered:function(S){var h=(new Date).getTime()-v;if(!h)return setTimeout(b,e.frameInterval);v=(new Date).getTime(),f.frames.push({image:S.toDataURL("image/webp",1),duration:h}),m&&setTimeout(b,e.frameInterval)}})}this.pause=function(){T=!0,a instanceof j&&a.pause()},this.resume=function(){T=!1,a instanceof j?a.resume():m||this.record()},this.clearRecordedData=function(){m&&this.stop(p),p()},this.name="CanvasRecorder",this.toString=function(){return this.name};var v=(new Date).getTime(),f=new _e.Video(100)}function Re(r,e){function n(v){v=void 0!==v?v:10;var f=(new Date).getTime()-y;return f?d?(y=(new Date).getTime(),setTimeout(n,100)):(y=(new Date).getTime(),p.paused&&p.play(),T.drawImage(p,0,0,m.width,m.height),b.frames.push({duration:f,image:m.toDataURL("image/webp")}),void(o||setTimeout(n,v,v))):setTimeout(n,v,v)}(e=e||{}).frameInterval||(e.frameInterval=10),e.disableLogs||console.log("Using frames-interval:",e.frameInterval),this.record=function(){e.width||(e.width=320),e.height||(e.height=240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),m.width=e.canvas.width||320,m.height=e.canvas.height||240,T=m.getContext("2d"),e.video&&e.video instanceof HTMLVideoElement?(p=e.video.cloneNode(),e.initCallback&&e.initCallback()):(p=document.createElement("video"),Ae(r,p),p.onloadedmetadata=function(){e.initCallback&&e.initCallback()},p.width=e.video.width,p.height=e.video.height),p.muted=!0,p.play(),y=(new Date).getTime(),b=new _e.Video,e.disableLogs||(console.log("canvas resolutions",m.width,"*",m.height),console.log("video width/height",p.width||m.width,"*",p.height||m.height)),n(e.frameInterval)};var o=!1;this.stop=function(v){v=v||function(){},o=!0;var f=this;setTimeout(function(){!function s(v,f,_,S,h){var c=document.createElement("canvas");c.width=m.width,c.height=m.height;var g=c.getContext("2d"),u=[],l=-1===f,w=f&&f>0&&f<=v.length?f:v.length,M=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),x=_&&_>=0&&_<=1?_:0,Z=S&&S>=0&&S<=1?S:0,U=!1;!function i(v){var f=-1,_=v.length;!function S(){++f!==_?setTimeout(function(){v.functionToLoop(S,f)},1):v.callback()}()}({length:w,functionToLoop:function(oe,B){var Te,Y,z,ae=function(){!U&&z-Te<=z*Z||(l&&(U=!0),u.push(v[B])),oe()};if(U)ae();else{var X=new Image;X.onload=function(){g.drawImage(X,0,0,m.width,m.height);var te=g.getImageData(0,0,m.width,m.height);Te=0,Y=te.data.length,z=te.data.length/4;for(var J=0;J<Y;J+=4){var pe={r:te.data[J],g:te.data[J+1],b:te.data[J+2]};Math.sqrt(Math.pow(pe.r-0,2)+Math.pow(pe.g-0,2)+Math.pow(pe.b-0,2))<=M*x&&Te++}ae()},X.src=v[B].image}},callback:function(){(u=u.concat(v.slice(w))).length<=0&&u.push(v[v.length-1]),h(u)}})}(b.frames,-1,null,null,function(_){b.frames=_,e.advertisement&&e.advertisement.length&&(b.frames=e.advertisement.concat(b.frames)),b.compile(function(S){f.blob=S,f.blob.forEach&&(f.blob=new Blob([],{type:"video/webm"})),v&&v(f.blob)})})},10)};var d=!1;function a(){b.frames=[],o=!0,d=!1}this.pause=function(){d=!0},this.resume=function(){d=!1,o&&this.record()},this.clearRecordedData=function(){o||this.stop(a),a()},this.name="WhammyRecorder",this.toString=function(){return this.name};var p,y,b,m=document.createElement("canvas"),T=m.getContext("2d")}void 0!==G?ne.AudioContext=G:"undefined"!=typeof webkitAudioContext&&(ne.AudioContext=webkitAudioContext),void 0!==C&&(C.Storage=ne),void 0!==C&&(C.MediaStreamRecorder=j),void 0!==C&&(C.StereoAudioRecorder=ye),void 0!==C&&(C.CanvasRecorder=we),void 0!==C&&(C.WhammyRecorder=Re);var _e=function(){function r(i){this.frames=[],this.duration=i||1,this.quality=.8}function n(i){function o(c,g,u){return[{data:c,id:231}].concat(u.map(function(l){var w=function b(c){var g=0;if(c.keyframe&&(g|=128),c.invisible&&(g|=8),c.lacing&&(g|=c.lacing<<1),c.discardable&&(g|=1),c.trackNum>127)throw"TrackNumber > 127 not supported";var u=[128|c.trackNum,c.timecode>>8,255&c.timecode,g].map(function(l){return String.fromCharCode(l)}).join("")+c.frame;return u}({discardable:0,frame:l.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(g)});return g+=l.duration,{data:w,id:163}}))}function a(c){for(var g=[];c>0;)g.push(255&c),c>>=8;return new Uint8Array(g.reverse())}function m(c){return new Uint8Array(c.split("").map(function(g){return g.charCodeAt(0)}))}function T(c){var g=[];c=(c.length%8?new Array(9-c.length%8).join("0"):"")+c;for(var l=0;l<c.length;l+=8)g.push(parseInt(c.substr(l,8),2));return new Uint8Array(g)}function p(c){for(var g=[],u=0;u<c.length;u++){var l=c[u].data;"object"==typeof l&&(l=p(l)),"number"==typeof l&&(l=T(l.toString(2))),"string"==typeof l&&(l=m(l));var w=l.size||l.byteLength||l.length,R=Math.ceil(Math.ceil(Math.log(w)/Math.log(2))/8),M=w.toString(2),x=new Array(7*R+7+1-M.length).join("0")+M,Z=new Array(R).join("0")+"1"+x;g.push(a(c[u].id)),g.push(T(Z)),g.push(l)}return new Blob(g,{type:"video/webm"})}function f(c,g){return parseInt(c.substr(g+4,4).split("").map(function(u){var l=u.charCodeAt(0).toString(2);return new Array(8-l.length+1).join("0")+l}).join(""),2)}function _(c){for(var g=0,u={};g<c.length;){var l=c.substr(g,4),w=f(c,g),R=c.substr(g+4+4,w);g+=8+w,u[l]=u[l]||[],u[l].push("RIFF"===l||"LIST"===l?_(R):R)}return u}function S(c){return[].slice.call(new Uint8Array(new Float64Array([c]).buffer),0).map(function(g){return String.fromCharCode(g)}).reverse().join("")}var h=new function s(c){var g=function d(c){if(c[0]){for(var g=c[0].width,u=c[0].height,l=c[0].duration,w=1;w<c.length;w++)l+=c[w].duration;return{duration:l,width:g,height:u}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(c);if(!g)return[];for(var l=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:S(g.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:g.width,id:176},{data:g.height,id:186}]}]}]}]}],w=0,R=0;w<c.length;){var M=[],x=0;do{M.push(c[w]),x+=c[w].duration,w++}while(w<c.length&&x<3e4);var U={id:524531317,data:o(R,0,M)};l[1].data.push(U),R+=x}return p(l)}(i.map(function(c){var g=function v(c){for(var g=c.RIFF[0].WEBP[0],u=g.indexOf("\x9d\x01*"),l=0,w=[];l<4;l++)w[l]=g.charCodeAt(u+3+l);return{width:16383&(w[1]<<8|w[0]),height:16383&(w[3]<<8|w[2]),data:g,riff:c}}(_(atob(c.image.slice(23))));return g.duration=c.duration,g}));postMessage(h)}return r.prototype.add=function(i,s){if("canvas"in i&&(i=i.canvas),"toDataURL"in i&&(i=i.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(i))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:i,duration:s||this.duration})},r.prototype.compile=function(i){var s=function e(i){var s=D.createObjectURL(new Blob([i.toString(),"this.onmessage =  function (eee) {"+i.name+"(eee.data);}"],{type:"application/javascript"})),o=new Worker(s);return D.revokeObjectURL(s),o}(n);s.onmessage=function(o){o.data.error?console.error(o.data.error):i(o.data)},s.postMessage(this.frames)},{Video:r}}();void 0!==C&&(C.Whammy=_e);var V={init:function(){var r=this;if("undefined"!=typeof indexedDB&&void 0!==indexedDB.open){var i,n=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),s=indexedDB.open(n,1);s.onerror=r.onError,s.onsuccess=function(){(i=s.result).onerror=r.onError,i.setVersion&&1!==i.version?i.setVersion(1).onsuccess=function(){o(i),d()}:d()},s.onupgradeneeded=function(a){o(a.target.result)}}else console.error("IndexedDB API are not available in this browser.");function o(a){a.createObjectStore(r.dataStoreName)}function d(){var a=i.transaction([r.dataStoreName],"readwrite");function m(T){a.objectStore(r.dataStoreName).get(T).onsuccess=function(p){r.callback&&r.callback(p.target.result,T)}}r.videoBlob&&a.objectStore(r.dataStoreName).put(r.videoBlob,"videoBlob"),r.gifBlob&&a.objectStore(r.dataStoreName).put(r.gifBlob,"gifBlob"),r.audioBlob&&a.objectStore(r.dataStoreName).put(r.audioBlob,"audioBlob"),m("audioBlob"),m("videoBlob"),m("gifBlob")}},Fetch:function(r){return this.callback=r,this.init(),this},Store:function(r){return this.audioBlob=r.audioBlob,this.videoBlob=r.videoBlob,this.gifBlob=r.gifBlob,this.init(),this},onError:function(r){console.error(JSON.stringify(r,null,"\t"))},dataStoreName:"recordRTC",dbName:null};function re(r,e){if("undefined"==typeof GIFEncoder){var n=document.createElement("script");n.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(n)}e=e||{};var i=r instanceof CanvasRenderingContext2D||r instanceof HTMLCanvasElement;this.record=function(){"undefined"!=typeof GIFEncoder&&m?(i||(e.width||(e.width=T.offsetWidth||320),e.height||(e.height=T.offsetHeight||240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),d.width=e.canvas.width||320,d.height=e.canvas.height||240,T.width=e.video.width||320,T.height=e.video.height||240),(f=new GIFEncoder).setRepeat(0),f.setDelay(e.frameRate||200),f.setQuality(e.quality||10),f.start(),"function"==typeof e.onGifRecordingStarted&&e.onGifRecordingStarted(),Date.now(),p=t(function S(h){if(!0!==_.clearedRecordedData){if(s)return setTimeout(function(){S(h)},100);p=t(S),void 0===typeof v&&(v=h),!(h-v<90)&&(!i&&T.paused&&T.play(),i||a.drawImage(T,0,0,d.width,d.height),e.onGifPreview&&e.onGifPreview(d.toDataURL("image/png")),f.addFrame(a),v=h)}}),e.initCallback&&e.initCallback()):setTimeout(_.record,1e3)},this.stop=function(S){S=S||function(){},p&&E(p),Date.now(),this.blob=new Blob([new Uint8Array(f.stream().bin)],{type:"image/gif"}),S(this.blob),f.stream().bin=[]};var s=!1;this.pause=function(){s=!0},this.resume=function(){s=!1},this.clearRecordedData=function(){_.clearedRecordedData=!0,function o(){f&&(f.stream().bin=[])}()},this.name="GifRecorder",this.toString=function(){return this.name};var d=document.createElement("canvas"),a=d.getContext("2d");i&&(r instanceof CanvasRenderingContext2D?d=(a=r).canvas:r instanceof HTMLCanvasElement&&(a=r.getContext("2d"),d=r));var m=!0;if(!i){var T=document.createElement("video");T.muted=!0,T.autoplay=!0,T.playsInline=!0,m=!1,T.onloadedmetadata=function(){m=!0},Ae(r,T),T.play()}var v,f,p=null,_=this}function ce(r,e){var u;u="undefined"!=typeof global?global:null,void 0===C&&(!u||"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),(void 0===global.console.log||void 0===global.console.error)&&(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(u.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var l={getContext:function(){return l},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return l},u.HTMLVideoElement=function(){}),"undefined"==typeof location&&(u.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(u.screen={width:0,height:0}),void 0===T&&(u.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),u.window=global)),e=e||"multi-streams-mixer";var i=[],s=!1,o=document.createElement("canvas"),d=o.getContext("2d");o.style.opacity=0,o.style.position="absolute",o.style.zIndex=-1,o.style.top="-1000em",o.style.left="-1000em",o.className=e,(document.body||document.documentElement).appendChild(o),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var a=this,m=window.AudioContext;void 0===m&&("undefined"!=typeof webkitAudioContext&&(m=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(m=mozAudioContext));var T=window.URL;void 0===T&&"undefined"!=typeof webkitURL&&(T=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var p=window.MediaStream;void 0===p&&"undefined"!=typeof webkitMediaStream&&(p=webkitMediaStream),void 0!==p&&void 0===p.prototype.stop&&(p.prototype.stop=function(){this.getTracks().forEach(function(u){u.stop()})});var y={};function v(){if(!s){var u=i.length,l=!1,w=[];if(i.forEach(function(M){M.stream||(M.stream={}),M.stream.fullcanvas?l=M:w.push(M)}),l)o.width=l.stream.width,o.height=l.stream.height;else if(w.length){o.width=u>1?2*w[0].width:w[0].width;var R=1;(3===u||4===u)&&(R=2),(5===u||6===u)&&(R=3),(7===u||8===u)&&(R=4),(9===u||10===u)&&(R=5),o.height=w[0].height*R}else o.width=a.width||360,o.height=a.height||240;l&&l instanceof HTMLVideoElement&&f(l),w.forEach(function(M,x){f(M,x)}),setTimeout(v,a.frameInterval)}}function f(u,l){if(!s){var w=0,R=0,M=u.width,x=u.height;1===l&&(w=u.width),2===l&&(R=u.height),3===l&&(w=u.width,R=u.height),4===l&&(R=2*u.height),5===l&&(w=u.width,R=2*u.height),6===l&&(R=3*u.height),7===l&&(w=u.width,R=3*u.height),void 0!==u.stream.left&&(w=u.stream.left),void 0!==u.stream.top&&(R=u.stream.top),void 0!==u.stream.width&&(M=u.stream.width),void 0!==u.stream.height&&(x=u.stream.height),d.drawImage(u,w,R,M,x),"function"==typeof u.stream.onRender&&u.stream.onRender(d,w,R,M,x,l)}}function c(u){var l=document.createElement("video");return function b(u,l){"srcObject"in l?l.srcObject=u:"mozSrcObject"in l?l.mozSrcObject=u:l.srcObject=u}(u,l),l.className=e,l.muted=!0,l.volume=0,l.width=u.width||a.width||360,l.height=u.height||a.height||240,l.play(),l}function g(u){i=[],(u=u||r).forEach(function(l){if(l.getTracks().filter(function(R){return"video"===R.kind}).length){var w=c(l);w.stream=l,i.push(w)}})}void 0!==m?y.AudioContext=m:"undefined"!=typeof webkitAudioContext&&(y.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){v()},this.appendStreams=function(u){if(!u)throw"First parameter is required.";u instanceof Array||(u=[u]),u.forEach(function(l){var w=new p;if(l.getTracks().filter(function(x){return"video"===x.kind}).length){var R=c(l);R.stream=l,i.push(R),w.addTrack(l.getTracks().filter(function(x){return"video"===x.kind})[0])}if(l.getTracks().filter(function(x){return"audio"===x.kind}).length){var M=a.audioContext.createMediaStreamSource(l);a.audioDestination=a.audioContext.createMediaStreamDestination(),M.connect(a.audioDestination),w.addTrack(a.audioDestination.stream.getTracks().filter(function(x){return"audio"===x.kind})[0])}r.push(w)})},this.releaseStreams=function(){i=[],s=!0,a.gainNode&&(a.gainNode.disconnect(),a.gainNode=null),a.audioSources.length&&(a.audioSources.forEach(function(u){u.disconnect()}),a.audioSources=[]),a.audioDestination&&(a.audioDestination.disconnect(),a.audioDestination=null),a.audioContext&&a.audioContext.close(),a.audioContext=null,d.clearRect(0,0,o.width,o.height),o.stream&&(o.stream.stop(),o.stream=null)},this.resetVideoStreams=function(u){u&&!(u instanceof Array)&&(u=[u]),g(u)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function _(){s=!1;var u=function S(){var u;g(),"captureStream"in o?u=o.captureStream():"mozCaptureStream"in o?u=o.mozCaptureStream():a.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var l=new p;return u.getTracks().filter(function(w){return"video"===w.kind}).forEach(function(w){l.addTrack(w)}),o.stream=l,l}(),l=function h(){y.AudioContextConstructor||(y.AudioContextConstructor=new y.AudioContext),a.audioContext=y.AudioContextConstructor,a.audioSources=[],!0===a.useGainNode&&(a.gainNode=a.audioContext.createGain(),a.gainNode.connect(a.audioContext.destination),a.gainNode.gain.value=0);var u=0;if(r.forEach(function(l){if(l.getTracks().filter(function(R){return"audio"===R.kind}).length){u++;var w=a.audioContext.createMediaStreamSource(l);!0===a.useGainNode&&w.connect(a.gainNode),a.audioSources.push(w)}}),u)return a.audioDestination=a.audioContext.createMediaStreamDestination(),a.audioSources.forEach(function(l){l.connect(a.audioDestination)}),a.audioDestination.stream}();return l&&l.getTracks().filter(function(R){return"audio"===R.kind}).forEach(function(R){u.addTrack(R)}),r.forEach(function(R){}),u}}function Me(r,e){r=r||[];var i,s,n=this;(e=e||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(e.frameInterval=10),e.video||(e.video={}),e.video.width||(e.video.width=360),e.video.height||(e.video.height=240),this.record=function(){i=new ce(r,e.elementClass||"multi-streams-mixer"),function o(){var d=[];return r.forEach(function(a){k(a,"video").forEach(function(m){d.push(m)})}),d}().length&&(i.frameInterval=e.frameInterval||10,i.width=e.video.width||360,i.height=e.video.height||240,i.startDrawingFrames()),e.previewStream&&"function"==typeof e.previewStream&&e.previewStream(i.getMixedStream()),(s=new j(i.getMixedStream(),e)).record()},this.stop=function(d){!s||s.stop(function(a){n.blob=a,d(a),n.clearRecordedData()})},this.pause=function(){s&&s.pause()},this.resume=function(){s&&s.resume()},this.clearRecordedData=function(){s&&(s.clearRecordedData(),s=null),i&&(i.releaseStreams(),i=null)},this.addStreams=function(d){if(!d)throw"First parameter is required.";d instanceof Array||(d=[d]),r.concat(d),s&&i&&(i.appendStreams(d),e.previewStream&&"function"==typeof e.previewStream&&e.previewStream(i.getMixedStream()))},this.resetVideoStreams=function(d){!i||(d&&!(d instanceof Array)&&(d=[d]),i.resetVideoStreams(d))},this.getMixer=function(){return i},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function fe(r,e){var i,o,a;function d(p,y){if(!e.workerPath&&!y)return i=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(v){v.arrayBuffer().then(function(f){d(p,f)})});if(!e.workerPath&&y instanceof ArrayBuffer){var b=new Blob([y],{type:"text/javascript"});e.workerPath=D.createObjectURL(b)}e.workerPath||console.error("workerPath parameter is missing."),(o=new Worker(e.workerPath)).postMessage(e.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),o.addEventListener("message",function(v){"READY"===v.data?(o.postMessage({width:e.width,height:e.height,bitrate:e.bitrate||1200,timebaseDen:e.frameRate||30,realtime:e.realtime}),function s(){return new ReadableStream({start:function(p){var y=document.createElement("canvas"),b=document.createElement("video"),v=!0;b.srcObject=r,b.muted=!0,b.height=e.height,b.width=e.width,b.volume=0,b.onplaying=function(){y.width=e.width,y.height=e.height;var f=y.getContext("2d"),S=setInterval(function(){if(i&&(clearInterval(S),p.close()),v&&(v=!1,e.onVideoProcessStarted&&e.onVideoProcessStarted()),f.drawImage(b,0,0),"closed"!==p._controlledReadableStream.state)try{p.enqueue(f.getImageData(0,0,e.width,e.height))}catch(c){}},1e3/e.frameRate)},b.play()}})}().pipeTo(new WritableStream({write:function(f){i?console.error("Got image, but recorder is finished!"):o.postMessage(f.data.buffer,[f.data.buffer])}}))):v.data&&(a||T.push(v.data))})}("undefined"==typeof ReadableStream||"undefined"==typeof WritableStream)&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),(e=e||{}).width=e.width||640,e.height=e.height||480,e.frameRate=e.frameRate||30,e.bitrate=e.bitrate||1200,e.realtime=e.realtime||!0,this.record=function(){T=[],a=!1,this.blob=null,d(r),"function"==typeof e.initCallback&&e.initCallback()},this.pause=function(){a=!0},this.resume=function(){a=!1};var T=[];this.stop=function(p){i=!0;var y=this;!function m(p){o?(o.addEventListener("message",function(y){null===y.data&&(o.terminate(),o=null,p&&p())}),o.postMessage(null)):p&&p()}(function(){y.blob=new Blob(T,{type:"video/webm"}),p(y.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){T=[],a=!1,this.blob=null},this.blob=null}void 0!==C&&(C.DiskStorage=V),void 0!==C&&(C.GifRecorder=re),void 0===C&&(me.exports=ce,void 0!==(L=function(){return ce}.apply(se,[]))&&(me.exports=L)),void 0!==C&&(C.MultiStreamRecorder=Me),void 0!==C&&(C.RecordRTCPromisesHandler=function Ue(r,e){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===r)throw'First argument "MediaStream" is required.';var n=this;n.recordRTC=new C(r,e),this.startRecording=function(){return new Promise(function(i,s){try{n.recordRTC.startRecording(),i()}catch(o){s(o)}})},this.stopRecording=function(){return new Promise(function(i,s){try{n.recordRTC.stopRecording(function(o){n.blob=n.recordRTC.getBlob(),n.blob&&n.blob.size?i(o):s("Empty blob.",n.blob)})}catch(o){s(o)}})},this.pauseRecording=function(){return new Promise(function(i,s){try{n.recordRTC.pauseRecording(),i()}catch(o){s(o)}})},this.resumeRecording=function(){return new Promise(function(i,s){try{n.recordRTC.resumeRecording(),i()}catch(o){s(o)}})},this.getDataURL=function(i){return new Promise(function(s,o){try{n.recordRTC.getDataURL(function(d){s(d)})}catch(d){o(d)}})},this.getBlob=function(){return new Promise(function(i,s){try{i(n.recordRTC.getBlob())}catch(o){s(o)}})},this.getInternalRecorder=function(){return new Promise(function(i,s){try{i(n.recordRTC.getInternalRecorder())}catch(o){s(o)}})},this.reset=function(){return new Promise(function(i,s){try{i(n.recordRTC.reset())}catch(o){s(o)}})},this.destroy=function(){return new Promise(function(i,s){try{i(n.recordRTC.destroy())}catch(o){s(o)}})},this.getState=function(){return new Promise(function(i,s){try{i(n.recordRTC.getState())}catch(o){s(o)}})},this.blob=null,this.version="5.6.2"}),void 0!==C&&(C.WebAssemblyRecorder=fe)},3407:(me,se,A)=>{A.d(se,{A:()=>le,g:()=>ue});var L=A(5e3),C=A(9808),de=A(3075);let ue=(()=>{class N{constructor(I,E,G,D){this.el=I,this.ngModel=E,this.control=G,this.cd=D,this.onResize=new L.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(I){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(I){this.autoResize&&this.resize(I)}onBlur(I){this.autoResize&&this.resize(I)}resize(I){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(I||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return N.\u0275fac=function(I){return new(I||N)(L.Y36(L.SBq),L.Y36(de.On,8),L.Y36(de.a5,8),L.Y36(L.sBO))},N.\u0275dir=L.lG2({type:N,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(I,E){1&I&&L.NdJ("input",function(D){return E.onInput(D)})("focus",function(D){return E.onFocus(D)})("blur",function(D){return E.onBlur(D)}),2&I&&L.ekj("p-filled",E.filled)("p-inputtextarea-resizable",E.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),N})(),le=(()=>{class N{}return N.\u0275fac=function(I){return new(I||N)},N.\u0275mod=L.oAB({type:N}),N.\u0275inj=L.cJS({imports:[C.ez]}),N})()}}]);