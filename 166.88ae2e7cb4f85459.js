"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[166],{166:(S,T,s)=>{s.r(T),s.d(T,{FacturaModule:()=>Zt});var l=s(9808),h=s(3075),v=s(845),C=s(5315),Z=s(4036),d=s(8205),g=s(7010),c=s(1424),p=s(3407),f=s(9603),m=s(8018),x=s(5787),b=s(8952),P=s(7773),A=s(4534),D=s(7040),I=s(4559),O=s(1546),_=s(9783);class F{}class q{}var M=s(3418),t=s(5e3),N=s(7747),U=s(5384),B=s(7116),J=s(1726);const E=["filter"];function R(o,a){1&o&&(t.TgZ(0,"div")(1,"h4")(2,"FONT",15),t._uU(3,"Producto agregado de forma correcta!!! "),t.qZA()()())}function H(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",16)(1,"button",17),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),r=t.MAs(7);return t.KtG(n.clear(r))}),t.qZA(),t.TgZ(2,"span",18),t._UZ(3,"i",19),t.TgZ(4,"input",20,21),t.NdJ("input",function(n){t.CHM(e);const r=t.oxw(),u=t.MAs(7);return t.KtG(r.onGlobalFilter(u,n))}),t.qZA()()()}}function Q(o,a){1&o&&(t.TgZ(0,"tr")(1,"th")(2,"div",22),t._uU(3," Codigo "),t._UZ(4,"p-columnFilter",23),t.qZA()(),t.TgZ(5,"th")(6,"div",22),t._uU(7," Nombre "),t._UZ(8,"p-columnFilter",24),t.qZA()(),t.TgZ(9,"th")(10,"div",22),t._uU(11," Precio "),t._UZ(12,"p-columnFilter",25),t.qZA()(),t.TgZ(13,"th")(14,"div",22),t._uU(15," Categoria "),t._UZ(16,"p-columnFilter",26),t.qZA()(),t.TgZ(17,"th")(18,"div",22),t._uU(19," Seleccionar Producto "),t.qZA()()())}function L(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"tr")(1,"td",27),t._uU(2),t.qZA(),t.TgZ(3,"td",27),t._uU(4),t.qZA(),t.TgZ(5,"td",28),t._uU(6),t.qZA(),t.TgZ(7,"td",29),t._uU(8),t.qZA(),t.TgZ(9,"td",29)(10,"button",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.selectProduct(r))}),t.qZA()()()}if(2&o){const e=a.$implicit;t.xp6(2),t.hij(" ",e.productName," "),t.xp6(2),t.hij(" ",e.productName," "),t.xp6(2),t.hij(" ",e.productPrice," "),t.xp6(2),t.hij(" ",e.categoryName," ")}}function k(o,a){1&o&&(t.TgZ(0,"tr")(1,"td",31),t._uU(2,"No se encontraron productos."),t.qZA()())}function G(o,a){1&o&&(t.TgZ(0,"tr")(1,"td",31),t._uU(2,"Obteniendo los productos... Espere..."),t.qZA()())}function Y(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.cancelAddQuantityDialog())}),t.qZA(),t.TgZ(1,"button",33),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmQuantity())}),t.qZA()}}const K=function(){return["productName","categoryName","productPrice","status"]},j=function(){return{width:"450px"}};let z=(()=>{class o{constructor(e,i,n){this.customerService=e,this.productService=i,this.messageService=n,this.ProductToInvoiceSelected=new t.vpe,this.showProductAdded=!1,this.defaultProductQuantity=1,this.addProductDialog=!1,this.customers1=[],this.selectedCustomers1=[],this.selectedCustomer={},this.representatives=[],this.loading=!0}ngOnChanges(e){}ngOnInit(){this.customerService.getCustomersLarge().then(e=>{this.customers1=e,this.loading=!1,console.log(this.productsToShow),this.customers1.forEach(i=>i.date=new Date(i.date))})}onSort(){this.updateRowGroupMetaData()}updateRowGroupMetaData(){this.rowGroupMetadata={}}confirmQuantity(){this.addProductDialog=!1,(0==this.currentQuantity||null==this.currentQuantity||this.currentQuantity<this.defaultProductQuantity)&&(this.currentQuantity=1),null!=this.productSelected&&this.emitProductDTO()}selectProduct(e){this.showProductAdded=!1,this.addProductDialog=!0,this.productSelected=e}formatCurrency(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}changeQuantity(e){this.currentQuantity=e}clear(e){e.clear(),this.filter.nativeElement.value=""}keyEnterPress(e){this.addProductDialog=!1,(0==this.currentQuantity||null==this.currentQuantity||this.currentQuantity<this.defaultProductQuantity)&&(this.currentQuantity=1),null!=this.productSelected&&this.emitProductDTO()}cancelAddQuantityDialog(){this.showProductAdded=!1,this.currentQuantity=void 0,this.addProductDialog=!1}emitProductDTO(){var e,i,n,r;this.showProductAdded=!0;var u=new F;u.id=null===(e=this.productSelected)||void 0===e?void 0:e.productId,u.name=null===(i=this.productSelected)||void 0===i?void 0:i.productName,u.code=null===(n=this.productSelected)||void 0===n?void 0:n.productName,u.quantity=this.currentQuantity,u.price=null===(r=this.productSelected)||void 0===r?void 0:r.productPrice,u.total=u.price*this.currentQuantity,this.productSelected=void 0,this.currentQuantity=void 0,this.ProductToInvoiceSelected.emit(u)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(J.v),t.Y36(N.M),t.Y36(_.ez))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-productos-para-factura"]],viewQuery:function(e,i){if(1&e&&t.Gf(E,5),2&e){let n;t.iGM(n=t.CRH())&&(i.filter=n.first)}},inputs:{productsToShow:"productsToShow"},outputs:{ProductToInvoiceSelected:"ProductToInvoiceSelected"},features:[t._Bn([_.ez,_.YP]),t.TTD],decls:17,vars:17,consts:[[4,"ngIf"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","id","styleClass","p-datatable-gridlines","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["header","Ingresar cantidad",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],["id","nuva","mode","decimal","placeholder","Valor por defecto es 1",3,"ngModel","showButtons","min","max","keyup.enter","ngModelChange","onInput"],["pTemplate","footer"],["COLOR","green"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2",3,"click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full",3,"input"],["filter",""],[1,"flex","justify-content-between","align-items-center"],["type","text","field","productName","display","menu","placeholder","Buscar por codigo"],["type","text","field","productName","display","menu","placeholder","Buscar por nombre"],["type","number","field","productPrice","display","menu","placeholder","Buscar por precio"],["type","text","field","categoryName","display","menu","placeholder","Buscar por categoria"],[2,"min-width","12rem"],[2,"min-width","14rem"],[2,"min-width","10rem"],["pButton","","pRipple","","icon","pi pi-plus-circle",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["colspan","7"],["pButton","","pRipple","","icon","pi pi-times","label","Cancelar",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Guardar",1,"p-button-text",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,R,4,0,"div",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),t._uU(5,"Productos"),t.qZA(),t.TgZ(6,"p-table",4,5),t.YNc(8,H,6,0,"ng-template",6),t.YNc(9,Q,20,0,"ng-template",7),t.YNc(10,L,11,4,"ng-template",8),t.YNc(11,k,3,0,"ng-template",9),t.YNc(12,G,3,0,"ng-template",10),t.qZA()()(),t.TgZ(13,"p-dialog",11),t.NdJ("visibleChange",function(r){return i.addProductDialog=r}),t.TgZ(14,"div",12)(15,"p-inputNumber",13),t.NdJ("keyup.enter",function(r){return i.keyEnterPress(r)})("ngModelChange",function(r){return i.currentQuantity=r})("onInput",function(r){return i.changeQuantity(r.value)}),t.qZA()(),t.YNc(16,Y,2,0,"ng-template",14),t.qZA()()),2&e&&(t.Q6J("ngIf",i.showProductAdded),t.xp6(6),t.Q6J("value",i.productsToShow)("rows",10)("loading",i.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",t.DdM(15,K)),t.xp6(7),t.Akn(t.DdM(16,j)),t.Q6J("visible",i.addProductDialog)("modal",!0),t.xp6(2),t.Q6J("ngModel",i.currentQuantity)("showButtons",!0)("min",0)("max",1e3))},dependencies:[h.JJ,h.On,l.O5,b.iA,_.jx,b.xl,v.Hq,c.o,x.H,C.V,g.Rn],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]}),o})();var W=s(1330);function V(o,a){1&o&&(t.TgZ(0,"div"),t._UZ(1,"app-progress-bar"),t.qZA())}function $(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",21)(1,"button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openNew())}),t.qZA()()}}function X(o,a){1&o&&(t.TgZ(0,"div",23)(1,"h5",24),t._uU(2,"Lineas de factura"),t.qZA(),t.TgZ(3,"span",25)(4,"h6"),t._uU(5,"Es Exonerado"),t.qZA()()())}function tt(o,a){1&o&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Codigo "),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Nombre "),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Cantidad"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Precio"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Total"),t.qZA(),t._UZ(11,"th"),t.qZA())}function et(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"tr",26)(1,"td",27)(2,"span",28),t._uU(3,"Codigo"),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"td",29)(6,"span",28),t._uU(7,"Nombre"),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"td",30)(10,"span",28),t._uU(11,"Cantidad"),t.qZA(),t._uU(12),t.qZA(),t.TgZ(13,"td",31)(14,"span",28),t._uU(15,"Precio"),t.qZA(),t._uU(16),t.ALo(17,"currency"),t.qZA(),t.TgZ(18,"td",31)(19,"span",28),t._uU(20,"Total"),t.qZA(),t._uU(21),t.ALo(22,"currency"),t.qZA(),t.TgZ(23,"td")(24,"div",32)(25,"button",33),t.NdJ("click",function(){const r=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.deleteProduct(r))}),t.qZA()()()()}if(2&o){const e=a.$implicit;t.xp6(4),t.hij(" ",e.code||e.id," "),t.xp6(4),t.hij(" ",e.name," "),t.xp6(4),t.hij(" ",e.quantity," "),t.xp6(4),t.hij(" ",t.xi3(17,5,e.price,"Lps ")," "),t.xp6(5),t.hij(" ",t.xi3(22,8,e.total,"Lps ")," ")}}function nt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"app-productos-para-factura",34),t.NdJ("ProductToInvoiceSelected",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.filter(n))}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("productsToShow",e.products)}}function it(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",35),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.hideDialog())}),t.qZA()}}function ot(o,a){if(1&o&&(t.TgZ(0,"h4"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.msjToShowWhenInvoiceHaveError)}}function rt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.repairFieldsWithErrorToSendInvoice())}),t.qZA()}}function at(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",38)(1,"label",43),t._uU(2,"Nombre"),t.qZA(),t.TgZ(3,"div",40)(4,"input",48),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.currentCostumerName=n)}),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("ngModel",e.currentCostumerName)}}function st(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",38)(1,"label",43),t._uU(2,"Direcci\xf3n"),t.qZA(),t.TgZ(3,"div",40)(4,"input",48),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.CostumerAddress=n)}),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(4),t.Q6J("ngModel",e.CostumerAddress)}}function ct(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",37)(1,"h5"),t._uU(2,"Detalles del Cliente"),t.qZA(),t.TgZ(3,"div",38)(4,"label",39),t._uU(5,"RTN"),t.qZA(),t.TgZ(6,"div",40)(7,"input",41),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.currentCostumerRtn=n)})("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.setcurrentCostumerRtn(n))}),t.qZA()()(),t.YNc(8,at,5,1,"div",42),t.YNc(9,st,5,1,"div",42),t.qZA(),t.TgZ(10,"div",37)(11,"h5"),t._uU(12,"Detalles del Pago"),t.qZA(),t.TgZ(13,"div",38)(14,"label",43),t._uU(15,"Efectivo"),t.qZA(),t.TgZ(16,"div",40)(17,"p-inputNumber",44),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.currentCash=n)})("onInput",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.setcurrentCash(n.value))}),t.qZA()()(),t.TgZ(18,"div",38)(19,"label",43),t._uU(20,"Credito"),t.qZA(),t.TgZ(21,"div",40)(22,"p-inputNumber",45),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.currentCredit=n)})("onInput",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.setcurrentCredit(n.value))}),t.qZA()()(),t.TgZ(23,"div",38)(24,"label",43),t._uU(25,"Otros"),t.qZA(),t.TgZ(26,"div",40)(27,"p-inputNumber",46),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.currentOthers=n)})("onInput",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.setcurrentcurrentOthers(n.value))}),t.qZA()()(),t.TgZ(28,"div",38)(29,"label",43),t._uU(30,"Observaciones"),t.qZA(),t.TgZ(31,"div",40)(32,"input",47),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.currentObservations=n)}),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(7),t.Q6J("ngModel",e.currentCostumerRtn),t.xp6(1),t.Q6J("ngIf",e.IsCostumerValid),t.xp6(1),t.Q6J("ngIf",e.IsCostumerValid),t.xp6(8),t.Q6J("ngModel",e.currentCash)("showButtons",!0)("min",0),t.xp6(5),t.Q6J("ngModel",e.currentCredit)("showButtons",!0)("min",0),t.xp6(5),t.Q6J("ngModel",e.currentOthers)("showButtons",!0)("min",0),t.xp6(5),t.Q6J("ngModel",e.currentObservations)}}function ut(o,a){if(1&o&&(t.TgZ(0,"div")(1,"h4")(2,"FONT",51),t._uU(3),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(3),t.hij("Balance ",e.balanceInvoice," ")}}function lt(o,a){if(1&o&&(t.TgZ(0,"div")(1,"h4")(2,"FONT",52),t._uU(3),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(3),t.hij("Balance ",e.balanceInvoice," ")}}function dt(o,a){if(1&o){const e=t.EpF();t.YNc(0,ut,4,1,"div",2),t.YNc(1,lt,4,1,"div",2),t.TgZ(2,"button",49),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.hideDialog())}),t.qZA(),t.TgZ(3,"button",50),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.sendInvoiceToProcess())}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("ngIf",e.isBalanceInvoicePositive),t.xp6(1),t.Q6J("ngIf",!e.isBalanceInvoicePositive)}}function pt(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1,"Are you sure you want to delete "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.product.name)}}function mt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteProductDialog=!1)}),t.qZA(),t.TgZ(1,"button",54),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDelete())}),t.qZA()}}function ht(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteProductsDialog=!1)}),t.qZA(),t.TgZ(1,"button",54),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDeleteSelected())}),t.qZA()}}function gt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",21)(1,"a",55),t._UZ(2,"button",56),t.qZA(),t.TgZ(3,"button",57),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openSaveInvoiceNew())}),t.qZA()()}}function _t(o,a){if(1&o&&(t.TgZ(0,"h5"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij("Total: ",t.xi3(2,1,e.totalInvoice,"Lps "),"")}}const w=function(){return{width:"850px"}},vt=function(){return["name","country.name","representative.name","status"]},ft=function(){return[10,20,30]},Ct=function(){return{width:"1050px"}},y=function(){return{width:"450px"}};let Tt=(()=>{class o{constructor(e,i,n){this.productService=e,this.messageService=i,this.eventService=n,this.IsCostumerValid=!1,this.IsLoading=!1,this.printInvoiceDialog=!1,this.showProgressBar=!1,this.verifySendInvoice=!1,this.isBalanceInvoicePositive=!1,this.totalInvoice=0,this.productInvoiceList=[],this.userUniqueIdentifiquerKey="NotFound",this.productDialog=!1,this.saveInvoiceDialog=!1,this.deleteProductDialog=!1,this.deleteProductsDialog=!1,this.products=[],this.product={},this.selectedProducts=[],this.submitted=!1,this.cols=[],this.statuses=[],this.rowsPerPageOptions=[5,10,20],this.InvoiceResponse=new M.G}ngOnInit(){this.GetUserUniqueIdentifiquer(),this.GetProductsByWareHouse(),this.cols=[{field:"product",header:"Product"},{field:"price",header:"Price"},{field:"category",header:"Category"},{field:"rating",header:"Reviews"},{field:"inventoryStatus",header:"Status"}],this.statuses=[{label:"INSTOCK",value:"instock"},{label:"LOWSTOCK",value:"lowstock"},{label:"OUTOFSTOCK",value:"outofstock"}]}GetProductsByWareHouse(){this.productService.getProductsByWareHouse(this.eventService.getToken()).subscribe(e=>{e.data?(this.products=[],this.products=e.data):this.messageService.add({severity:"error",summary:"Error",detail:"No tiene productos creados",life:3e3})},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3})})}GetUserUniqueIdentifiquer(){const e=this.eventService.GetUserToken();this.userUniqueIdentifiquerKey=e}openNew(){this.product={},this.submitted=!1,this.productDialog=!0,this.currentCash=0,this.currentCredit=0,this.currentOthers=0,this.currentCostumerName="",this.currentCostumerRtn="",this.currentObservations=""}openSaveInvoiceNew(){this.saveInvoiceDialog=!0,this.balanceInvoice=0,this.balanceInvoice=this.balanceInvoice-this.totalInvoice,this.isBalanceInvoicePositive=!1}deleteSelectedProducts(){this.deleteProductsDialog=!0}editProduct(e){this.product=Object.assign({},e),this.productDialog=!0}deleteProduct(e){this.deleteProductDialog=!0,this.product=Object.assign({},e)}confirmDeleteSelected(){this.deleteProductsDialog=!1,this.products=this.products.filter(e=>!this.selectedProducts.includes(e)),this.messageService.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3}),this.selectedProducts=[]}confirmDelete(){this.deleteProductDialog=!1,this.productInvoiceList=this.productInvoiceList.filter(e=>e.id!==this.product.id),this.messageService.add({severity:"success",summary:"Exito",detail:"Producto Eliminado",life:3e3}),this.product={},this.computeInvoiceTotal()}hideDialog(){this.productDialog=!1,this.submitted=!1,this.saveInvoiceDialog=!1,this.currentCostumerName=void 0,this.currentCostumerRtn=void 0,this.currentCash=0,this.currentCredit=0,this.currentOthers=0,this.currentObservations=void 0}saveProduct(){var e;this.submitted=!0,null!==(e=this.product.name)&&void 0!==e&&e.trim()&&(this.product.id?(this.product.inventoryStatus=this.product.inventoryStatus.value?this.product.inventoryStatus.value:this.product.inventoryStatus,this.products[this.findIndexById(this.product.id)]=this.product,this.messageService.add({severity:"success",summary:"Successful",detail:"Product Updated",life:3e3})):(this.product.id=this.createId(),this.product.code=this.createId(),this.product.image="product-placeholder.svg",this.product.inventoryStatus=this.product.inventoryStatus?this.product.inventoryStatus.value:"INSTOCK",this.products.push(this.product),this.messageService.add({severity:"success",summary:"Successful",detail:"Product Created",life:3e3})),this.products=[...this.products],this.productDialog=!1,this.product={})}openPrintDialog(){this.printInvoiceDialog=!0}findIndexById(e){let i=-1;for(let n=0;n<this.products.length;n++)if(this.products[n].id===e){i=n;break}return i}createId(){let e="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<5;n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}filter(e){var i;this.productInvoiceActual=e;var n=this.productInvoiceList.filter(u=>u.id==e.id);if(null==n||null==n||0==n.length)null===(i=this.productInvoiceList)||void 0===i||i.push(e);else{this.productInvoiceList=this.productInvoiceList.filter(u=>u.id!==n[0].id);var r=new F;r.name=e.name,r.id=e.id,r.code=e.code,r.price=e.price,r.quantity=e.quantity+n[0].quantity,r.total=e.total+n[0].total,this.productInvoiceList.push(r),this.messageService.add({severity:"info",summary:"Informaci\xf3n",detail:"El producto ya estaba agregado por lo tanto solo se ha actualizado",life:5e3})}this.computeInvoiceTotal()}computeInvoiceTotal(){var e,i=0;null===(e=this.productInvoiceList)||void 0===e||e.forEach(n=>{i+=n.total}),this.totalInvoice=i}sendInvoiceToProcess(){var e,n=!1;0!=this.balanceInvoice&&(n=!0,this.msjToShowWhenInvoiceHaveError="El balance debe estar en L. 0 para guardar la factura",this.verifySendInvoice=!0),0==(null===(e=this.productInvoiceList)||void 0===e?void 0:e.length)&&(n=!0,this.msjToShowWhenInvoiceHaveError="No hay productos para enviar",this.verifySendInvoice=!0),this.IsCostumerValid&&(null==this.currentCostumerName||null==this.CostumerAddress)&&(n=!0,this.msjToShowWhenInvoiceHaveError="Si especifica un RTN tambien debe especificar un nombre y direcci\xf3n para el cliente",this.verifySendInvoice=!0),0==n&&(this.productDialog=!1,this.verifySendInvoice=!1,this.saveInvoiceDialog=!1,this.showProgressBar=!0,this.PrepareInformationToInvoice())}repairFieldsWithErrorToSendInvoice(){this.verifySendInvoice=!1,this.msjToShowWhenInvoiceHaveError=""}computeBalance(){null==this.currentCash&&(this.currentCash=0),null==this.currentCredit&&(this.currentCredit=0),null==this.currentOthers&&(this.currentOthers=0),this.balanceInvoice=this.currentCash+this.currentCredit+this.currentOthers-this.totalInvoice,this.isBalanceInvoicePositive=this.balanceInvoice>=0}setcurrentCostumerName(e){this.currentCostumerName=e}setcurrentCostumerRtn(e){this.IsCostumerValid=e.length>10,this.currentCostumerRtn=e}setcurrentCash(e){this.currentCash=e,this.computeBalance()}setcurrentCredit(e){this.currentCredit=e,this.computeBalance()}setcurrentcurrentOthers(e){this.currentOthers=e,this.computeBalance()}setcurrentObservations(e){this.currentObservations=e}PrepareInformationToInvoice(){this.currentCostumerName=null==this.currentCostumerName?"0":this.currentCostumerName,this.currentCostumerRtn=null==this.currentCostumerRtn?"0":this.currentCostumerRtn,this.CostumerAddress=null==this.CostumerAddress?"":this.CostumerAddress,this.currentObservations=null==this.currentObservations?"":this.currentObservations,this.currentCash=null==this.currentCash?0:this.currentCash,this.currentCredit=null==this.currentCredit?0:this.currentCredit,this.currentOthers=null==this.currentCredit?0:this.currentOthers,this.MaterialiceInvoice()}MaterialiceInvoice(){var e=new q;e.costumerName=this.currentCostumerName,e.costumerRTN=this.currentCostumerRtn,e.costumerAddress=this.CostumerAddress,e.userId=this.userUniqueIdentifiquerKey,e.payCash=this.currentCash,e.payCredit=this.currentCredit,e.payOther=this.currentOthers,e.observations=this.currentObservations,e.productsList=this.productInvoiceList,this.AddNewInvoice(e)}AddNewInvoice(e){this.InvoiceResponse=new M.G,this.printInvoiceDialog=!0,this.IsLoading=!0,e.userId=this.eventService.getToken(),this.productService.AddNewInvoice(e).subscribe(i=>{if(i.data){const n="La factura ha sido guardado con Exito";this.productInvoiceList=[],this.totalInvoice=0,this.InvoiceResponse=i.data,this.IsLoading=!1,this.messageService.add({severity:"success",summary:"Success",detail:n,life:3e3})}else this.IsLoading=!1,this.printInvoiceDialog=!1,this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3});this.showProgressBar=!1},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.showProgressBar=!1,this.printInvoiceDialog=!1})}isLoadingInvoice(){this.IsLoading=!0}notLoadingInvoice(){this.IsLoading=!1}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(N.M),t.Y36(_.ez),t.Y36(U.P))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ng-component"]],features:[t._Bn([_.ez,_.YP])],decls:37,vars:46,consts:[["header","Agregar Detalles",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"invoiceResponseToShow","IsLoading"],[4,"ngIf"],[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","left"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Agregar Producto",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Advertencia",1,"p-fluid",3,"visible","modal","visibleChange"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],["pTemplate","right"],[1,"my-2"],["pButton","","pRipple","","label","Agregar","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[2,"max-height","2rem"],[2,"width","25%","min-width","10rem"],[1,"p-column-title"],[2,"width","30%","min-width","10rem"],[2,"width","15%","min-width","10rem"],[2,"width","15%","min-width","8rem"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],[3,"productsToShow","ProductToInvoiceSelected"],["pButton","","pRipple","","label","Cerrar","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Corregir","icon","pi pi-times",1,"p-button-text",3,"click"],[1,"card","p-fluid"],[1,"field","grid"],["htmlFor","email3",1,"col-12","mb-2","md:col-2","md:mb-0"],[1,"col-12","md:col-10"],["pInputText","","id","email3","type","text","placeholder","Dejar vacio si es consumidor final",3,"ngModel","ngModelChange"],["class","field grid",4,"ngIf"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0"],["mode","currency","currency","LPS","locale","en-US","id","nuva","placeholder","Efectivo",3,"ngModel","showButtons","min","ngModelChange","onInput"],["id","nuva2","mode","currency","currency","LPS","locale","en-US","placeholder","Credito",3,"ngModel","showButtons","min","ngModelChange","onInput"],["id","nuva3","mode","currency","currency","LPS","locale","en-US","placeholder","Otros",3,"ngModel","showButtons","min","ngModelChange","onInput"],["type","text","pInputText","","placeholder","Observaciones",3,"ngModel","ngModelChange"],["pInputText","","id","name3","type","text","placeholder","Dejar vacio si es consumidor final",3,"ngModel","ngModelChange"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Enviar","icon","pi pi-check",1,"p-button-text",3,"click"],["COLOR","green"],["COLOR","red"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"],["routerLink","/pages/lista"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-arrow-circle-left",1,"mr-2","inline-block"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-help",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"p-dialog",0),t.NdJ("visibleChange",function(r){return i.printInvoiceDialog=r}),t._UZ(1,"app-print-invoice",1),t.qZA(),t.YNc(2,V,2,0,"div",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5),t._UZ(6,"p-toast"),t.TgZ(7,"p-toolbar",6),t.YNc(8,$,2,0,"ng-template",7),t.qZA(),t.TgZ(9,"p-table",8,9),t.NdJ("selectionChange",function(r){return i.selectedProducts=r}),t.YNc(11,X,6,0,"ng-template",10),t.YNc(12,tt,12,0,"ng-template",11),t.YNc(13,et,26,11,"ng-template",12),t.qZA()(),t.TgZ(14,"p-dialog",13),t.NdJ("visibleChange",function(r){return i.productDialog=r}),t.YNc(15,nt,1,1,"ng-template",14),t.YNc(16,it,1,0,"ng-template",15),t.qZA(),t.TgZ(17,"p-dialog",16),t.NdJ("visibleChange",function(r){return i.verifySendInvoice=r}),t.YNc(18,ot,2,1,"ng-template",14),t.YNc(19,rt,1,0,"ng-template",15),t.qZA(),t.TgZ(20,"p-dialog",0),t.NdJ("visibleChange",function(r){return i.saveInvoiceDialog=r}),t.YNc(21,ct,33,13,"ng-template",14),t.YNc(22,dt,4,2,"ng-template",15),t.qZA(),t.TgZ(23,"p-dialog",17),t.NdJ("visibleChange",function(r){return i.deleteProductDialog=r}),t.TgZ(24,"div",18),t._UZ(25,"i",19),t.YNc(26,pt,5,1,"span",2),t.qZA(),t.YNc(27,mt,2,0,"ng-template",15),t.qZA(),t.TgZ(28,"p-dialog",17),t.NdJ("visibleChange",function(r){return i.deleteProductsDialog=r}),t.TgZ(29,"div",18),t._UZ(30,"i",19),t.TgZ(31,"span"),t._uU(32,"Are you sure you want to delete selected products?"),t.qZA()(),t.YNc(33,ht,2,0,"ng-template",15),t.qZA(),t.TgZ(34,"p-toolbar",6),t.YNc(35,gt,4,0,"ng-template",7),t.YNc(36,_t,3,4,"ng-template",20),t.qZA()()()),2&e&&(t.Akn(t.DdM(38,w)),t.Q6J("visible",i.printInvoiceDialog)("modal",!0),t.xp6(1),t.Q6J("invoiceResponseToShow",i.InvoiceResponse)("IsLoading",i.IsLoading),t.xp6(1),t.Q6J("ngIf",i.showProgressBar),t.xp6(7),t.Q6J("value",i.productInvoiceList)("columns",i.cols)("rows",10)("globalFilterFields",t.DdM(39,vt))("rows",10)("paginator",!1)("rowsPerPageOptions",t.DdM(40,ft))("showCurrentPageReport",!0)("selection",i.selectedProducts)("rowHover",!0),t.xp6(5),t.Akn(t.DdM(41,Ct)),t.Q6J("visible",i.productDialog)("modal",!0),t.xp6(3),t.Akn(t.DdM(42,y)),t.Q6J("visible",i.verifySendInvoice)("modal",!0),t.xp6(3),t.Akn(t.DdM(43,w)),t.Q6J("visible",i.saveInvoiceDialog)("modal",!0),t.xp6(3),t.Akn(t.DdM(44,y)),t.Q6J("visible",i.deleteProductDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",i.product),t.xp6(2),t.Akn(t.DdM(45,y)),t.Q6J("visible",i.deleteProductsDialog)("modal",!0))},dependencies:[l.O5,I.yS,b.iA,_.jx,v.Hq,h.Fj,h.JJ,h.On,x.H,P.FN,A.o,c.o,g.Rn,C.V,B.R,z,W.C,l.H9],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]}),o})(),bt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[I.Bz.forChild([{path:"",component:Tt,canActivate:[O.j]}]),I.Bz]}),o})(),Zt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.ez,bt,b.U$,d.O,h.u5,v.hJ,x.T,P.EV,A.V,m.Xt,c.j,p.A,Z.kW,f.cc,g.L$,C.S,D.E]}),o})()},3407:(S,T,s)=>{s.d(T,{A:()=>Z,g:()=>C});var l=s(5e3),h=s(9808),v=s(3075);let C=(()=>{class d{constructor(c,p,f,m){this.el=c,this.ngModel=p,this.control=f,this.cd=m,this.onResize=new l.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(c){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(c){this.autoResize&&this.resize(c)}onBlur(c){this.autoResize&&this.resize(c)}resize(c){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(c||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return d.\u0275fac=function(c){return new(c||d)(l.Y36(l.SBq),l.Y36(v.On,8),l.Y36(v.a5,8),l.Y36(l.sBO))},d.\u0275dir=l.lG2({type:d,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(c,p){1&c&&l.NdJ("input",function(m){return p.onInput(m)})("focus",function(m){return p.onFocus(m)})("blur",function(m){return p.onBlur(m)}),2&c&&l.ekj("p-filled",p.filled)("p-inputtextarea-resizable",p.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),d})(),Z=(()=>{class d{}return d.\u0275fac=function(c){return new(c||d)},d.\u0275mod=l.oAB({type:d}),d.\u0275inj=l.cJS({imports:[h.ez]}),d})()}}]);