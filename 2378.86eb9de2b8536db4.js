"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[2378],{2378:(H,m,d)=>{d.r(m),d.d(m,{AccountTransactionModule:()=>G});var l=d(9808),u=d(7449),h=d(9783);class f{constructor(s,t,e,o){this.comments=s,this.date=t,this.userId=e,this.lines=o}}class v{constructor(s,t,e,o){this.creditAccount=isNaN(s)?0:s,this.creditAmount=isNaN(t)?0:t,this.debitAccount=isNaN(e)?0:e,this.debitAmount=isNaN(o)?0:o}}var n=d(5e3),A=d(5384),x=d(7747),a=d(3075),p=d(845),T=d(7116),C=d(4534),_=d(7773);function M(i,s){1&i&&(n.TgZ(0,"div"),n._UZ(1,"app-progress-bar"),n.qZA())}function b(i,s){if(1&i){const t=n.EpF();n.TgZ(0,"div",27),n.NdJ("click",function(){const c=n.CHM(t).$implicit,r=n.oxw(2).index,g=n.oxw();return n.KtG(g.selectAccount(r,"credit",c))}),n._uU(1),n.qZA()}if(2&i){const t=s.$implicit;n.xp6(1),n.hij(" ",t.name," ")}}function Z(i,s){if(1&i&&(n.TgZ(0,"div",25),n.YNc(1,b,2,1,"div",26),n.qZA()),2&i){const t=n.oxw().index,e=n.oxw();n.xp6(1),n.Q6J("ngForOf",e.filteredCreditAccounts[t])}}function y(i,s){if(1&i){const t=n.EpF();n.TgZ(0,"div",27),n.NdJ("click",function(){const c=n.CHM(t).$implicit,r=n.oxw(2).index,g=n.oxw();return n.KtG(g.selectAccount(r,"debit",c))}),n._uU(1),n.qZA()}if(2&i){const t=s.$implicit;n.xp6(1),n.hij(" ",t.name," ")}}function P(i,s){if(1&i&&(n.TgZ(0,"div",25),n.YNc(1,y,2,1,"div",26),n.qZA()),2&i){const t=n.oxw().index,e=n.oxw();n.xp6(1),n.Q6J("ngForOf",e.filteredDebitAccounts[t])}}function O(i,s){if(1&i){const t=n.EpF();n.TgZ(0,"div",14)(1,"div",15)(2,"input",16),n.NdJ("ngModelChange",function(o){const r=n.CHM(t).$implicit;return n.KtG(r.creditAccount=o)})("input",function(){const c=n.CHM(t).index,r=n.oxw();return n.KtG(r.filterAccounts(c,"credit"))}),n.qZA(),n.YNc(3,Z,2,1,"div",17),n.qZA(),n.TgZ(4,"div",15)(5,"input",18),n.NdJ("ngModelChange",function(o){const r=n.CHM(t).$implicit;return n.KtG(r.creditDescription=o)}),n.qZA()(),n.TgZ(6,"div",15)(7,"input",19),n.NdJ("ngModelChange",function(o){const r=n.CHM(t).$implicit;return n.KtG(r.creditAmount=o)}),n.qZA()(),n._UZ(8,"div",20),n.TgZ(9,"div",15)(10,"input",21),n.NdJ("ngModelChange",function(o){const r=n.CHM(t).$implicit;return n.KtG(r.debitAccount=o)})("input",function(){const c=n.CHM(t).index,r=n.oxw();return n.KtG(r.filterAccounts(c,"debit"))}),n.qZA(),n.YNc(11,P,2,1,"div",17),n.qZA(),n.TgZ(12,"div",15)(13,"input",18),n.NdJ("ngModelChange",function(o){const r=n.CHM(t).$implicit;return n.KtG(r.debitDescription=o)}),n.qZA()(),n.TgZ(14,"div",15)(15,"input",22),n.NdJ("ngModelChange",function(o){const r=n.CHM(t).$implicit;return n.KtG(r.debitAmount=o)}),n.qZA()(),n.TgZ(16,"p-button",23),n.NdJ("click",function(){n.CHM(t);const o=n.oxw();return n.KtG(o.addLine())}),n.qZA(),n.TgZ(17,"p-button",24),n.NdJ("click",function(){const c=n.CHM(t).index,r=n.oxw();return n.KtG(r.removeLine(c))}),n.qZA()()}if(2&i){const t=s.$implicit,e=s.index,o=n.oxw();n.xp6(2),n.Q6J("ngModel",t.creditAccount),n.xp6(1),n.Q6J("ngIf",o.filteredCreditAccounts[e]&&o.filteredCreditAccounts[e].length>0),n.xp6(2),n.Q6J("title",t.creditDescription)("ngModel",t.creditDescription),n.xp6(2),n.Q6J("ngModel",t.creditAmount),n.xp6(3),n.Q6J("ngModel",t.debitAccount),n.xp6(1),n.Q6J("ngIf",o.filteredDebitAccounts[e]&&o.filteredDebitAccounts[e].length>0),n.xp6(2),n.Q6J("title",t.debitDescription)("ngModel",t.debitDescription),n.xp6(2),n.Q6J("ngModel",t.debitAmount)}}let J=(()=>{class i{constructor(t,e,o){this.messageService=t,this.eventService=e,this.productService=o,this.isLoading=!1,this.lines=[{creditAccount:"",creditAmount:0,creditDescription:"",debitAccount:"",debitAmount:0,debitDescription:""}],this.comments="",this.date="",this.allAccounts=[],this.filteredCreditAccounts=[[]],this.filteredDebitAccounts=[[]],this.getAccounts()}addLine(){this.lines.push({creditAccount:"",creditAmount:0,creditDescription:"",debitAccount:"",debitAmount:0,debitDescription:""}),this.filteredCreditAccounts.push([]),this.filteredDebitAccounts.push([])}removeLine(t){this.lines.splice(t,1),this.filteredCreditAccounts.splice(t,1),this.filteredDebitAccounts.splice(t,1)}filterAccounts(t,e){const o="credit"===e?this.lines[t].creditAccount:this.lines[t].debitAccount,c=this.allAccounts.filter(r=>r.name.toLowerCase().includes(o.toLowerCase()));"credit"===e?this.filteredCreditAccounts[t]=c:this.filteredDebitAccounts[t]=c}selectAccount(t,e,o){"credit"===e?(this.lines[t].creditAccount=o.id.toString(),this.lines[t].creditDescription=o.description,this.filteredCreditAccounts[t]=[]):(this.lines[t].debitAccount=o.id.toString(),this.lines[t].debitDescription=o.description,this.filteredDebitAccounts[t]=[])}getTotalCredits(){return this.lines.reduce((t,e)=>t+e.creditAmount,0)}getTotalDebits(){return this.lines.reduce((t,e)=>t+e.debitAmount,0)}save(){this.getTotalCredits()!=this.getTotalDebits()&&this.messageService.add({severity:"error",summary:"Error",detail:"El monto total de credito debe ser igual al monto de debito",life:3e3}),console.log(this.lines);const t=this.lines.map(c=>new v(parseInt(c.creditAccount),c.creditAmount,parseInt(c.debitAccount),c.debitAmount)),e=this.eventService.getToken();var o=new f(this.comments,this.date,e,t);this.PostAccountTransaction(o)}getAccounts(){this.isLoading=!0;const t=this.eventService.getToken();this.productService.GetAccounts(t).subscribe(e=>{console.log(e),e.data?(this.allAccounts=e.data,console.log(this.allAccounts)):this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3}),this.isLoading=!1},e=>{this.isLoading=!1,this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3})})}PostAccountTransaction(t){this.isLoading=!0,this.productService.PostAccountTransaction(t).subscribe(e=>{console.log(e),e.data?(this.lines=[],this.comments="",this.date="",this.addLine(),this.messageService.add({severity:"success",summary:"Success",detail:"Exito al guardar los datos",life:3e3})):this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3}),this.isLoading=!1},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3}),this.isLoading=!1})}}return i.\u0275fac=function(t){return new(t||i)(n.Y36(h.ez),n.Y36(A.P),n.Y36(x.M))},i.\u0275cmp=n.Xpm({type:i,selectors:[["ng-component"]],features:[n._Bn([h.ez])],decls:24,vars:14,consts:[[1,"card","px-6","py-6"],[4,"ngIf"],[1,"container"],["class","form-row",4,"ngFor","ngForOf"],[1,"totals"],[1,"additional-info"],[1,"input-group","full-width"],["placeholder","Comentarios",3,"ngModel","ngModelChange"],["type","date",3,"ngModel","ngModelChange"],["styleClass","mb-4"],[1,"my-2"],["routerLink","/"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-arrow-circle-left",1,"mr-2","inline-block"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-help",3,"click"],[1,"form-row"],[1,"input-group"],["type","text","placeholder","Cuenta Credito",3,"ngModel","ngModelChange","input"],["class","autocomplete",4,"ngIf"],["readonly","true","type","text","placeholder","Desc.",3,"title","ngModel","ngModelChange"],["type","number","placeholder","Monto Credito",3,"ngModel","ngModelChange"],[1,"separator"],["type","text","placeholder","Cuenta Debito",3,"ngModel","ngModelChange","input"],["type","number","placeholder","Monto Debito",3,"ngModel","ngModelChange"],["icon","pi pi-plus","styleClass","p-button-rounded p-button-success p-button-text",3,"click"],["icon","pi pi-trash","styleClass","p-button-rounded p-button-danger p-button-text",3,"click"],[1,"autocomplete"],["class","autocomplete-item",3,"click",4,"ngFor","ngForOf"],[1,"autocomplete-item",3,"click"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.YNc(1,M,2,0,"div",1),n._UZ(2,"p-toast"),n.TgZ(3,"div",2)(4,"h4"),n._uU(5,"Crear Partidas Contables"),n.qZA(),n.YNc(6,O,18,10,"div",3),n.TgZ(7,"div",4)(8,"div"),n._uU(9),n.ALo(10,"currency"),n.qZA(),n.TgZ(11,"div"),n._uU(12),n.ALo(13,"currency"),n.qZA()(),n.TgZ(14,"div",5)(15,"div",6)(16,"textarea",7),n.NdJ("ngModelChange",function(c){return e.comments=c}),n.qZA()(),n.TgZ(17,"div",6)(18,"input",8),n.NdJ("ngModelChange",function(c){return e.date=c}),n.qZA()()()()(),n.TgZ(19,"p-toolbar",9)(20,"div",10)(21,"a",11),n._UZ(22,"button",12),n.qZA(),n.TgZ(23,"button",13),n.NdJ("click",function(){return e.save()}),n.qZA()()()),2&t&&(n.xp6(1),n.Q6J("ngIf",e.isLoading),n.xp6(5),n.Q6J("ngForOf",e.lines),n.xp6(3),n.hij("Total Cr\xe9ditos: ",n.Dn7(10,6,e.getTotalCredits(),"L. ","symbol"),""),n.xp6(3),n.hij("Total D\xe9bitos: ",n.Dn7(13,10,e.getTotalDebits(),"L. ","symbol"),""),n.xp6(4),n.Q6J("ngModel",e.comments),n.xp6(2),n.Q6J("ngModel",e.date))},dependencies:[l.sg,l.O5,u.yS,a.Fj,a.wV,a.JJ,a.On,p.Hq,p.zx,T.R,C.o,_.FN,l.H9],styles:[".container[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n}\n\nh1[_ngcontent-%COMP%] {\n  margin-bottom: 20px;\n}\n\n.form-row[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  width: 100%;\n  max-width: 1000px;\n  margin-bottom: 10px; \n}\n\n.input-group[_ngcontent-%COMP%] {\n  margin-right: 20px;\n  flex: 1;\n  position: relative; \n}\n\n.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  font-size: 14px;\n}\n\n.input-group[_ngcontent-%COMP%]:last-of-type {\n  margin-right: 0;\n}\n\n.separator[_ngcontent-%COMP%] {\n  width: 1px;\n  height: 40px;\n  background-color: black;\n  margin: 0 20px;\n}\n\n.add-line[_ngcontent-%COMP%] {\n  padding: 10px 20px;\n  background-color: #007bff;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.add-line[_ngcontent-%COMP%]:hover {\n  background-color: #0056b3;\n}\n\n.remove-line[_ngcontent-%COMP%] {\n  padding: 10px;\n  background-color: #dc3545;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.remove-line[_ngcontent-%COMP%]:hover {\n  background-color: #c82333;\n}\n\n.save[_ngcontent-%COMP%] {\n  margin-top: 20px;\n  padding: 10px 20px;\n  background-color: #28a745;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.save[_ngcontent-%COMP%]:hover {\n  background-color: #218838;\n}\n\n.totals[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  max-width: 1000px;\n  margin-top: 20px;\n}\n\n.additional-info[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%] {\n  width: 100%;\n  margin-bottom: 10px;\n}\n\n.autocomplete[_ngcontent-%COMP%] {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  background-color: white;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  max-height: 150px;\n  overflow-y: auto;\n  z-index: 1000;\n}\n\n.autocomplete-item[_ngcontent-%COMP%] {\n  padding: 10px;\n  cursor: pointer;\n}\n\n.autocomplete-item[_ngcontent-%COMP%]:hover {\n  background-color: #f1f1f1;\n}\n\n@media (max-width: 768px) {\n  .form-row[_ngcontent-%COMP%] {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .separator[_ngcontent-%COMP%] {\n    display: none;\n  }\n\n  .input-group[_ngcontent-%COMP%] {\n    margin-right: 0;\n    margin-bottom: 10px;\n  }\n\n  .additional-info[_ngcontent-%COMP%] {\n    flex-direction: column;\n    width: 100%;\n  }\n\n  .totals[_ngcontent-%COMP%] {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .save[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n}"]}),i})(),D=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[u.Bz.forChild([{path:"",component:J}]),u.Bz]}),i})();var N=d(7531),w=d(9815),L=d(2978),k=d(5245),S=d(508),F=d(5652),E=d(4891);let G=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[l.ez,D,a.u5,p.hJ,a.u5,E.E,a.UX,N.c,w.Bb,L.lN,k.Ps,S.XK,C.V,F._8,_.EV]}),i})()}}]);