"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[8252],{8252:(y,h,n)=>{n.r(h),n.d(h,{ActivityModule:()=>x});var a=n(6895),g=n(9197),_=n(3003),u=n(574),f=n(805),e=n(4650),v=n(7747),A=n(5384),d=n(4006),c=n(5593),p=n(585),m=n(5552),D=n(2453),S=n(6768);function w(o,C){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"label",6),e._uU(2,"Usuarios"),e.qZA(),e.TgZ(3,"app-drop-down",16),e.NdJ("ValueSelectedChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.filterUser(i))}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("IsCreating",!1)("showFilter",!0)("DropDownDataSource",t.usersDropDown)}}function Z(o,C){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"date"),e.ALo(3,"date"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.AsE(" Reporte del ",e.lcZ(2,2,t.StartDate)," al ",e.lcZ(3,4,t.FinalDate)," ")}}function T(o,C){if(1&o&&(e.TgZ(0,"tr",17)(1,"th",18),e._uU(2),e.qZA(),e.TgZ(3,"th",18),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"th",18),e._uU(7),e.qZA(),e.TgZ(8,"th",18),e._uU(9),e.qZA()()),2&o){const t=C.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(5,4,t.date,"yyyy-MM-dd HH:mm:ss")),e.xp6(3),e.Oqu(t.module),e.xp6(2),e.Oqu(t.message)}}let M=(()=>{class o{constructor(t,s,i,l){this.router=t,this.productService=s,this.messageService=i,this.eventService=l,this.loading=!1,this.InvoiceList=[],this.payReport=[],this.activityReport=[],this.redirect=!1,this.AccessName="/pages/activity"}ngOnInit(){const s=this.eventService.getPermisionsException().split(",").map(i=>i.trim());this.redirect=s.includes(this.AccessName),this.redirect&&this.router.navigateByUrl("/pages/unautorized"),this.userSelected="",this.wareHouseSelectd="",this.GetUsersByRole()}load(){this.loading=!0;var t=new _.c;t.initialDate=this.StartDate,t.finalDate=this.FinalDate,this.getActivityReport(t)}getActivityReport(t){const s=this.eventService.getToken();t.userFilter=null==this.userSelected||"0"==this.userSelected?"ALL":this.userSelected,t.warehouseFilter=null==this.wareHouseSelectd||"0"==this.wareHouseSelectd?"ALL":this.wareHouseSelectd,this.productService.GetActivityReport(t,s).subscribe(i=>{console.log(i),i.data?this.activityReport=i.data:this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.loading=!1},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.loading=!1})}exportToExcel(){const s=[["Usuario","Fecha","Modulo","Mensaje"]];this.activityReport.forEach(r=>{s.push([r.name,r.date,r.module,r.message])});const i=u.P6.aoa_to_sheet(s),l=u.P6.book_new();u.P6.book_append_sheet(l,i,"Detalle de Actividad"),u.NC(l,"Actividad.xlsx")}filterUser(t){""==t||null==t?this.userSelected="-1":(console.log(t),this.userSelected=t)}GetUsersByRole(){this.isLoading=!0,this.loading=!0,this.productService.GetUsersByRoleValues(this.eventService.getToken()).subscribe(t=>{t.data&&(this.usersDropDown=t.data),this.isLoading=!1,this.loading=!1})}filterWareHouse(t){this.wareHouseSelectd=t,console.log(this.wareHouseSelectd)}GetWareHouseByRole(){this.productService.GetWareHouseByRoleValues(this.eventService.getToken()).subscribe(t=>{t.data&&(this.wareHouseDropDown=t.data),this.isLoading=!1})}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(g.F0),e.Y36(v.M),e.Y36(f.ez),e.Y36(A.P))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],features:[e._Bn([f.ez])],decls:36,vars:9,consts:[["id","print-section"],[1,"grid"],[1,"col-12"],[1,"card"],[2,"display","flex","flex-wrap","wrap","justify-content","space-between"],[2,"flex","1","margin","5px"],["htmlFor","age1"],["inputId","icon",3,"ngModel","showIcon","ngModelChange"],["style","width: 100%;","style","flex: 1; margin: 5px;",4,"ngIf"],["label","Search","icon","pi pi-search","iconPos","right",1,"space",2,"width","100%",3,"loading","onClick"],["id","PrintFull"],[4,"ngIf"],[2,"background-color","#7288a2","color","white"],["style","font-size: small;",4,"ngFor","ngForOf"],["printSectionId","PrintFull","ngxPrint","","pButton","","pRipple","","label","imprimir","icon","pi pi-print",1,"p-button-help"],["pButton","","pRipple","","label","Exportar a Excel","icon","pi pi-cloud-download",1,"p-button-success","mr-2",2,"margin-left","10px",3,"disabled","click"],[3,"IsCreating","showFilter","DropDownDataSource","ValueSelectedChange"],[2,"font-size","small"],["align","left"]],template:function(s,i){if(1&s&&(e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h4"),e._uU(6,"Reporte de Actividad"),e.qZA(),e.TgZ(7,"div",4)(8,"div",5)(9,"label",6),e._uU(10,"Inicial"),e.qZA(),e.TgZ(11,"p-calendar",7),e.NdJ("ngModelChange",function(r){return i.StartDate=r}),e.qZA()(),e.TgZ(12,"div",5)(13,"label",6),e._uU(14,"Final"),e.qZA(),e.TgZ(15,"p-calendar",7),e.NdJ("ngModelChange",function(r){return i.FinalDate=r}),e.qZA()(),e.YNc(16,w,4,3,"div",8),e.TgZ(17,"div",5)(18,"p-button",9),e.NdJ("onClick",function(){return i.load()}),e.qZA()()(),e._UZ(19,"p")(20,"p"),e.TgZ(21,"div",10),e.YNc(22,Z,4,6,"div",11),e.TgZ(23,"table")(24,"tr",12)(25,"th"),e._uU(26,"Usuario"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Fecha"),e.qZA(),e.TgZ(29,"th"),e._uU(30,"Modulo"),e.qZA(),e.TgZ(31,"th"),e._uU(32,"Mensaje"),e.qZA()(),e.YNc(33,T,10,7,"tr",13),e.qZA()()()()()(),e._UZ(34,"button",14),e.TgZ(35,"button",15),e.NdJ("click",function(){return i.exportToExcel()}),e.qZA()),2&s){let l,r;e.xp6(11),e.Q6J("ngModel",i.StartDate)("showIcon",!0),e.xp6(4),e.Q6J("ngModel",i.FinalDate)("showIcon",!0),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&(null!==(l=null==i.usersDropDown?null:i.usersDropDown.length)&&void 0!==l?l:0)>0),e.xp6(2),e.Q6J("loading",i.loading),e.xp6(4),e.Q6J("ngIf",(null!==(r=null==i.activityReport?null:i.activityReport.length)&&void 0!==r?r:0)>0),e.xp6(11),e.Q6J("ngForOf",i.activityReport),e.xp6(2),e.Q6J("disabled",!i.activityReport||0===i.activityReport.length)}},dependencies:[a.sg,a.O5,d.JJ,d.On,c.Hq,c.zx,p.f,m.IH,D.FN,S.t,a.uU],styles:["table[_ngcontent-%COMP%] {\n    border-collapse: collapse;\n    width: 100%;\n  }\n  \n  tr[_ngcontent-%COMP%] {\n    border-bottom: 1px solid #ddd;\n  }\n  .space[_ngcontent-%COMP%] {\nwidth: 4px;\nheight: auto;\nmargin-left: 20px;\n}"]})}return o})(),U=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[g.Bz.forChild([{path:"",component:M}]),g.Bz]})}return o})();var R=n(2210),F=n(4891);let x=(()=>{class o{static#e=this.\u0275fac=function(s){return new(s||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[a.ez,U,d.u5,c.hJ,p._8,c.hJ,d.u5,d.UX,m.K8,D.EV,R.kW,F.E]})}return o})()},6768:(y,h,n)=>{n.d(h,{t:()=>e});var a=n(4650),g=n(7747),_=n(5384),u=n(4006),f=n(2210);let e=(()=>{class v{constructor(d,c){this.commonService=d,this.eventService=c,this.ValueSelectedChange=new a.vpe,this.categorys=[],this.Filter=!1}ngOnInit(){this.data=this.DropDownDataSource,this.Filter=this.showFilter}changeValue(){this.ValueSelected=this.selectedData?.value,this.ValueSelectedChange.emit(this.ValueSelected)}selectedValue(){this.ValueSelected=this.selectedData?.value,this.ValueSelectedChange.emit(this.ValueSelected)}static#e=this.\u0275fac=function(c){return new(c||v)(a.Y36(g.M),a.Y36(_.P))};static#t=this.\u0275cmp=a.Xpm({type:v,selectors:[["app-drop-down"]],inputs:{ValueSelected:"ValueSelected",IsCreating:"IsCreating",showFilter:"showFilter",DropDownDataSource:"DropDownDataSource"},outputs:{ValueSelectedChange:"ValueSelectedChange"},decls:1,vars:3,consts:[["optionLabel","viewValue",3,"filter","options","ngModel","onClick","onChange","ngModelChange"]],template:function(c,p){1&c&&(a.TgZ(0,"p-dropdown",0),a.NdJ("onClick",function(){return p.selectedValue()})("onChange",function(){return p.changeValue()})("ngModelChange",function(D){return p.selectedData=D}),a.qZA()),2&c&&a.Q6J("filter",p.Filter)("options",p.data)("ngModel",p.selectedData)},dependencies:[u.JJ,u.On,f.Lt],encapsulation:2})}return v})()},3003:(y,h,n)=>{n.d(h,{c:()=>a});class a{}}}]);