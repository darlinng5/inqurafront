"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[7309],{7309:(oe,h,s)=>{s.r(h),s.d(h,{FacturaListaModule:()=>ne});var c=s(9808),p=s(3075),v=s(845),_=s(5315),w=s(4036),f=s(7010),Z=s(1424),A=s(6526),C=s(8185),M=s(8018),b=s(5787),T=s(4776),m=s(8952),F=s(7773),I=s(2841),L=s(7040),y=s(4559),S=s(1546),u=s(9783),N=s(3418),e=s(5e3),U=s(1726),R=s(7747),E=s(5384),J=s(7116),q=s(1330);const D=["filter"];function B(i,r){1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-progress-bar"),e.qZA())}function P(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",19)(1,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),a=e.MAs(9);return e.KtG(o.clear(a))}),e.qZA(),e.TgZ(2,"span",21),e._UZ(3,"i",22),e.TgZ(4,"input",23,24),e.NdJ("input",function(o){e.CHM(t);const a=e.oxw(),l=e.MAs(9);return e.KtG(a.onGlobalFilter(l,o))}),e.qZA()()()}}const G=function(){return{"min-width":"12rem"}};function j(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"p-slider",35),e.NdJ("onSlideEnd",function(o){const l=e.CHM(t).filterCallback;return e.KtG(l(o.values))}),e.qZA(),e.TgZ(1,"div",36)(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()}if(2&i){const t=e.oxw(2);e.Akn(e.DdM(6,G)),e.Q6J("ngModel",t.activityValues)("range",!0),e.xp6(3),e.Oqu(t.activityValues[0]),e.xp6(2),e.Oqu(t.activityValues[1])}}function k(i,r){1&i&&(e.TgZ(0,"tr")(1,"th")(2,"div",25),e._uU(3," Numero "),e._UZ(4,"p-columnFilter",26),e.qZA()(),e.TgZ(5,"th")(6,"div",25),e._uU(7," Cliente "),e._UZ(8,"p-columnFilter",27),e.qZA()(),e.TgZ(9,"th")(10,"div",25),e._uU(11," Fecha "),e._UZ(12,"p-columnFilter",28),e.qZA()(),e.TgZ(13,"th")(14,"div",25),e._uU(15," Impuestos "),e._UZ(16,"p-columnFilter",29),e.qZA()(),e.TgZ(17,"th")(18,"div",25),e._uU(19," Total "),e._UZ(20,"p-columnFilter",30),e.qZA()(),e.TgZ(21,"th")(22,"div",25),e._uU(23," % de Pago "),e.TgZ(24,"p-columnFilter",31),e.YNc(25,j,6,7,"ng-template",32),e.qZA()()(),e.TgZ(26,"th",33)(27,"div",25),e._uU(28," Estado "),e._UZ(29,"p-columnFilter",34),e.qZA()(),e.TgZ(30,"th")(31,"div",25),e._uU(32," Imprimir/Ver Pago /Anular "),e.qZA()()()),2&i&&(e.xp6(24),e.Q6J("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}const O=function(i,r){return{"true-icon pi-check-circle text-green-500":i,"false-icon pi-times-circle text-pink-500 ":r}};function H(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",37),e._uU(2),e.qZA(),e.TgZ(3,"td",37),e._uU(4),e.qZA(),e.TgZ(5,"td",38),e._uU(6),e.qZA(),e.TgZ(7,"td",38),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"td",38),e._uU(11),e.ALo(12,"currency"),e.qZA(),e.TgZ(13,"td",37),e._UZ(14,"p-progressBar",39),e.qZA(),e.TgZ(15,"td",40),e._UZ(16,"i",41),e.qZA(),e.TgZ(17,"td",37)(18,"button",42),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.GetInvoicesById(a))}),e.qZA(),e.TgZ(19,"button",43),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.openInvoicePayDetailDialog(a))}),e.qZA(),e.TgZ(20,"button",44),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.openCancelInvoice(a))}),e.qZA()()()}if(2&i){const t=r.$implicit;e.xp6(2),e.hij(" ",t.sarNumber," "),e.xp6(2),e.hij(" ",t.costumerName," "),e.xp6(2),e.hij(" ",t.date," "),e.xp6(2),e.hij(" ",e.Dn7(9,8,t.totalTax,"LPS.","symbol")," "),e.xp6(3),e.hij(" ",e.Dn7(12,12,t.total,"LPS.","symbol")," "),e.xp6(3),e.Q6J("value",t.payPercentaje)("showValue",!1),e.xp6(2),e.Q6J("ngClass",e.WLB(16,O,t.isActive,!t.isActive))}}function K(i,r){1&i&&(e.TgZ(0,"tr")(1,"td",45),e._uU(2,"No se encuentran facturas."),e.qZA()())}function Q(i,r){1&i&&(e.TgZ(0,"tr")(1,"td",45),e._uU(2,"Loading data. Please wait."),e.qZA()())}function Y(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",46)(1,"h5"),e._uU(2,"Detalles del Pago"),e.qZA(),e.TgZ(3,"div",47)(4,"label",48),e._uU(5,"Efectivo"),e.qZA(),e.TgZ(6,"div",49)(7,"p-inputNumber",50),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.InvoiceSelet.payCash=o)}),e.qZA()()(),e.TgZ(8,"div",47)(9,"label",48),e._uU(10,"Credito"),e.qZA(),e.TgZ(11,"div",49)(12,"p-inputNumber",50),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.InvoiceSelet.payCredit=o)}),e.qZA()()(),e.TgZ(13,"div",47)(14,"label",48),e._uU(15,"Otros"),e.qZA(),e.TgZ(16,"div",49)(17,"p-inputNumber",50),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.InvoiceSelet.payOthers=o)}),e.qZA()()(),e.TgZ(18,"div",47)(19,"label",48),e._uU(20,"Obs."),e.qZA(),e.TgZ(21,"div",49)(22,"input",51),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.InvoiceSelet.payObservations=o)}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngModel",t.InvoiceSelet.payCash)("showButtons",!0)("min",0),e.xp6(5),e.Q6J("ngModel",t.InvoiceSelet.payCredit)("showButtons",!0)("min",0),e.xp6(5),e.Q6J("ngModel",t.InvoiceSelet.payOthers)("showButtons",!0)("min",0),e.xp6(5),e.Q6J("ngModel",t.InvoiceSelet.payObservations)}}function z(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.hideDialog())}),e.qZA(),e.TgZ(1,"button",53),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updatePayInvoice())}),e.qZA()}}function V(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cancelInvoice=!1)}),e.qZA(),e.TgZ(1,"button",55),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.confirmCancelInvoice())}),e.qZA()}}function W(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",56),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.closeResponseMessage())}),e.qZA()}}function $(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",56),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.closeResponseMessage())}),e.qZA()}}const x=function(){return{width:"850px"}},X=function(){return["sarNumber","date","costumerName","payPercentaje"]},d=function(){return{width:"450px"}};let ee=(()=>{class i{constructor(t,n,o,a){this.customerService=t,this.productService=n,this.messageService=o,this.eventService=a,this.showSuccessResponse=!1,this.showErrorResponse=!1,this.cancelInvoice=!1,this.userUniqueIdentifiquerKey="NotFound",this.InvoiceList=[],this.openPayDetailDialog=!1,this.IsLoading=!0,this.printInvoiceDialog=!1,this.customers1=[],this.customers2=[],this.customers3=[],this.selectedCustomers1=[],this.selectedCustomer={},this.representatives=[],this.statuses=[],this.products=[],this.expandedRows={},this.activityValues=[0,100],this.isExpanded=!1,this.idFrozen=!1,this.loading=!0}ngOnInit(){this.GetInvoicesByWareHouse(),this.customerService.getCustomersLarge().then(t=>{this.customers1=t,this.loading=!1,this.customers1.forEach(n=>n.date=new Date(n.date))}),this.customerService.getCustomersMedium().then(t=>this.customers2=t),this.customerService.getCustomersLarge().then(t=>this.customers3=t),this.productService.getProductsWithOrdersSmall().then(t=>this.products=t),this.representatives=[{name:"Amy Elsner",image:"amyelsner.png"},{name:"Anna Fali",image:"annafali.png"},{name:"Asiya Javayant",image:"asiyajavayant.png"},{name:"Bernardo Dominic",image:"bernardodominic.png"},{name:"Elwin Sharvill",image:"elwinsharvill.png"},{name:"Ioni Bowcher",image:"ionibowcher.png"},{name:"Ivan Magalhaes",image:"ivanmagalhaes.png"},{name:"Onyama Limba",image:"onyamalimba.png"},{name:"Stephen Shaw",image:"stephenshaw.png"},{name:"XuXue Feng",image:"xuxuefeng.png"}],this.statuses=[{label:"Unqualified",value:"unqualified"},{label:"Qualified",value:"qualified"},{label:"New",value:"new"},{label:"Negotiation",value:"negotiation"},{label:"Renewal",value:"renewal"},{label:"Proposal",value:"proposal"}]}GetInvoicesByWareHouse(){this.showProgressBar=!0,this.productService.getInvoicesByWareHouse(this.eventService.getToken()).subscribe(t=>{t.data?(this.InvoiceList=[],this.InvoiceList=t.data,console.log(this.InvoiceList)):this.messageService.add({severity:"error",summary:"Error",detail:"No tiene productos creados",life:3e3}),this.showProgressBar=!1},t=>{this.messageService.add({severity:"error",summary:"Error",detail:t.message,life:3e3}),this.showProgressBar=!1})}GetInvoicesById(t){this.showProgressBar=!0,this.InvoiceResponse=new N.G,this.printInvoiceDialog=!0,this.IsLoading=!0,this.productService.getInvoiceById(this.eventService.getToken(),t.invoiceId).subscribe(n=>{n.data?(this.InvoiceResponse=n.data,this.IsLoading=!1):(this.printInvoiceDialog=!1,this.messageService.add({severity:"error",summary:"Error",detail:"No tiene productos creados",life:3e3})),this.showProgressBar=!1},n=>{this.messageService.add({severity:"error",summary:"Error",detail:n.message,life:3e3}),this.showProgressBar=!1})}GetUserUniqueIdentifiquer(){const t=this.eventService.GetUserToken();this.userUniqueIdentifiquerKey=t}onSort(){this.updateRowGroupMetaData()}updateRowGroupMetaData(){var t,n;if(this.rowGroupMetadata={},this.customers3)for(let o=0;o<this.customers3.length;o++){const a=this.customers3[o],l=(null===(t=null==a?void 0:a.representative)||void 0===t?void 0:t.name)||"";if(0===o)this.rowGroupMetadata[l]={index:0,size:1};else{const g=this.customers3[o-1];l===(null===(n=null==g?void 0:g.representative)||void 0===n?void 0:n.name)?this.rowGroupMetadata[l].size++:this.rowGroupMetadata[l]={index:o,size:1}}}}expandAll(){this.isExpanded?this.expandedRows={}:this.products.forEach(t=>t&&t.name?this.expandedRows[t.name]=!0:""),this.isExpanded=!this.isExpanded}formatCurrency(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})}onGlobalFilter(t,n){t.filterGlobal(n.target.value,"contains")}clear(t){t.clear(),this.filter.nativeElement.value=""}hideDialog(){this.openPayDetailDialog=!1}openInvoicePayDetailDialog(t){this.InvoiceSelet=t,this.openPayDetailDialog=!0}updatePayInvoice(){this.openPayDetailDialog=!1,this.messageService.add({severity:"error",summary:"Advertencia",detail:"Esta funci\xf3n no esta habilitada aun, favor contacte al administrador para saber cuando estar\xe1 disponible",life:6e3})}openCancelInvoice(t){this.cancelInvoice=!0,this.InvoiceSelet=t,this.msjToShowWhenCancelInvoice=this.InvoiceSelet.sarNumber}confirmCancelInvoice(){this.cancelInvoice=!1,this.showProgressBar=!0,this.productService.cancelInvoice(this.eventService.getToken(),this.InvoiceSelet.invoiceId).subscribe(t=>{t.data?(this.showSuccessResponse=!0,this.showSuccessOrErrorResposeMsj="Se ha actualizado con exito, Los cambios apareceran cuando recargue la pagina"):(this.showErrorResponse=!0,this.showSuccessOrErrorResposeMsj=t.message),this.showProgressBar=!1},t=>{this.showProgressBar=!1,this.showErrorResponse=!0,this.showSuccessOrErrorResposeMsj="Un error ha ocurrido, favor recarge la pagina, si el error continua cierre e inicie sesion nuevamente"})}closeResponseMessage(){this.showErrorResponse=!1,this.showSuccessResponse=!1,this.showSuccessOrErrorResposeMsj=""}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(U.v),e.Y36(R.M),e.Y36(u.ez),e.Y36(E.P))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-component"]],viewQuery:function(t,n){if(1&t&&e.Gf(D,5),2&t){let o;e.iGM(o=e.CRH())&&(n.filter=o.first)}},features:[e._Bn([u.ez,u.YP])],decls:38,vars:38,consts:[["header","Agregar Detalles",1,"p-fluid",3,"visible","modal","visibleChange"],[3,"invoiceResponseToShow","IsLoading"],[4,"ngIf"],[1,"grid"],[1,"col-12"],[1,"card"],["dataKey","id","styleClass","p-datatable-gridlines","responsiveLayout","scroll",3,"value","rows","loading","rowHover","paginator","globalFilterFields"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],["header","Error",3,"visible","modal","visibleChange"],[1,"flex","justify-content-between","flex-column","sm:flex-row"],["pButton","","label","Clear","icon","pi pi-filter-slash",1,"p-button-outlined","mb-2",3,"click"],[1,"p-input-icon-left","mb-2"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search Keyword",1,"w-full",3,"input"],["filter",""],[1,"flex","justify-content-between","align-items-center"],["type","text","field","sarNumber","display","menu","placeholder","Buscar por nombre"],["type","text","field","costumerName","display","menu","placeholder","Buscar por nombre"],["type","date","field","date","display","menu","placeholder","mm/dd/yyyy"],["type","numeric","field","totalTax","display","menu","currency","USD"],["type","numeric","field","total","display","menu","currency","USD"],["field","activity","matchMode","between","display","menu",3,"showMatchModes","showOperator","showAddButton"],["pTemplate","filter"],[2,"width","8rem"],["type","boolean","field","isActive","display","menu"],["styleClass","m-3",3,"ngModel","range","onSlideEnd"],[1,"flex","align-items-center","justify-content-between","px-2"],[2,"min-width","12rem"],[2,"min-width","10rem"],[3,"value","showValue"],[1,"text-center",2,"min-width","8rem"],[1,"pi",3,"ngClass"],["pButton","","pRipple","","type","button","icon","pi pi-print",1,"p-button-rounded","p-button-help","mr-2","mb-2",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-dollar",1,"p-button-rounded","p-button-secondary","mr-2","mb-2",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-danger","mr-2","mb-2",3,"click"],["colspan","7"],[1,"card","p-fluid"],[1,"field","grid"],["htmlFor","name3",1,"col-12","mb-2","md:col-2","md:mb-0"],[1,"col-12","md:col-10"],["mode","currency","currency","LPS","locale","en-US","id","nuva","placeholder","Efectivo",3,"ngModel","showButtons","min","ngModelChange"],["pInputText","","id","name3","type","text","placeholder","Obs",3,"ngModel","ngModelChange"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Actualizar","icon","pi pi-check-square",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Ok",1,"p-button-text",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"p-dialog",0),e.NdJ("visibleChange",function(a){return n.printInvoiceDialog=a}),e._UZ(1,"app-print-invoice",1),e.qZA(),e.YNc(2,B,2,0,"div",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5"),e._uU(7,"Filter Menu"),e.qZA(),e.TgZ(8,"p-table",6,7),e.YNc(10,P,6,0,"ng-template",8),e.YNc(11,k,33,3,"ng-template",9),e.YNc(12,H,21,19,"ng-template",10),e.YNc(13,K,3,0,"ng-template",11),e.YNc(14,Q,3,0,"ng-template",12),e.qZA()()()(),e.TgZ(15,"p-dialog",0),e.NdJ("visibleChange",function(a){return n.openPayDetailDialog=a}),e.YNc(16,Y,23,10,"ng-template",13),e.YNc(17,z,2,0,"ng-template",14),e.qZA(),e.TgZ(18,"p-dialog",15),e.NdJ("visibleChange",function(a){return n.cancelInvoice=a}),e.TgZ(19,"div",16),e._UZ(20,"i",17),e.TgZ(21,"span"),e._uU(22,"Esta seguro que desea anular esta factura"),e.TgZ(23,"b"),e._uU(24),e.qZA(),e._uU(25,"?"),e.qZA()(),e.YNc(26,V,2,0,"ng-template",14),e.qZA(),e.TgZ(27,"p-dialog",18),e.NdJ("visibleChange",function(a){return n.showErrorResponse=a}),e.TgZ(28,"div",16),e._UZ(29,"i",17),e.TgZ(30,"span"),e._uU(31),e.qZA()(),e.YNc(32,W,1,0,"ng-template",14),e.qZA(),e.TgZ(33,"p-dialog",15),e.NdJ("visibleChange",function(a){return n.showSuccessResponse=a}),e.TgZ(34,"div",16)(35,"span"),e._uU(36),e.qZA()(),e.YNc(37,$,1,0,"ng-template",14),e.qZA()),2&t&&(e.Akn(e.DdM(32,x)),e.Q6J("visible",n.printInvoiceDialog)("modal",!0),e.xp6(1),e.Q6J("invoiceResponseToShow",n.InvoiceResponse)("IsLoading",n.IsLoading),e.xp6(1),e.Q6J("ngIf",n.showProgressBar),e.xp6(6),e.Q6J("value",n.InvoiceList)("rows",10)("loading",n.loading)("rowHover",!0)("paginator",!0)("globalFilterFields",e.DdM(33,X)),e.xp6(7),e.Akn(e.DdM(34,x)),e.Q6J("visible",n.openPayDetailDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(35,d)),e.Q6J("visible",n.cancelInvoice)("modal",!0),e.xp6(6),e.hij(" ",n.msjToShowWhenCancelInvoice,""),e.xp6(3),e.Akn(e.DdM(36,d)),e.Q6J("visible",n.showErrorResponse)("modal",!0),e.xp6(4),e.Oqu(n.showSuccessOrErrorResposeMsj),e.xp6(2),e.Akn(e.DdM(37,d)),e.Q6J("visible",n.showSuccessResponse)("modal",!0),e.xp6(3),e.hij(" ",n.showSuccessOrErrorResposeMsj,""))},dependencies:[c.mk,c.O5,p.Fj,p.JJ,p.On,m.iA,u.jx,m.xl,v.Hq,T.iR,Z.o,b.H,C.k,J.R,q.C,_.V,f.Rn,c.H9],styles:["[_nghost-%COMP%]     .p-frozen-column{font-weight:700}[_nghost-%COMP%]     .p-datatable-frozen-tbody{font-weight:700}[_nghost-%COMP%]     .p-progressbar{height:.5rem}"]}),i})(),te=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[y.Bz.forChild([{path:"",component:ee,canActivate:[S.j]}]),y.Bz]}),i})(),ne=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.ez,te,p.u5,m.U$,M.Xt,v.hJ,T.JH,Z.j,I.KZ,b.T,A.q4,w.kW,C.q,F.EV,L.E,_.S,f.L$]}),i})()}}]);