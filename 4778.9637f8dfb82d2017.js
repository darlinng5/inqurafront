"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[4778],{4778:(U,v,n)=>{n.r(v),n.d(v,{ReceibableDetailModule:()=>j});var e=n(6895),d=n(9197),h=n(5861),g=n(6166),C=n(4159),f=n.n(C),p=n(805),u=n(574),t=n(4650),b=n(7747),o=n(5384),c=n(5593),r=n(7116),T=n(2496),D=n(1383),P=n(302);function J(i,M){1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-progress-bar"),t.qZA())}const q=function(i,M){return{"text-red":i,"text-green":M}};function Q(i,M){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"lempira"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td",15),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"td",16),t._uU(18),t.ALo(19,"lempira"),t.qZA()()),2&i){const a=M.$implicit;t.xp6(2),t.Oqu(a.costumerName),t.xp6(2),t.Oqu(a.rtn),t.xp6(2),t.Oqu(t.lcZ(7,9,a.montoCreditoAprobado)),t.xp6(3),t.Oqu(a.diasCreditoAprobado),t.xp6(1),t.Q6J("ngClass",t.WLB(16,q,a.totalDias>a.diasCreditoAprobado,a.totalDias<=a.diasCreditoAprobado)),t.xp6(1),t.hij(" ",a.totalDias," "),t.xp6(2),t.Oqu(a.invoice),t.xp6(2),t.Oqu(t.xi3(16,11,a.invoiceDate,"MM/dd/yyyy")),t.xp6(3),t.Oqu(t.lcZ(19,14,a.total))}}let W=(()=>{class i{constructor(a,l,s){this.productService=a,this.eventService=l,this.messageService=s,this.receibableReport=[]}ngOnInit(){}GetReport(a){this.isLoading=!0,this.productService.GetReceivableReportDetail(this.eventService.getToken(),a).subscribe(l=>{l.data&&(this.receibableReport=l.data),this.isLoading=!1})}getTotalSum(){return this.receibableReport.reduce((a,l)=>a+l.total,0)}printReport(){var a=this;return(0,h.Z)(function*(){a.messageService.add({severity:"info",summary:"Info",detail:"El reporte se esta generando, favor espere",life:3e3}),a.isLoading=!0;const l=document.getElementById("print-section"),s=new g.ZP("p","pt","a4"),Z={background:"white",scale:3},m=s.internal.pageSize.getWidth(),E=s.internal.pageSize.getHeight(),x={top:15,bottom:15,left:15,right:15},L=m-x.left-x.right,S=E-x.top-x.bottom;function k(_,B,y){B.addImage(_,"PNG",x.left,y,L,0,void 0,"FAST")}try{const _=yield f()(l,Z),y=(_.toDataURL("image/png"),_.width),A=y/L;let O=_.height/A,N=x.top,w=1;for(;O>0;){const F=Math.min(S,O),R=document.createElement("canvas"),V=R.getContext("2d");R.width=y,R.height=F*A,V.drawImage(_,0,(w-1)*S*A,y,F*A,0,0,y,F*A),k(R.toDataURL("image/png"),s,N),O-=S,N=x.top,O>0&&(s.addPage(),w++)}const K=s.output("blob"),X=URL.createObjectURL(K);a.isLoading=!1,window.open(X,"_blank")}catch(_){console.error("Error generando PDF:",_),a.isLoading=!1}})()}handleSearchCriteria(a){this.GetReport(Number(a.selectedBranch))}exportToExcel(){const l=[["Cliente","RTN","Monto Aprobado","Maximo Dias Aprobado","Dias en No Pago","Factura","Fecha","Total"]];this.receibableReport.forEach(m=>{l.push([m.costumerName,m.rtn,m.montoCreditoAprobado,m.diasCreditoAprobado,m.totalDias,m.invoice,m.invoiceDate,m.total])});const s=u.P6.aoa_to_sheet(l),Z=u.P6.book_new();u.P6.book_append_sheet(Z,s,"Detalle de Facturas"),u.NC(Z,"CuentasPorCobrar.xlsx")}static#t=this.\u0275fac=function(l){return new(l||i)(t.Y36(b.M),t.Y36(o.P),t.Y36(p.ez))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-recibable-detail"]],features:[t._Bn([p.ez])],decls:42,vars:9,consts:[[4,"ngIf"],[1,"grid"],[1,"col-12"],[1,"card"],[3,"showUsers","dateInDays","showDate","searchCriteria"],["id","print-section",1,"receivable-report-container"],[2,"display","flex","justify-content","center","align-items","center","height","100%"],[1,"receivable-table"],[4,"ngFor","ngForOf"],["colspan","7",1,"total-label"],[2,"margin-top","20px"],["styleClass","mb-4"],[1,"my-2"],["printSectionId","PrintFull","pButton","","pRipple","","label","imprimir","icon","pi pi-print",1,"p-button-help",3,"click"],["pButton","","pRipple","","label","Exportar a Excel","icon","pi pi-cloud-download",1,"p-button-success","mr-2",2,"margin-left","10px",3,"disabled","click"],[3,"ngClass"],[1,"text-right"]],template:function(l,s){1&l&&(t.YNc(0,J,2,0,"div",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-header-report-filter",4),t.NdJ("searchCriteria",function(m){return s.handleSearchCriteria(m)}),t.qZA(),t.TgZ(5,"div",5)(6,"div",6)(7,"h4"),t._uU(8,"Reporte de cuentas por cobrar"),t.qZA()(),t.TgZ(9,"table",7)(10,"thead")(11,"tr")(12,"th"),t._uU(13,"Cliente"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"RTN"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Monto Aprobado"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Maximo Dias Aprobado"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Dias de No Pago"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Factura"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Fecha"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Total"),t.qZA()()(),t.TgZ(28,"tbody"),t.YNc(29,Q,20,19,"tr",8),t.qZA(),t.TgZ(30,"tfoot")(31,"tr")(32,"td",9),t._uU(33,"Total:"),t.qZA(),t.TgZ(34,"td"),t._uU(35),t.ALo(36,"lempira"),t.qZA()()()()()()()(),t.TgZ(37,"div",10)(38,"p-toolbar",11)(39,"div",12)(40,"button",13),t.NdJ("click",function(){return s.printReport()}),t.qZA(),t.TgZ(41,"button",14),t.NdJ("click",function(){return s.exportToExcel()}),t.qZA()()()()),2&l&&(t.Q6J("ngIf",s.isLoading),t.xp6(4),t.Q6J("showUsers",!1)("dateInDays",!0)("showDate",!1),t.xp6(25),t.Q6J("ngForOf",s.receibableReport),t.xp6(6),t.Oqu(t.lcZ(36,7,s.getTotalSum())),t.xp6(6),t.Q6J("disabled",!s.receibableReport||0===s.receibableReport.length))},dependencies:[e.mk,e.sg,e.O5,c.Hq,r.R,T.F,D.o,e.uU,P.E],styles:["[_nghost-%COMP%] {\n  --primary-color: #023b78;\n  --secondary-color: #1565bb;\n  --background-color: #f0f8ff;\n  --text-color: #333;\n  --border-color: #ccc;\n  --hover-color: #e9ecef;\n  \n  font-family: 'Arial', sans-serif;\n  color: var(--text-color);\n\n  padding: 20px;\n}\n\n.receivable-report-container[_ngcontent-%COMP%] {\n  border: 1px solid var(--border-color);\n  border-radius: 10px;\n  padding: 20px;\n}\n\n.receivable-table[_ngcontent-%COMP%] {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 10px;\n}\n\n.receivable-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .receivable-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\n  border: 1px solid var(--border-color);\n  padding: 10px;\n  text-align: left;\n}\n\n.receivable-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%] {\n  background-color: var(--primary-color);\n  color: #fff;\n}\n\n.receivable-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover {\n  background-color: var(--hover-color);\n}\n\n.receivable-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%] {\n  font-weight: bold;\n  background-color: var(--secondary-color);\n  color: #fff;\n}\n\n.total-label[_ngcontent-%COMP%] {\n  text-align: right;\n}\n\n.text-red[_ngcontent-%COMP%] {\n  color: red;\n}\n\n.text-green[_ngcontent-%COMP%] {\n  color: green;\n}\n.text-right[_ngcontent-%COMP%] {\n  text-align: right;\n}"]})}return i})(),G=(()=>{class i{static#t=this.\u0275fac=function(l){return new(l||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild([{path:"",component:W}]),d.Bz]})}return i})();var I=n(4006),H=n(9585),Y=n(4891);let j=(()=>{class i{static#t=this.\u0275fac=function(l){return new(l||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[e.ez,G,I.u5,c.hJ,H.xD,I.u5,Y.E,D.V]})}return i})()},7116:(U,v,n)=>{n.d(v,{R:()=>h});var e=n(4650),d=n(3162);let h=(()=>{class g{constructor(){}static#t=this.\u0275fac=function(p){return new(p||g)};static#e=this.\u0275cmp=e.Xpm({type:g,selectors:[["app-progress-bar"]],decls:1,vars:0,consts:[["mode","indeterminate"]],template:function(p,u){1&p&&e._UZ(0,"mat-progress-bar",0)},dependencies:[d.pW],encapsulation:2})}return g})()},1383:(U,v,n)=>{n.d(v,{V:()=>b,o:()=>t});var e=n(4650),d=n(6895),h=n(805);function g(o,c){1&o&&e.GkF(0)}function C(o,c){if(1&o&&(e.TgZ(0,"div",3),e.YNc(1,g,1,0,"ng-container",4),e.qZA()),2&o){const r=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",r.leftTemplate)}}function f(o,c){1&o&&e.GkF(0)}function p(o,c){if(1&o&&(e.TgZ(0,"div",5),e.YNc(1,f,1,0,"ng-container",4),e.qZA()),2&o){const r=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",r.rightTemplate)}}const u=["*"];let t=(()=>{class o{constructor(r){this.el=r}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(r=>{switch(r.getType()){case"left":this.leftTemplate=r.template;break;case"right":this.rightTemplate=r.template}})}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(e.SBq))},o.\u0275cmp=e.Xpm({type:o,selectors:[["p-toolbar"]],contentQueries:function(r,T,D){if(1&r&&e.Suo(D,h.jx,4),2&r){let P;e.iGM(P=e.CRH())&&(T.templates=P)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:u,decls:4,vars:6,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-group-left",4,"ngIf"],["class","p-toolbar-group-right",4,"ngIf"],[1,"p-toolbar-group-left"],[4,"ngTemplateOutlet"],[1,"p-toolbar-group-right"]],template:function(r,T){1&r&&(e.F$t(),e.TgZ(0,"div",0),e.Hsn(1),e.YNc(2,C,2,1,"div",1),e.YNc(3,p,2,1,"div",2),e.qZA()),2&r&&(e.Tol(T.styleClass),e.Q6J("ngClass","p-toolbar p-component")("ngStyle",T.style),e.xp6(2),e.Q6J("ngIf",T.leftTemplate),e.xp6(1),e.Q6J("ngIf",T.rightTemplate))},dependencies:[d.mk,d.O5,d.tP,d.PC],styles:[".p-toolbar{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.p-toolbar-group-left,.p-toolbar-group-right{display:flex;align-items:center}\n"],encapsulation:2,changeDetection:0}),o})(),b=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.ez]}),o})()},5861:(U,v,n)=>{function e(h,g,C,f,p,u,t){try{var b=h[u](t),o=b.value}catch(c){return void C(c)}b.done?g(o):Promise.resolve(o).then(f,p)}function d(h){return function(){var g=this,C=arguments;return new Promise(function(f,p){var u=h.apply(g,C);function t(o){e(u,f,p,t,b,"next",o)}function b(o){e(u,f,p,t,b,"throw",o)}t(void 0)})}}n.d(v,{Z:()=>d})}}]);