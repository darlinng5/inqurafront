"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[2706],{6768:(Z,C,i)=>{i.d(C,{t:()=>t});var s=i(4650),h=i(7747),f=i(5384),v=i(4006),l=i(2210);let t=(()=>{class g{constructor(m,u){this.commonService=m,this.eventService=u,this.ValueSelectedChange=new s.vpe,this.categorys=[],this.Filter=!1}ngOnInit(){this.data=this.DropDownDataSource,this.Filter=this.showFilter}changeValue(){this.ValueSelected=this.selectedData?.value,this.ValueSelectedChange.emit(this.ValueSelected)}selectedValue(){this.ValueSelected=this.selectedData?.value,this.ValueSelectedChange.emit(this.ValueSelected)}static#t=this.\u0275fac=function(u){return new(u||g)(s.Y36(h.M),s.Y36(f.P))};static#e=this.\u0275cmp=s.Xpm({type:g,selectors:[["app-drop-down"]],inputs:{ValueSelected:"ValueSelected",IsCreating:"IsCreating",showFilter:"showFilter",DropDownDataSource:"DropDownDataSource"},outputs:{ValueSelectedChange:"ValueSelectedChange"},decls:1,vars:3,consts:[["optionLabel","viewValue",3,"filter","options","ngModel","onClick","onChange","ngModelChange"]],template:function(u,p){1&u&&(s.TgZ(0,"p-dropdown",0),s.NdJ("onClick",function(){return p.selectedValue()})("onChange",function(){return p.changeValue()})("ngModelChange",function(T){return p.selectedData=T}),s.qZA()),2&u&&s.Q6J("filter",p.Filter)("options",p.data)("ngModel",p.selectedData)},dependencies:[v.JJ,v.On,l.Lt],encapsulation:2})}return g})()},2706:(Z,C,i)=>{i.r(C),i.d(C,{ComprasModule:()=>N});var s=i(6895),h=i(9197);class f{}var l=i(4006),t=i(4650),g=i(7747),y=i(5384),m=i(5593),u=i(6768),p=i(4144),_=i(3805),T=i(3238),x=i(585),b=i(805),M=i(1493);function P(r,d){if(1&r){const e=t.EpF();t.TgZ(0,"div",12)(1,"strong"),t._uU(2," Proveedor: "),t.qZA(),t.TgZ(3,"app-drop-down",13),t.NdJ("ValueSelectedChange",function(n){t.CHM(e);const a=t.oxw();return t.KtG(a.filterSupplier(n))}),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(3),t.Q6J("showFilter",!0)("IsCreating",!1)("DropDownDataSource",e.suppliers)}}function D(r,d){if(1&r&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&r){const e=d.$implicit;t.Q6J("value",e.value)("title",e.viewValue),t.xp6(1),t.hij(" ",e.viewValue," ")}}function A(r,d){if(1&r&&(t.TgZ(0,"option",23),t._uU(1),t.qZA()),2&r){const e=d.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function S(r,d){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"input",14),t.NdJ("input",function(n){t.CHM(e);const a=t.oxw();return t.KtG(a.filterProducts(n))}),t.qZA(),t.TgZ(3,"mat-autocomplete",15,16),t.NdJ("optionSelected",function(){const n=t.CHM(e),a=n.index,c=n.$implicit,E=t.oxw();return t.KtG(E.updateProduct(a,c))}),t.YNc(5,D,2,3,"mat-option",17),t.qZA()(),t.TgZ(6,"td")(7,"input",18),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.quantity=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getTotal())}),t.qZA()(),t.TgZ(8,"td")(9,"input",18),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.purchasePrice=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getTotal())}),t.qZA()(),t.TgZ(10,"td")(11,"select",19),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.taxId=n)}),t.YNc(12,A,2,2,"option",20),t.qZA()(),t.TgZ(13,"td")(14,"button",21),t.NdJ("click",function(){const a=t.CHM(e).index,c=t.oxw();return t.KtG(c.removeProduct(a))}),t.qZA()()()}if(2&r){const e=d.$implicit,o=t.MAs(4),n=t.oxw();t.xp6(2),t.Q6J("matAutocomplete",o)("formControl",e.productControl),t.xp6(3),t.Q6J("ngForOf",n.filterdProductos),t.xp6(2),t.Q6J("ngModel",e.quantity),t.xp6(2),t.Q6J("ngModel",e.purchasePrice),t.xp6(2),t.Q6J("ngModel",e.taxId),t.xp6(1),t.Q6J("ngForOf",n.availableTaxes)}}function w(r,d){if(1&r){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.showSaveDialog=!1)}),t.qZA(),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmSaveBuy())}),t.qZA()}}const J=function(){return{width:"450px"}};let O=(()=>{class r{constructor(e,o){this.productService=e,this.eventService=o,this.availableTaxes=[{id:1,name:"Tax 1"},{id:2,name:"Tax 2"},{id:3,name:"Tax 3"}],this.buy=new f,this.buy.supplierId=0,this.buy.buyDate=new Date,this.buy.reference="",this.buy.productLine=[],this.buy.productLine.forEach(n=>{n.productControl=new l.NI})}ngOnInit(){this.GetSupplierValuesByEnterprise(),this.getProductValues()}removeProduct(e){this.buy.productLine.splice(e,1)}updateProduct(e,o){const n=o.productControl.value,a=this.products.find(c=>c.value===n);a?(o.productId=n,o.productControl.setValue(a.viewValue)):(o.productId=0,o.productControl.setValue(""))}addProduct(){this.buy.productLine.push({productId:0,quantity:0,purchasePrice:0,taxId:0,productControl:new l.NI}),console.log(this.buy.productLine)}getTotal(){let e=0;for(let o of this.buy.productLine)e+=o.quantity*o.purchasePrice;return e}filterSupplier(e){this.buy.supplierId=e}getProductValues(){this.isLoading=!0,this.productService.GetProductsValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.products=e.data),this.isLoading=!1})}filterProducts(e){const n=(e.target.value||"").toLowerCase();this.filterdProductos=this.products.filter(a=>a.viewValue.toLowerCase().includes(n))}GetSupplierValuesByEnterprise(){this.productService.GetSupplierValues(this.eventService.getToken()).subscribe(e=>{e.data&&(this.suppliers=e.data)})}save(){this.showSaveDialog=!0}confirmSaveBuy(){}static#t=this.\u0275fac=function(o){return new(o||r)(t.Y36(g.M),t.Y36(y.P))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["ng-component"]],decls:39,vars:11,consts:[["style","margin-bottom: 10px;",4,"ngIf"],["inputId","icon","formControlName","buy.buyDate",2,"margin-left","25px",3,"showIcon"],[2,"margin-top","10px"],["type","text","pInputText","","id","productName","required","","autofocus","",3,"ngModel","ngModelChange"],[2,"margin-top","20px"],[4,"ngFor","ngForOf"],["pButton","","pRipple","","label","Agregar","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-help",3,"click"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],["pTemplate","footer"],[2,"margin-bottom","10px"],[3,"showFilter","IsCreating","DropDownDataSource","ValueSelectedChange"],["type","text","placeholder","Product","aria-label","Product","matInput","",1,"large-input",3,"matAutocomplete","formControl","input"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value","title",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange","change"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],[3,"value","title"],[3,"value"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"div"),t.YNc(1,P,4,3,"div",0),t.TgZ(2,"strong"),t._uU(3,"Fecha: "),t.qZA(),t._UZ(4,"p-calendar",1)(5,"br"),t.TgZ(6,"div",2)(7,"strong"),t._uU(8,"Referencia: "),t.qZA(),t.TgZ(9,"input",3),t.NdJ("ngModelChange",function(c){return n.buy.reference=c}),t.qZA()(),t.TgZ(10,"h6")(11,"em"),t._uU(12,"Favor en el precio de compra incluya el precio final incluyendo el impuesto"),t.qZA()(),t.TgZ(13,"table",4)(14,"tr")(15,"th"),t._uU(16,"Product"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Quantity"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Purchase Price"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Tax"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Actions"),t.qZA()(),t.YNc(25,S,15,7,"tr",5),t.qZA(),t.TgZ(26,"h3"),t._uU(27),t.qZA(),t.TgZ(28,"button",6),t.NdJ("click",function(){return n.addProduct()}),t.qZA(),t.TgZ(29,"button",7),t.NdJ("click",function(){return n.save()}),t.qZA()(),t.TgZ(30,"p-dialog",8),t.NdJ("visibleChange",function(c){return n.showSaveDialog=c}),t.TgZ(31,"div",9),t._UZ(32,"i",10),t.TgZ(33,"span"),t._uU(34,"Esta seguro desea agregar esta compra por un total de: "),t.TgZ(35,"b"),t._uU(36),t.qZA(),t._uU(37,"?"),t.qZA()(),t.YNc(38,w,2,0,"ng-template",11),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",!n.isLoading),t.xp6(3),t.Q6J("showIcon",!0),t.xp6(5),t.Q6J("ngModel",n.buy.reference),t.xp6(16),t.Q6J("ngForOf",n.buy.productLine),t.xp6(2),t.hij("Total L. ",n.getTotal(),""),t.xp6(3),t.Akn(t.DdM(10,J)),t.Q6J("visible",n.showSaveDialog)("modal",!0),t.xp6(6),t.Oqu(n.getTotal()))},dependencies:[s.sg,s.O5,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.Q7,l.On,m.Hq,u.t,p.Nt,_.XC,_.ZL,T.ey,l.oH,l.u,x.f,b.jx,M.V],styles:['[_ngcontent-%COMP%]:root {\n    --primary-color: #4CAF50;\n    --secondary-color: #45a049;\n    --tertiary-color: #f1f1f1;\n    --quaternary-color: #f9f9f9;\n  }\n\n  \n  th[_ngcontent-%COMP%] {\n    background-color: var(--tertiary-color);\n    font-weight: bold;\n  }\n\n  tr[_ngcontent-%COMP%]:nth-child(even) {\n    background-color: var(--quaternary-color);\n  }\n\n  tr[_ngcontent-%COMP%]:hover {\n    background-color: var(--tertiary-color);\n  }\n\n  button[_ngcontent-%COMP%] {\n    background-color: var(--primary-color);\n    \n  }\n\n  button[_ngcontent-%COMP%]:hover {\n    background-color: var(--secondary-color);\n  }\n\n  \n  input[type="number"][_ngcontent-%COMP%], input[type="text"][_ngcontent-%COMP%], select[_ngcontent-%COMP%] {\n    font-size: 14px;\n    padding: 4px 8px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    outline: none;\n  }\n\n  input[type="number"][_ngcontent-%COMP%]:focus, input[type="text"][_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus {\n    border-color: var(--primary-color);\n    box-shadow: 0 0 4px rgba(76, 175, 80, 0.5);\n  }\n  .large-input[_ngcontent-%COMP%] {\n  width: 300px; \n}']})}return r})(),V=(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275mod=t.oAB({type:r});static#n=this.\u0275inj=t.cJS({imports:[h.Bz.forChild([{path:"",component:O}]),h.Bz]})}return r})();var I=i(4891),F=i(9549);let N=(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275mod=t.oAB({type:r});static#n=this.\u0275inj=t.cJS({imports:[s.ez,V,l.u5,m.hJ,I.E,F.lN,p.c,_.Bb,l.UX,x._8,M.S]})}return r})()}}]);