"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[2378],{2378:(Z,C,r)=>{r.r(C),r.d(C,{AccountTransactionModule:()=>I});var i=r(6895),g=r(9197),v=r(805);class _{constructor(p,n,e,o){this.comments=p,this.date=n,this.userId=e,this.lines=o}}class b{constructor(p,n,e,o){this.creditAccount=isNaN(p)?0:p,this.creditAmount=isNaN(n)?0:n,this.debitAccount=isNaN(e)?0:e,this.debitAmount=isNaN(o)?0:o}}var t=r(4650),f=r(5384),x=r(7747),m=r(4006),A=r(5593),l=r(7116),u=r(1383),d=r(2453);function h(c,p){1&c&&(t.TgZ(0,"div"),t._UZ(1,"app-progress-bar"),t.qZA())}function M(c,p){if(1&c){const n=t.EpF();t.TgZ(0,"div",27),t.NdJ("click",function(){const a=t.CHM(n).$implicit,s=t.oxw(2).index,y=t.oxw();return t.KtG(y.selectAccount(s,"credit",a))}),t._uU(1),t.qZA()}if(2&c){const n=p.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function T(c,p){if(1&c&&(t.TgZ(0,"div",25),t.YNc(1,M,2,1,"div",26),t.qZA()),2&c){const n=t.oxw().index,e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.filteredCreditAccounts[n])}}function P(c,p){if(1&c){const n=t.EpF();t.TgZ(0,"div",27),t.NdJ("click",function(){const a=t.CHM(n).$implicit,s=t.oxw(2).index,y=t.oxw();return t.KtG(y.selectAccount(s,"debit",a))}),t._uU(1),t.qZA()}if(2&c){const n=p.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function O(c,p){if(1&c&&(t.TgZ(0,"div",25),t.YNc(1,P,2,1,"div",26),t.qZA()),2&c){const n=t.oxw().index,e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.filteredDebitAccounts[n])}}function D(c,p){if(1&c){const n=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"input",16),t.NdJ("ngModelChange",function(o){const s=t.CHM(n).$implicit;return t.KtG(s.creditAccount=o)})("input",function(){const a=t.CHM(n).index,s=t.oxw();return t.KtG(s.filterAccounts(a,"credit"))}),t.qZA(),t.YNc(3,T,2,1,"div",17),t.qZA(),t.TgZ(4,"div",15)(5,"input",18),t.NdJ("ngModelChange",function(o){const s=t.CHM(n).$implicit;return t.KtG(s.creditDescription=o)}),t.qZA()(),t.TgZ(6,"div",15)(7,"input",19),t.NdJ("ngModelChange",function(o){const s=t.CHM(n).$implicit;return t.KtG(s.creditAmount=o)}),t.qZA()(),t._UZ(8,"div",20),t.TgZ(9,"div",15)(10,"input",21),t.NdJ("ngModelChange",function(o){const s=t.CHM(n).$implicit;return t.KtG(s.debitAccount=o)})("input",function(){const a=t.CHM(n).index,s=t.oxw();return t.KtG(s.filterAccounts(a,"debit"))}),t.qZA(),t.YNc(11,O,2,1,"div",17),t.qZA(),t.TgZ(12,"div",15)(13,"input",18),t.NdJ("ngModelChange",function(o){const s=t.CHM(n).$implicit;return t.KtG(s.debitDescription=o)}),t.qZA()(),t.TgZ(14,"div",15)(15,"input",22),t.NdJ("ngModelChange",function(o){const s=t.CHM(n).$implicit;return t.KtG(s.debitAmount=o)}),t.qZA()(),t.TgZ(16,"p-button",23),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.addLine())}),t.qZA(),t.TgZ(17,"p-button",24),t.NdJ("click",function(){const a=t.CHM(n).index,s=t.oxw();return t.KtG(s.removeLine(a))}),t.qZA()()}if(2&c){const n=p.$implicit,e=p.index,o=t.oxw();t.xp6(2),t.Q6J("ngModel",n.creditAccount),t.xp6(1),t.Q6J("ngIf",o.filteredCreditAccounts[e]&&o.filteredCreditAccounts[e].length>0),t.xp6(2),t.Q6J("title",n.creditDescription)("ngModel",n.creditDescription),t.xp6(2),t.Q6J("ngModel",n.creditAmount),t.xp6(3),t.Q6J("ngModel",n.debitAccount),t.xp6(1),t.Q6J("ngIf",o.filteredDebitAccounts[e]&&o.filteredDebitAccounts[e].length>0),t.xp6(2),t.Q6J("title",n.debitDescription)("ngModel",n.debitDescription),t.xp6(2),t.Q6J("ngModel",n.debitAmount)}}let J=(()=>{class c{constructor(n,e,o){this.messageService=n,this.eventService=e,this.productService=o,this.isLoading=!1,this.lines=[{creditAccount:"",creditAmount:0,creditDescription:"",debitAccount:"",debitAmount:0,debitDescription:""}],this.comments="",this.date="",this.allAccounts=[],this.filteredCreditAccounts=[[]],this.filteredDebitAccounts=[[]],this.getAccounts()}addLine(){this.lines.push({creditAccount:"",creditAmount:0,creditDescription:"",debitAccount:"",debitAmount:0,debitDescription:""}),this.filteredCreditAccounts.push([]),this.filteredDebitAccounts.push([])}removeLine(n){this.lines.splice(n,1),this.filteredCreditAccounts.splice(n,1),this.filteredDebitAccounts.splice(n,1)}filterAccounts(n,e){const o="credit"===e?this.lines[n].creditAccount:this.lines[n].debitAccount,a=this.allAccounts.filter(s=>s.name.toLowerCase().includes(o.toLowerCase()));"credit"===e?this.filteredCreditAccounts[n]=a:this.filteredDebitAccounts[n]=a}selectAccount(n,e,o){"credit"===e?(this.lines[n].creditAccount=o.id.toString(),this.lines[n].creditDescription=o.description,this.filteredCreditAccounts[n]=[]):(this.lines[n].debitAccount=o.id.toString(),this.lines[n].debitDescription=o.description,this.filteredDebitAccounts[n]=[])}getTotalCredits(){return this.lines.reduce((n,e)=>n+e.creditAmount,0)}getTotalDebits(){return this.lines.reduce((n,e)=>n+e.debitAmount,0)}save(){this.getTotalCredits()!=this.getTotalDebits()&&this.messageService.add({severity:"error",summary:"Error",detail:"El monto total de credito debe ser igual al monto de debito",life:3e3}),console.log(this.lines);const n=this.lines.map(a=>new b(parseInt(a.creditAccount),a.creditAmount,parseInt(a.debitAccount),a.debitAmount)),e=this.eventService.getToken();var o=new _(this.comments,this.date,e,n);this.PostAccountTransaction(o)}getAccounts(){this.isLoading=!0;const n=this.eventService.getToken();this.productService.GetAccounts(n).subscribe(e=>{console.log(e),e.data?(this.allAccounts=e.data,console.log(this.allAccounts)):this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3}),this.isLoading=!1},e=>{this.isLoading=!1,this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3})})}PostAccountTransaction(n){this.isLoading=!0,this.productService.PostAccountTransaction(n).subscribe(e=>{console.log(e),e.data?(this.lines=[],this.comments="",this.date="",this.addLine(),this.messageService.add({severity:"success",summary:"Success",detail:"Exito al guardar los datos",life:3e3})):this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3}),this.isLoading=!1},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:3e3}),this.isLoading=!1})}static#t=this.\u0275fac=function(e){return new(e||c)(t.Y36(v.ez),t.Y36(f.P),t.Y36(x.M))};static#n=this.\u0275cmp=t.Xpm({type:c,selectors:[["ng-component"]],features:[t._Bn([v.ez])],decls:24,vars:14,consts:[[1,"card","px-6","py-6"],[4,"ngIf"],[1,"container"],["class","form-row",4,"ngFor","ngForOf"],[1,"totals"],[1,"additional-info"],[1,"input-group","full-width"],["placeholder","Comentarios",3,"ngModel","ngModelChange"],["type","date",3,"ngModel","ngModelChange"],["styleClass","mb-4"],[1,"my-2"],["routerLink","/"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-arrow-circle-left",1,"mr-2","inline-block"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-help",3,"click"],[1,"form-row"],[1,"input-group"],["type","text","placeholder","Cuenta Credito",3,"ngModel","ngModelChange","input"],["class","autocomplete",4,"ngIf"],["readonly","true","type","text","placeholder","Desc.",3,"title","ngModel","ngModelChange"],["type","number","placeholder","Monto Credito",3,"ngModel","ngModelChange"],[1,"separator"],["type","text","placeholder","Cuenta Debito",3,"ngModel","ngModelChange","input"],["type","number","placeholder","Monto Debito",3,"ngModel","ngModelChange"],["icon","pi pi-plus","styleClass","p-button-rounded p-button-success p-button-text",3,"click"],["icon","pi pi-trash","styleClass","p-button-rounded p-button-danger p-button-text",3,"click"],[1,"autocomplete"],["class","autocomplete-item",3,"click",4,"ngFor","ngForOf"],[1,"autocomplete-item",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,h,2,0,"div",1),t._UZ(2,"p-toast"),t.TgZ(3,"div",2)(4,"h4"),t._uU(5,"Crear Partidas Contables"),t.qZA(),t.YNc(6,D,18,10,"div",3),t.TgZ(7,"div",4)(8,"div"),t._uU(9),t.ALo(10,"currency"),t.qZA(),t.TgZ(11,"div"),t._uU(12),t.ALo(13,"currency"),t.qZA()(),t.TgZ(14,"div",5)(15,"div",6)(16,"textarea",7),t.NdJ("ngModelChange",function(s){return o.comments=s}),t.qZA()(),t.TgZ(17,"div",6)(18,"input",8),t.NdJ("ngModelChange",function(s){return o.date=s}),t.qZA()()()()(),t.TgZ(19,"p-toolbar",9)(20,"div",10)(21,"a",11),t._UZ(22,"button",12),t.qZA(),t.TgZ(23,"button",13),t.NdJ("click",function(){return o.save()}),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(5),t.Q6J("ngForOf",o.lines),t.xp6(3),t.hij("Total Cr\xe9ditos: ",t.Dn7(10,6,o.getTotalCredits(),"L. ","symbol"),""),t.xp6(3),t.hij("Total D\xe9bitos: ",t.Dn7(13,10,o.getTotalDebits(),"L. ","symbol"),""),t.xp6(4),t.Q6J("ngModel",o.comments),t.xp6(2),t.Q6J("ngModel",o.date))},dependencies:[i.sg,i.O5,g.rH,m.Fj,m.wV,m.JJ,m.On,A.Hq,A.zx,l.R,u.o,d.FN,i.H9],styles:[".container[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n}\n\nh1[_ngcontent-%COMP%] {\n  margin-bottom: 20px;\n}\n\n.form-row[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  width: 100%;\n  max-width: 1000px;\n  margin-bottom: 10px; \n}\n\n.input-group[_ngcontent-%COMP%] {\n  margin-right: 20px;\n  flex: 1;\n  position: relative; \n}\n\n.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  font-size: 14px;\n}\n\n.input-group[_ngcontent-%COMP%]:last-of-type {\n  margin-right: 0;\n}\n\n.separator[_ngcontent-%COMP%] {\n  width: 1px;\n  height: 40px;\n  background-color: black;\n  margin: 0 20px;\n}\n\n.add-line[_ngcontent-%COMP%] {\n  padding: 10px 20px;\n  background-color: #007bff;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.add-line[_ngcontent-%COMP%]:hover {\n  background-color: #0056b3;\n}\n\n.remove-line[_ngcontent-%COMP%] {\n  padding: 10px;\n  background-color: #dc3545;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.remove-line[_ngcontent-%COMP%]:hover {\n  background-color: #c82333;\n}\n\n.save[_ngcontent-%COMP%] {\n  margin-top: 20px;\n  padding: 10px 20px;\n  background-color: #28a745;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.save[_ngcontent-%COMP%]:hover {\n  background-color: #218838;\n}\n\n.totals[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  max-width: 1000px;\n  margin-top: 20px;\n}\n\n.additional-info[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%] {\n  width: 100%;\n  margin-bottom: 10px;\n}\n\n.autocomplete[_ngcontent-%COMP%] {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  background-color: white;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  max-height: 150px;\n  overflow-y: auto;\n  z-index: 1000;\n}\n\n.autocomplete-item[_ngcontent-%COMP%] {\n  padding: 10px;\n  cursor: pointer;\n}\n\n.autocomplete-item[_ngcontent-%COMP%]:hover {\n  background-color: #f1f1f1;\n}\n\n@media (max-width: 768px) {\n  .form-row[_ngcontent-%COMP%] {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .separator[_ngcontent-%COMP%] {\n    display: none;\n  }\n\n  .input-group[_ngcontent-%COMP%] {\n    margin-right: 0;\n    margin-bottom: 10px;\n  }\n\n  .additional-info[_ngcontent-%COMP%] {\n    flex-direction: column;\n    width: 100%;\n  }\n\n  .totals[_ngcontent-%COMP%] {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .save[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n}"]})}return c})(),w=(()=>{class c{static#t=this.\u0275fac=function(e){return new(e||c)};static#n=this.\u0275mod=t.oAB({type:c});static#e=this.\u0275inj=t.cJS({imports:[g.Bz.forChild([{path:"",component:J}]),g.Bz]})}return c})();var N=r(4144),E=r(3805),L=r(9549),S=r(7392),k=r(3238),F=r(585),Q=r(4891);let I=(()=>{class c{static#t=this.\u0275fac=function(e){return new(e||c)};static#n=this.\u0275mod=t.oAB({type:c});static#e=this.\u0275inj=t.cJS({imports:[i.ez,w,m.u5,A.hJ,m.u5,Q.E,m.UX,N.c,E.Bb,L.lN,S.Ps,k.XK,u.V,F._8,d.EV]})}return c})()},7116:(Z,C,r)=>{r.d(C,{R:()=>v});var i=r(4650),g=r(3162);let v=(()=>{class _{constructor(){}static#t=this.\u0275fac=function(f){return new(f||_)};static#n=this.\u0275cmp=i.Xpm({type:_,selectors:[["app-progress-bar"]],decls:1,vars:0,consts:[["mode","indeterminate"]],template:function(f,x){1&f&&i._UZ(0,"mat-progress-bar",0)},dependencies:[g.pW],encapsulation:2})}return _})()},1383:(Z,C,r)=>{r.d(C,{V:()=>A,o:()=>m});var i=r(4650),g=r(6895),v=r(805);function _(l,u){1&l&&i.GkF(0)}function b(l,u){if(1&l&&(i.TgZ(0,"div",3),i.YNc(1,_,1,0,"ng-container",4),i.qZA()),2&l){const d=i.oxw();i.xp6(1),i.Q6J("ngTemplateOutlet",d.leftTemplate)}}function t(l,u){1&l&&i.GkF(0)}function f(l,u){if(1&l&&(i.TgZ(0,"div",5),i.YNc(1,t,1,0,"ng-container",4),i.qZA()),2&l){const d=i.oxw();i.xp6(1),i.Q6J("ngTemplateOutlet",d.rightTemplate)}}const x=["*"];let m=(()=>{class l{constructor(d){this.el=d}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(d=>{switch(d.getType()){case"left":this.leftTemplate=d.template;break;case"right":this.rightTemplate=d.template}})}}return l.\u0275fac=function(d){return new(d||l)(i.Y36(i.SBq))},l.\u0275cmp=i.Xpm({type:l,selectors:[["p-toolbar"]],contentQueries:function(d,h,M){if(1&d&&i.Suo(M,v.jx,4),2&d){let T;i.iGM(T=i.CRH())&&(h.templates=T)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:x,decls:4,vars:6,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-group-left",4,"ngIf"],["class","p-toolbar-group-right",4,"ngIf"],[1,"p-toolbar-group-left"],[4,"ngTemplateOutlet"],[1,"p-toolbar-group-right"]],template:function(d,h){1&d&&(i.F$t(),i.TgZ(0,"div",0),i.Hsn(1),i.YNc(2,b,2,1,"div",1),i.YNc(3,f,2,1,"div",2),i.qZA()),2&d&&(i.Tol(h.styleClass),i.Q6J("ngClass","p-toolbar p-component")("ngStyle",h.style),i.xp6(2),i.Q6J("ngIf",h.leftTemplate),i.xp6(1),i.Q6J("ngIf",h.rightTemplate))},dependencies:[g.mk,g.O5,g.tP,g.PC],styles:[".p-toolbar{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.p-toolbar-group-left,.p-toolbar-group-right{display:flex;align-items:center}\n"],encapsulation:2,changeDetection:0}),l})(),A=(()=>{class l{}return l.\u0275fac=function(d){return new(d||l)},l.\u0275mod=i.oAB({type:l}),l.\u0275inj=i.cJS({imports:[g.ez]}),l})()}}]);